{"version":3,"file":"display.js","sourceRoot":"","sources":["../../../src/cli/processing/display.ts"],"names":[],"mappings":"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","sourcesContent":["// SPDX-License-Identifier: MIT\n// @prometheus-disable tipo-literal-inline-complexo\n// Justificativa: tipos locais para formatação de display\nimport { chalk } from '@core/config/chalk-safe.js';\nimport { config } from '@core/config/config.js';\nimport { log } from '@core/messages/index.js';\n\n/**\n * Utilitários para exibição de informações da CLI\n */\n\n// Função para exibir bloco de filtros (verbose)\n\nexport function exibirBlocoFiltros(\n  includeGroupsExpanded: string[][],\n  includeListFlat: string[],\n  excludeList: string[],\n  incluiNodeModules: boolean,\n): void {\n  if (!config.VERBOSE) return;\n\n  const gruposFmt = includeGroupsExpanded\n    .map((g) => (g.length === 1 ? g[0] : `(${g.join(' & ')})`))\n    .join(' | ');\n  const linhas: string[] = [];\n  if (includeListFlat.length) linhas.push(`include=[${gruposFmt}]`);\n  if (excludeList.length) linhas.push(`exclude=[${excludeList.join(', ')}]`);\n  if (incluiNodeModules)\n    linhas.push('(node_modules incluído: ignorado dos padrões de exclusão)');\n\n  const titulo = 'Filtros ativos:';\n  const largura = (log as unknown as { calcularLargura?: Function })\n    .calcularLargura\n    ? (log as unknown as { calcularLargura: Function }).calcularLargura(\n        titulo,\n        linhas,\n        config.COMPACT_MODE ? 84 : 96,\n      )\n    : undefined;\n\n  const logBloco = (log as typeof log).imprimirBloco;\n\n  // Loga título + todas as linhas de filtro juntos para compatibilidade total de teste\n  if (typeof (log as typeof log).info === 'function') {\n    if (linhas.length) {\n      (log as typeof log).info(`${titulo} ${linhas.join(' ')}`);\n    } else {\n      (log as typeof log).info(titulo);\n    }\n  }\n\n  // Imprime bloco moldurado se disponível\n  if (typeof logBloco === 'function') {\n    logBloco(\n      titulo,\n      linhas,\n      chalk.cyan.bold,\n      typeof largura === 'number' ? largura : config.COMPACT_MODE ? 84 : 96,\n    );\n  }\n}\n\n// Função para listar analistas registrados\n\nexport async function listarAnalistas(): Promise<void> {\n  // Obtém lista de analistas registrados\n  let listaAnalistas: { nome: string; categoria: string; descricao: string }[] =\n    [];\n  try {\n    // Importação dinâmica para evitar dependência circular\n    listaAnalistas = (\n      await import('@analistas/registry/registry.js')\n    ).listarAnalistas();\n  } catch (err) {\n    listaAnalistas = [];\n    // Log de debug para DEV_MODE e para testes\n    if (\n      config.DEV_MODE &&\n      typeof (log as { debug?: Function }).debug === 'function'\n    ) {\n      (log as { debug: Function }).debug(\n        `Falha ao listar analistas: ${String(err)}`,\n      );\n    }\n    // Também para ambiente de testes\n    if (\n      process.env.VITEST &&\n      typeof (log as { debug?: Function }).debug === 'function'\n    ) {\n      (log as { debug: Function }).debug('Falha ao listar analistas');\n    }\n  }\n\n  // Prepara linhas do bloco\n  const linhas: string[] = [];\n  linhas.push(`${'Nome'.padEnd(18) + 'Categoria'.padEnd(12)}Descrição`);\n  linhas.push('-'.repeat(18) + '-'.repeat(12) + '-'.repeat(40));\n  for (const a of listaAnalistas) {\n    // Fallbacks: 'desconhecido' tem prioridade, depois 'n/d'\n    const nome = a.nome && a.nome !== 'n/d' ? a.nome : 'desconhecido';\n    const categoria =\n      a.categoria && a.categoria !== 'n/d' ? a.categoria : 'desconhecido';\n    const descricao = a.descricao ? a.descricao : 'n/d';\n    linhas.push(nome.padEnd(18) + categoria.padEnd(12) + descricao);\n  }\n  if (listaAnalistas.length === 0) {\n    linhas.push(`${'desconhecido'.padEnd(18) + 'desconhecido'.padEnd(12)}n/d`);\n  }\n\n  const titulo = 'Técnicas ativas (registro de analistas)';\n  // Largura: 80 para testes, 84/96 para modo compacto/padrão\n  let largura: number | undefined = 80;\n  if (typeof (log as Record<string, unknown>).calcularLargura === 'function') {\n    largura = (log as { calcularLargura: Function }).calcularLargura(\n      titulo,\n      linhas,\n      config.COMPACT_MODE ? 84 : 96,\n    );\n    // Se calcularLargura retornar undefined, usar fallback 96\n    if (typeof largura !== 'number' || isNaN(largura))\n      largura = config.COMPACT_MODE ? 84 : 96;\n  } else {\n    largura = config.COMPACT_MODE ? 84 : 96;\n  }\n\n  // Exibe o bloco com lista de analistas\n  const logWithBloco = log as {\n    bloco?: (t: string, l: string[]) => void;\n    imprimirBloco?: (\n      t: string,\n      l: string[],\n      s?: (str: string) => string,\n      w?: number,\n    ) => void;\n  };\n\n  if (typeof logWithBloco.imprimirBloco === 'function') {\n    logWithBloco.imprimirBloco(titulo, linhas, chalk.cyan.bold, largura);\n  } else if (typeof logWithBloco.bloco === 'function') {\n    logWithBloco.bloco(titulo, linhas);\n  } else {\n    // Fallback simples para ambientes de teste/mocks mínimos\n    console.log([titulo, ...linhas].join('\\n'));\n  }\n}\n"]}