{"version":3,"file":"exibir-moldura.js","sourceRoot":"","sources":["../../../src/cli/helpers/exibir-moldura.ts"],"names":[],"mappings":"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","sourcesContent":["// SPDX-License-Identifier: MIT\n/**\n * Helper para exibição segura de molduras (blocos formatados)\n * Fornece fallback para ambientes onde log.bloco não está disponível\n */\n\nimport { CliExibirMolduraMensagens } from '@core/messages/cli/cli-exibir-moldura-messages.js';\nimport { log } from '@core/messages/index.js';\n\n/**\n * Exibe uma moldura formatada com fallback seguro\n *\n * Tenta usar log.bloco para exibir uma moldura estilizada.\n * Se falhar (ambiente de teste ou log.bloco não disponível),\n * usa fallback simples com log.info.\n *\n * @param titulo - Título da moldura\n * @param linhas - Linhas de conteúdo a exibir\n * @param fallbackFn - Função de fallback customizada (opcional)\n * @returns true se usou moldura, false se usou fallback\n *\n * @example\n * ```typescript\n * exibirMolduraSegura('Plano de reestruturação', [\n *   'De                  → Para',\n *   '-------------------  -------------------',\n *   'src/old.ts          → src/new.ts',\n * ]);\n * ```\n */\nexport function exibirMolduraSegura(titulo: string, linhas: string[], fallbackFn?: () => void): boolean {\n  try {\n    // Tenta usar log.bloco (disponível em produção)\n    const bloco = (log as unknown as {\n      bloco: (t: string, l: string[]) => string;\n    }).bloco(titulo, linhas);\n    console.log(bloco);\n    return true;\n  } catch {\n    // Fallback: usa função customizada ou exibição simples\n    if (fallbackFn) {\n      fallbackFn();\n    } else {\n      // Fallback padrão: exibe linhas simples com log.info\n      linhas.forEach(linha => log.info(CliExibirMolduraMensagens.fallbackLinha(linha)));\n    }\n    return false;\n  }\n}\n\n/**\n * Exibe moldura de plano de reestruturação com tratamento de overflow\n *\n * @param movimentos - Lista de movimentos (formato: { de, para })\n * @param limite - Número máximo de linhas a exibir (padrão: 10)\n */\nexport function exibirMolduraPlano(movimentos: Array<{\n  de: string;\n  para: string;\n}>, limite = 10): void {\n  const linhas: string[] = [CliExibirMolduraMensagens.planoCabecalhoLinha1, CliExibirMolduraMensagens.planoCabecalhoLinha2];\n  const primeiros = movimentos.slice(0, limite);\n  for (const m of primeiros) {\n    const de = String(m.de).replace(/\\\\/g, '/').slice(0, 34).padEnd(34, ' ');\n    const para = String(m.para).replace(/\\\\/g, '/').slice(0, 39);\n    linhas.push(`${de}  → ${para}`);\n  }\n  if (movimentos.length > limite) {\n    linhas.push(CliExibirMolduraMensagens.planoOverflow(movimentos.length - limite));\n  }\n  exibirMolduraSegura(CliExibirMolduraMensagens.planoTitulo, linhas, () => {\n    primeiros.forEach(m => log.info(CliExibirMolduraMensagens.planoFallbackLinha(m.de, m.para)));\n    if (movimentos.length > limite) {\n      log.info(CliExibirMolduraMensagens.planoFallbackOverflow(movimentos.length - limite));\n    }\n  });\n}\n\n/**\n * Exibe moldura de conflitos com tratamento de overflow\n *\n * @param conflitos - Lista de conflitos (formato: { alvo, motivo })\n * @param limite - Número máximo de linhas a exibir (padrão: 10)\n */\nexport function exibirMolduraConflitos(conflitos: Array<{\n  alvo?: string;\n  motivo?: string;\n} | unknown>, limite = 10): void {\n  const linhas: string[] = [CliExibirMolduraMensagens.conflitosCabecalhoLinha1, CliExibirMolduraMensagens.conflitosCabecalhoLinha2];\n  const primeiros = conflitos.slice(0, limite);\n  for (const c of primeiros) {\n    const alvo = String((c && typeof c === 'object' && 'alvo' in c && c.alvo) ?? JSON.stringify(c)).replace(/\\\\/g, '/').slice(0, 31).padEnd(31, ' ');\n    const motivo = String((c && typeof c === 'object' && 'motivo' in c && c.motivo) ?? '-').slice(0, 30);\n    linhas.push(`${alvo}   ${motivo}`);\n  }\n  if (conflitos.length > limite) {\n    linhas.push(CliExibirMolduraMensagens.conflitosOverflow(conflitos.length - limite));\n  }\n  exibirMolduraSegura(CliExibirMolduraMensagens.conflitosTitulo, linhas, () => {\n    primeiros.forEach(c => {\n      const alvoStr = (c && typeof c === 'object' && 'alvo' in c && c.alvo) ?? 'alvo desconhecido';\n      const motivoStr = (c && typeof c === 'object' && 'motivo' in c && c.motivo) ?? '-';\n      log.aviso(CliExibirMolduraMensagens.conflitosFallbackLinha(String(alvoStr), String(motivoStr)));\n    });\n    if (conflitos.length > limite) {\n      log.aviso(CliExibirMolduraMensagens.conflitosFallbackOverflow(conflitos.length - limite));\n    }\n  });\n}"]}