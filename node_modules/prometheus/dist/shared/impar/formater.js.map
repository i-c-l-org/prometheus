{"version":3,"file":"formater.js","sourceRoot":"","sources":["../../../src/shared/impar/formater.ts"],"names":[],"mappings":"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","sourcesContent":["// SPDX-License-Identifier: MIT\n// @prometheus-disable PROBLEMA_PERFORMANCE\n// Justificativa: formatador que processa código - loops são esperados\n\nimport fs from 'node:fs';\nimport { createRequire } from 'node:module';\nimport path from 'node:path';\n\nimport { XMLValidator } from 'fast-xml-parser';\n\nimport type { FormatadorMinimoParser, FormatadorMinimoResult } from '@';\n\nimport type { FormatterFn } from './formatter-registry.js';\nimport { getFormatterForPath, registerFormatter } from './formatter-registry.js';\nimport { getSyntaxInfoForPath } from './syntax-map.js';\n\n// Re-exportar para compatibilidade com código existente\nexport type { FormatadorMinimoParser, FormatadorMinimoResult } from '@';\nfunction normalizarFimDeLinha(code: string): string {\n  return code.replace(/\\r\\n?/g, '\\n');\n}\nfunction removerBom(code: string): string {\n  return code.length > 0 && code.charCodeAt(0) === 0xfeff ? code.slice(1) : code;\n}\nfunction normalizarNewlinesFinais(code: string): string {\n  // Mantém exatamente uma quebra de linha no final.\n  const normalized = normalizarFimDeLinha(code);\n  return `${normalized.replace(/\\n+$/g, '')}\\n`;\n}\nfunction removerEspacosFinaisPorLinha(code: string): string {\n  return removerEspacosFinaisPorLinhaComProtecao(code);\n}\nfunction removerEspacosFinaisPorLinhaComProtecao(code: string, protectedLines?: ReadonlySet<number> | null): string {\n  return code.split('\\n').map((l, idx) => {\n    const lineNo = idx + 1;\n    if (protectedLines && protectedLines.has(lineNo)) return l;\n    return l.replace(/[ \\t]+$/g, '');\n  }).join('\\n');\n}\nfunction matchMarkdownFence(line: string): {\n  ch: '`' | '~';\n  len: number;\n  rest: string;\n} | null {\n  // CommonMark: fence pode ter info string na abertura, mas o fechamento não\n  // pode ter nada além de whitespace após os ticks/tiles.\n  const trimmedLeft = line.replace(/^\\s+/, '');\n  const m = trimmedLeft.match(/^([`~])\\1{2,}/);\n  if (!m) return null;\n  const ch = (m[1] ?? '`') as '`' | '~';\n  const len = (m[0] ?? '').length;\n  const rest = trimmedLeft.slice(len);\n  return {\n    ch,\n    len,\n    rest\n  };\n}\nfunction isMarkdownFenceCloser(match: {\n  ch: '`' | '~';\n  len: number;\n  rest: string;\n}, fenceChar: '`' | '~' | null, fenceLen: number): boolean {\n  return fenceChar !== null && match.ch === fenceChar && match.len >= fenceLen && match.rest.trim() === '';\n}\nfunction isJsTsFile(relPath?: string): boolean {\n  const rp = (relPath ?? '').toLowerCase();\n  return rp.endsWith('.ts') || rp.endsWith('.tsx') || rp.endsWith('.cts') || rp.endsWith('.mts') || rp.endsWith('.js') || rp.endsWith('.jsx') || rp.endsWith('.mjs') || rp.endsWith('.cjs');\n}\nfunction getProtectedLinesFromTemplateLiterals(code: string, relPath: string): Set<number> | null {\n  // Protege conteúdo de template literals (backticks) contra transforms line-based.\n  // Isso evita quebrar strings multilinha que pareçam comentários/divisores.\n  try {\n    const req = createRequire(import.meta.url);\n    const parser = req('@babel/parser') as {\n      parse: (src: string, opts: Record<string, unknown>) => unknown;\n    };\n    const rp = (relPath ?? '').toLowerCase();\n    const plugins: string[] = ['importMeta', 'dynamicImport', 'topLevelAwait', 'classProperties', 'classPrivateProperties', 'classPrivateMethods', 'classStaticBlock', 'optionalChaining', 'nullishCoalescingOperator', 'numericSeparator', 'logicalAssignment', 'privateIn', 'objectRestSpread', 'decorators-legacy'];\n    const isTs = rp.endsWith('.ts') || rp.endsWith('.tsx') || rp.endsWith('.cts') || rp.endsWith('.mts');\n    const isJsx = rp.endsWith('.jsx') || rp.endsWith('.tsx');\n    if (isTs) plugins.push('typescript');\n    if (isJsx) plugins.push('jsx');\n    const ast = parser.parse(code, {\n      sourceType: 'unambiguous',\n      errorRecovery: true,\n      allowReturnOutsideFunction: true,\n      allowAwaitOutsideFunction: true,\n      plugins\n    });\n    const protectedLines = new Set<number>();\n    const seen = new Set<object>();\n    const isObject = (v: unknown): v is Record<string, unknown> => typeof v === 'object' && v !== null;\n    const walk = (node: unknown) => {\n      if (!isObject(node)) return;\n      if (seen.has(node as object)) return;\n      seen.add(node as object);\n      const anyNode = node as Record<string, unknown>;\n      if (anyNode.type === 'TemplateLiteral') {\n        const loc = anyNode.loc as {\n          start: {\n            line: number;\n          };\n          end: {\n            line: number;\n          };\n        } | undefined;\n        if (loc?.start?.line && loc?.end?.line) {\n          for (let ln = loc.start.line; ln <= loc.end.line; ln++) {\n            protectedLines.add(ln);\n          }\n        }\n      }\n      for (const k of Object.keys(anyNode)) {\n        if (k === 'loc' || k === 'start' || k === 'end') continue;\n        const v = anyNode[k];\n        if (Array.isArray(v)) {\n          for (const item of v) walk(item);\n          continue;\n        }\n        if (isObject(v)) {\n          const child = v as Record<string, unknown>;\n          if (typeof child.type === 'string') walk(child);\n        }\n      }\n    };\n    walk(ast);\n    return protectedLines.size > 0 ? protectedLines : null;\n  } catch {\n    return null;\n  }\n}\nfunction limitarLinhasEmBranco(code: string, maxConsecutivas = 2, protectedLines?: ReadonlySet<number> | null): {\n  code: string;\n  changed: boolean;\n} {\n  const lines = normalizarFimDeLinha(code).split('\\n');\n  const out: string[] = [];\n  let consecutivas = 0;\n  let changed = false;\n  for (let i = 0; i < lines.length; i++) {\n    const line = lines[i] ?? '';\n    const lineNo = i + 1;\n    if (protectedLines && protectedLines.has(lineNo)) {\n      out.push(line);\n      consecutivas = 0;\n      continue;\n    }\n    const isBlank = line.trim() === '';\n    if (isBlank) {\n      consecutivas += 1;\n      if (consecutivas > maxConsecutivas) {\n        changed = true;\n        continue;\n      }\n    } else {\n      consecutivas = 0;\n    }\n    out.push(line);\n  }\n  return {\n    code: out.join('\\n'),\n    changed\n  };\n}\nfunction assegurarLinhaVaziaAposTitulosMarkdown(code: string): {\n  code: string;\n  changed: boolean;\n} {\n  const lines = normalizarFimDeLinha(code).split('\\n');\n  const out: string[] = [];\n  let changed = false;\n  let inFence = false;\n  let fenceChar: '`' | '~' | null = null;\n  let fenceLen = 0;\n  for (let i = 0; i < lines.length; i++) {\n    const line = lines[i] ?? '';\n    const fence = matchMarkdownFence(line);\n    if (!inFence && fence) {\n      inFence = true;\n      fenceChar = fence.ch;\n      fenceLen = fence.len;\n      out.push(line);\n      continue;\n    }\n    if (inFence && fence && isMarkdownFenceCloser(fence, fenceChar, fenceLen)) {\n      inFence = false;\n      fenceChar = null;\n      fenceLen = 0;\n      out.push(line);\n      continue;\n    }\n    if (inFence) {\n      out.push(line);\n      continue;\n    }\n    out.push(line);\n    const ehHeading = /^#{1,6}\\s+\\S/.test(line.trim());\n    const proxima = lines[i + 1];\n    const precisaEspaco = ehHeading && proxima !== undefined && proxima.trim() !== '';\n    if (precisaEspaco) {\n      out.push('');\n      changed = true;\n    }\n  }\n  return {\n    code: out.join('\\n'),\n    changed\n  };\n}\nfunction stripDiacritics(input: string): string {\n  // Remove acentos sem alterar espaçamento; útil para info string de cercas (```èxemplo -> ```exemplo)\n  return input.normalize('NFD').replace(/\\p{M}+/gu, '').normalize('NFC');\n}\nfunction normalizarCercasMarkdown(code: string): {\n  code: string;\n  changed: boolean;\n} {\n  const lines = normalizarFimDeLinha(code).split('\\n');\n  let changed = false;\n  const out = lines.map(line => {\n    // Corrige erro comum de teclado: \"``è\" como se fosse \"```\".\n    const typo = line.match(/^(\\s*)``è(.*)$/);\n    if (typo) {\n      const prefix = typo[1] ?? '';\n      const after = typo[2] ?? '';\n      const normalized = `${prefix}\\`\\`\\`${after}`;\n      if (normalized !== line) changed = true;\n      return normalized;\n    }\n    const m = line.match(/^(\\s*)(`{3,}|~{3,})(.*)$/);\n    if (!m) return line;\n    const prefix = m[1] ?? '';\n    const fence = m[2] ?? '';\n    const afterFence = m[3] ?? '';\n\n    // Não adiciona/remover espaços após a cerca; só normaliza o primeiro token da info string.\n    const info = afterFence.match(/^(\\s*)(\\S+)(.*)$/);\n    if (!info) return line;\n    const lead = info[1] ?? '';\n    const token = info[2] ?? '';\n    const tail = info[3] ?? '';\n\n    // Só mexe no token se houver diacríticos (ou não-ASCII). Mantém resto intacto.\n    const shouldNormalizeToken = /[^\\x00-\\x7F]/.test(token);\n    if (!shouldNormalizeToken) return line;\n    const normalizedToken = stripDiacritics(token);\n    const normalized = `${prefix}${fence}${lead}${normalizedToken}${tail}`;\n    if (normalized !== line) changed = true;\n    return normalized;\n  });\n  return {\n    code: out.join('\\n'),\n    changed\n  };\n}\nfunction corrigirHtmlInlineEmMarkdown(text: string): {\n  text: string;\n  changed: boolean;\n} {\n  let changed = false;\n  const fixed = text.replace(/<[^>\\n]+>/g, tag => {\n    if (tag.startsWith('<!--') || tag.startsWith('<!')) return tag;\n    let t = tag;\n    t = t.replace(/^<\\s+/, '<').replace(/^<\\/\\s+/, '</');\n    t = t.replace(/\\s+\\/>$/, '/>').replace(/\\s+>$/, '>');\n    // Normaliza fechamento com espaço: </ div> -> </div>\n    t = t.replace(/^<\\/\\s+/, '</');\n    if (t !== tag) changed = true;\n    return t;\n  });\n  return {\n    text: fixed,\n    changed\n  };\n}\nfunction corrigirEnfaseMarkdown(text: string): {\n  text: string;\n  changed: boolean;\n} {\n  let changed = false;\n  let out = text;\n  const apply = (re: RegExp, replacer: string) => {\n    const next = out.replace(re, replacer);\n    if (next !== out) changed = true;\n    out = next;\n  };\n\n  // Casos explícitos do pedido:\n  // - **exemplo*** -> **exemplo**\n  // - *exemplo**  -> *exemplo*\n  // Sem inserir espaços e sem atravessar quebras de linha.\n  apply(/\\*\\*([^\\s*][^*\\n]*?)\\*\\*\\*(?!\\*)/g, '**$1**');\n  apply(/(^|[^*])\\*([^\\s*][^*\\n]*?)\\*\\*(?!\\*)/g, '$1*$2*');\n  apply(/(^|[^*])\\*([^\\s*][^*\\n]*?)\\*\\*\\*(?!\\*)/g, '$1*$2*');\n  return {\n    text: out,\n    changed\n  };\n}\nfunction corrigirMarkdownInlineForaDeCodigo(code: string): {\n  code: string;\n  changed: boolean;\n} {\n  const lines = normalizarFimDeLinha(code).split('\\n');\n  const out: string[] = [];\n  let changed = false;\n  let inFence = false;\n  let fenceChar: '`' | '~' | null = null;\n  let fenceLen = 0;\n  const processOutsideCodigoSpans = (text: string): string => {\n    // Tokeniza code spans por runs de backticks e não altera dentro deles.\n    let i = 0;\n    let acc = '';\n    while (i < text.length) {\n      const tickInicio = text.indexOf('`', i);\n      if (tickInicio === -1) {\n        const chunk = text.slice(i);\n        let next = chunk;\n        const e = corrigirEnfaseMarkdown(next);\n        next = e.text;\n        const h = corrigirHtmlInlineEmMarkdown(next);\n        next = h.text;\n        if (next !== chunk) changed = true;\n        acc += next;\n        break;\n      }\n      const chunk = text.slice(i, tickInicio);\n      let next = chunk;\n      const e = corrigirEnfaseMarkdown(next);\n      next = e.text;\n      const h = corrigirHtmlInlineEmMarkdown(next);\n      next = h.text;\n      if (next !== chunk) changed = true;\n      acc += next;\n      let runFim = tickInicio;\n      while (runFim < text.length && text[runFim] === '`') runFim++;\n      const run = text.slice(tickInicio, runFim);\n      const closeIndex = text.indexOf(run, runFim);\n      if (closeIndex === -1) {\n        // Sem fechamento; preserva o resto como está.\n        acc += text.slice(tickInicio);\n        break;\n      }\n      acc += text.slice(tickInicio, closeIndex + run.length);\n      i = closeIndex + run.length;\n    }\n    return acc;\n  };\n  for (const line of lines) {\n    const fence = matchMarkdownFence(line);\n    if (!inFence && fence) {\n      inFence = true;\n      fenceChar = fence.ch;\n      fenceLen = fence.len;\n      out.push(line);\n      continue;\n    }\n    if (inFence && fence && isMarkdownFenceCloser(fence, fenceChar, fenceLen)) {\n      inFence = false;\n      fenceChar = null;\n      fenceLen = 0;\n      out.push(line);\n      continue;\n    }\n    if (inFence) {\n      out.push(line);\n      continue;\n    }\n    out.push(processOutsideCodigoSpans(line));\n  }\n  return {\n    code: out.join('\\n'),\n    changed\n  };\n}\nfunction limitarLinhasEmBrancoMarkdown(code: string, maxConsecutivas = 2): {\n  code: string;\n  changed: boolean;\n} {\n  const lines = normalizarFimDeLinha(code).split('\\n');\n  const out: string[] = [];\n  let consecutivas = 0;\n  let changed = false;\n  let inFence = false;\n  let fenceChar: '`' | '~' | null = null;\n  let fenceLen = 0;\n  for (const line of lines) {\n    const fence = matchMarkdownFence(line);\n    if (!inFence && fence) {\n      inFence = true;\n      fenceChar = fence.ch;\n      fenceLen = fence.len;\n      consecutivas = 0;\n      out.push(line);\n      continue;\n    }\n    if (inFence && fence && isMarkdownFenceCloser(fence, fenceChar, fenceLen)) {\n      inFence = false;\n      fenceChar = null;\n      fenceLen = 0;\n      consecutivas = 0;\n      out.push(line);\n      continue;\n    }\n    if (inFence) {\n      out.push(line);\n      continue;\n    }\n    const isBlank = line.trim() === '';\n    if (isBlank) {\n      consecutivas += 1;\n      if (consecutivas > maxConsecutivas) {\n        changed = true;\n        continue;\n      }\n    } else {\n      consecutivas = 0;\n    }\n    out.push(line);\n  }\n  return {\n    code: out.join('\\n'),\n    changed\n  };\n}\nfunction normalizarSeparadoresDeSecao(code: string, opts: {\n  relPath?: string;\n  protectedLines?: ReadonlySet<number> | null;\n} = {}): {\n  code: string;\n  changed: boolean;\n} {\n  const lines = normalizarFimDeLinha(code).split('\\n');\n  const out: string[] = [];\n  let changed = false;\n  const specialTitlesBySymbol: Record<string, string> = {\n    FormatadorMensagens: 'MENSAGENS FORMATADOR (MIN)',\n    SvgMensagens: 'MENSAGENS SVG (OTIMIZAÇÃO)'\n  };\n  const toUpperTitle = (raw: string): string => {\n    const trimmed = raw.trim();\n    if (!trimmed) return trimmed;\n    const withSpaces = trimmed.replace(/([a-z\\d])([A-Z])/g, '$1 $2').replace(/([A-Z]+)([A-Z][a-z])/g, '$1 $2').replace(/[_\\-]+/g, ' ').replace(/\\s+/g, ' ').trim();\n    const upper = withSpaces.toUpperCase();\n    return upper;\n  };\n  const inferTitleFromNextSymbol = (fromIndex: number): string | null => {\n    for (let j = fromIndex + 1; j < Math.min(lines.length, fromIndex + 35); j++) {\n      const l = (lines[j] ?? '').trim();\n      if (!l) continue;\n      if (l.startsWith('//')) continue;\n      if (l.startsWith('/*')) continue;\n      const m = l.match(/^(?:export\\s+)?(?:const|function|class|interface|type)\\s+([A-Za-z_$][\\w$]*)\\b/);\n      if (!m) continue;\n      const symbol = m[1] ?? '';\n      if (!symbol) continue;\n      const special = specialTitlesBySymbol[symbol];\n      if (special) return special;\n      if (symbol.endsWith('Messages')) {\n        const base = symbol.slice(0, -'Messages'.length);\n        const baseTitle = toUpperTitle(base);\n        return baseTitle ? `MENSAGENS ${baseTitle}` : 'MENSAGENS';\n      }\n      return toUpperTitle(symbol);\n    }\n    const relPath = (opts.relPath ?? '').toLowerCase();\n    if (relPath.includes('/messages/') || relPath.includes('messages')) return 'MENSAGENS';\n    return null;\n  };\n  const parseNovoSeparadorComMarcacao = (line: string): {\n    titulo: string | null;\n  } | null => {\n    // Formato legado aceito (compat): /* -------------------------- substituir por titulo (opcionalmente com um título embutido) -------------------------- */\n    const m = line.match(/^\\s*\\/\\*\\s*-{10,}\\s*substituir\\s+por\\s+titulo\\s+@prometheus-secao(?:\\((.+?)\\))?\\s*-{10,}\\s*\\*\\/\\s*$/i);\n    if (!m) return null;\n    const raw = (m[1] ?? '').trim();\n    return {\n      titulo: raw ? raw : null\n    };\n  };\n  const isSeparadorSemTitulo = (line: string): boolean => {\n    // Ex.: /* -------------------------- substituir por titulo -------------------------- */\n    // Ex.: /* -------------------------- - -------------------------- */\n    return /^\\s*\\/\\*\\s*-{10,}\\s*substituir\\s+por\\s+titulo\\s*-{10,}\\s*\\*\\/\\s*$/i.test(line) || /^\\s*\\/\\*\\s*-{10,}\\s*-\\s*-{10,}\\s*\\*\\/\\s*$/.test(line) || /^\\s*\\/\\*\\s*-{10,}\\s*@prometheus-secao\\s*-{10,}\\s*\\*\\/\\s*$/i.test(line);\n  };\n  const buildSeparatorWithTitle = (title: string): string => {\n    return `  /* -------------------------- ${title} -------------------------- */`;\n  };\n  const isDivider = (line: string): boolean => /^\\s*\\/\\/\\s*(?:[=\\-_*]){8,}\\s*$/.test(line) || /^\\s*\\/\\*\\s*(?:[=\\-_*]){8,}\\s*\\*\\/\\s*$/.test(line);\n  const extractTitleFromLineComment = (line: string): string | null => {\n    const m = line.match(/^\\s*\\/\\/\\s*(.+?)\\s*$/);\n    if (!m) return null;\n    const t = m[1].trim();\n    if (!t) return null;\n    // ignora divisores e comentários \"vazios\"\n    if (/^(?:[=\\-_*]){5,}$/.test(t)) return null;\n    return t;\n  };\n  const extractTitleFromBlockComment = (line: string): string | null => {\n    const m = line.match(/^\\s*\\/\\*\\s*(.+?)\\s*\\*\\/\\s*$/);\n    if (!m) return null;\n    const t = m[1].trim();\n    if (!t) return null;\n    if (/^(?:[=\\-_*]){5,}$/.test(t)) return null;\n    return t;\n  };\n  const extractTitleFromSingleLine = (line: string): string | null => {\n    // Ex.: // ======= TITULO =======\n    const m = line.match(/^\\s*\\/\\/\\s*(?:[=\\-_*]){5,}\\s*(.+?)\\s*(?:[=\\-_*]){5,}\\s*$/);\n    if (!m) return null;\n    const t = m[1].trim();\n    return t ? t : null;\n  };\n  const extractTitleFromSingleBlockLine = (line: string): string | null => {\n    // Ex.: /* ======= TITULO ======= */\n    const m = line.match(/^\\s*\\/\\*\\s*(?:[=\\-_*]){5,}\\s*(.+?)\\s*(?:[=\\-_*]){5,}\\s*\\*\\/\\s*$/);\n    if (!m) return null;\n    const t = m[1].trim();\n    return t ? t : null;\n  };\n  const buildSeparator = (originalTitle: string): string => buildSeparatorWithTitle(originalTitle);\n  for (let i = 0; i < lines.length; i++) {\n    const line = lines[i] ?? '';\n    const lineNo = i + 1;\n    if (opts.protectedLines && opts.protectedLines.has(lineNo)) {\n      out.push(line);\n      continue;\n    }\n\n    // Caso -1: separador placeholder (sem título) -> tenta inferir pelo contexto.\n    if (isSeparadorSemTitulo(line)) {\n      const inferred = inferTitleFromNextSymbol(i);\n      if (inferred) {\n        out.push(buildSeparatorWithTitle(inferred));\n        changed = true;\n      } else {\n        out.push(line);\n      }\n      continue;\n    }\n\n    // Caso 0: separador já no formato novo com marcação; promover para título correto.\n    const novo = parseNovoSeparadorComMarcacao(line);\n    if (novo) {\n      if (novo.titulo) {\n        out.push(buildSeparatorWithTitle(novo.titulo));\n        changed = true;\n      } else {\n        const inferred = inferTitleFromNextSymbol(i);\n        if (inferred) {\n          out.push(buildSeparatorWithTitle(inferred));\n          changed = true;\n        } else {\n          out.push(line);\n        }\n      }\n      continue;\n    }\n\n    // Caso 1: bloco de 3 linhas\n    // // ======\n    // // TITULO\n    // // ======\n    if (isDivider(line) && i + 2 < lines.length && isDivider(lines[i + 2] ?? '')) {\n      if (opts.protectedLines && (opts.protectedLines.has(i + 1) || opts.protectedLines.has(i + 2) || opts.protectedLines.has(i + 3))) {\n        out.push(line);\n        continue;\n      }\n      const middle = lines[i + 1] ?? '';\n      const title = extractTitleFromLineComment(middle) ?? extractTitleFromBlockComment(middle);\n      if (title) {\n        out.push(buildSeparator(title));\n        i += 2;\n        changed = true;\n        continue;\n      }\n    }\n\n    // Caso 2: linha única com título centralizado\n    const singleLine = extractTitleFromSingleLine(line);\n    const singleBlock = extractTitleFromSingleBlockLine(line);\n    const single = singleLine ?? singleBlock;\n    if (single) {\n      out.push(buildSeparator(single));\n      changed = true;\n      continue;\n    }\n    out.push(line);\n  }\n  return {\n    code: out.join('\\n'),\n    changed\n  };\n}\nfunction formatarCodeMinimo(code: string, opts: {\n  normalizarSeparadoresDeSecao?: boolean;\n  relPath?: string;\n  parser?: FormatadorMinimoParser;\n} = {}): FormatadorMinimoResult {\n  const normalized = normalizarFimDeLinha(removerBom(code));\n  const protectedLines = opts.relPath && isJsTsFile(opts.relPath) ? getProtectedLinesFromTemplateLiterals(normalized, opts.relPath) : null;\n  const semEspacosFinais = removerEspacosFinaisPorLinhaComProtecao(normalized, protectedLines);\n  const shouldNormalizeSeparators = opts.normalizarSeparadoresDeSecao ?? true;\n  const {\n    code: maybeSeparadores,\n    changed: changedSeparators\n  } = shouldNormalizeSeparators ? normalizarSeparadoresDeSecao(semEspacosFinais, {\n    relPath: opts.relPath,\n    protectedLines\n  }) : {\n    code: semEspacosFinais,\n    changed: false\n  };\n  const {\n    code: semBlanks,\n    changed: changedBlanks\n  } = limitarLinhasEmBranco(maybeSeparadores, 2, protectedLines);\n  const formatted = normalizarNewlinesFinais(semBlanks);\n  const baseline = normalizarNewlinesFinais(normalized);\n  const changed = formatted !== baseline;\n  return {\n    ok: true,\n    parser: opts.parser ?? 'code',\n    formatted,\n    changed,\n    reason: changedSeparators ? 'normalizacao-separadores' : changedBlanks ? 'limpeza-linhas-em-branco' : 'normalizacao-basica'\n  };\n}\nfunction formatarJsonMinimo(code: string): FormatadorMinimoResult {\n  try {\n    // Normalizar entrada: remover BOM, normalizar line endings\n    const normalizedInput = normalizarFimDeLinha(removerBom(code));\n\n    // Parsear JSON\n    const parsed = JSON.parse(normalizedInput) as unknown;\n\n    // Formatar com 2 espaços de indentação + newline final\n    const formatted = normalizarNewlinesFinais(JSON.stringify(parsed, null, 2));\n\n    // Comparar contra entrada normalizada (com newline final consistente)\n    // Isso evita falsos positivos por diferença de line endings ou BOM\n    const normalizedForComparison = normalizarNewlinesFinais(normalizedInput);\n    const changed = formatted !== normalizedForComparison;\n    return {\n      ok: true,\n      parser: 'json',\n      formatted,\n      changed\n    };\n  } catch (err) {\n    return {\n      ok: false,\n      parser: 'json',\n      error: err instanceof Error ? err.message : String(err)\n    };\n  }\n}\nfunction formatarMarkdownMinimo(code: string): FormatadorMinimoResult {\n  const normalized = normalizarFimDeLinha(code);\n  const trimmed = removerEspacosFinaisPorLinha(normalized);\n  const {\n    code: cercasNormalizadas,\n    changed: changedFences\n  } = normalizarCercasMarkdown(trimmed);\n  const {\n    code: markdownCorrigido,\n    changed: changedInline\n  } = corrigirMarkdownInlineForaDeCodigo(cercasNormalizadas);\n  const {\n    code: comEspacoTitulos,\n    changed: changedHeadings\n  } = assegurarLinhaVaziaAposTitulosMarkdown(markdownCorrigido);\n  const {\n    code: semBlanks,\n    changed: changedBlanks\n  } = limitarLinhasEmBrancoMarkdown(comEspacoTitulos, 2);\n  const formatted = normalizarNewlinesFinais(semBlanks);\n  return {\n    ok: true,\n    parser: 'markdown',\n    formatted,\n    changed: formatted !== normalizarNewlinesFinais(normalized),\n    reason: changedFences || changedInline || changedHeadings || changedBlanks ? 'estilo-prometheus-markdown' : 'normalizacao-basica'\n  };\n}\nfunction formatarYamlMinimo(code: string): FormatadorMinimoResult {\n  const normalized = normalizarFimDeLinha(code);\n  const trimmed = removerEspacosFinaisPorLinha(normalized);\n  const {\n    code: semBlanks,\n    changed: changedBlanks\n  } = limitarLinhasEmBranco(trimmed, 2);\n  const formatted = normalizarNewlinesFinais(semBlanks);\n  return {\n    ok: true,\n    parser: 'yaml',\n    formatted,\n    changed: formatted !== normalizarNewlinesFinais(normalized),\n    reason: changedBlanks ? 'estilo-prometheus-yaml' : 'normalizacao-basica'\n  };\n}\nfunction tokenizeXml(src: string): Array<{\n  kind: 'tag' | 'text';\n  value: string;\n}> {\n  // Mantém comentários/CDATA/PI/DOCTYPE como \"tag\" para não serem alterados.\n  const re = /(<\\?[\\s\\S]*?\\?>|<!--[\\s\\S]*?-->|<!\\[CDATA\\[[\\s\\S]*?\\]\\]>|<!DOCTYPE[\\s\\S]*?>|<\\/?[^>\\n]+?>)/gi;\n  const out: Array<{\n    kind: 'tag' | 'text';\n    value: string;\n  }> = [];\n  let last = 0;\n  for (const m of src.matchAll(re)) {\n    const start = m.index ?? -1;\n    if (start < 0) continue;\n    if (start > last) out.push({\n      kind: 'text',\n      value: src.slice(last, start)\n    });\n    out.push({\n      kind: 'tag',\n      value: m[0] ?? ''\n    });\n    last = start + (m[0]?.length ?? 0);\n  }\n  if (last < src.length) out.push({\n    kind: 'text',\n    value: src.slice(last)\n  });\n  return out;\n}\nfunction normalizeXmlTagToken(tag: string): {\n  tag: string;\n  changed: boolean;\n} {\n  // Não mexe em comentários, CDATA, DOCTYPE/declarações e PI.\n  if (tag.startsWith('<!--') || tag.startsWith('<![CDATA[')) return {\n    tag,\n    changed: false\n  };\n  if (tag.startsWith('<?')) return {\n    tag,\n    changed: false\n  };\n  if (tag.startsWith('<!')) return {\n    tag,\n    changed: false\n  };\n  let out = tag;\n  const original = tag;\n\n  // Normaliza espaços imediatamente após \"<\" e \"</\".\n  out = out.replace(/^<\\s+/, '<');\n  out = out.replace(/^<\\/\\s+/, '</');\n\n  // Remove espaços antes de \">\" e de \"/>\".\n  out = out.replace(/\\s+\\/>$/, '/>');\n  out = out.replace(/\\s+>$/, '>');\n\n  // Colapsa múltiplos espaços fora de aspas dentro da tag.\n  let buf = '';\n  let inQuote: '\"' | \"'\" | null = null;\n  let prevWasSpace = false;\n  for (let i = 0; i < out.length; i++) {\n    const ch = out[i] ?? '';\n    if (inQuote) {\n      buf += ch;\n      if (ch === inQuote) inQuote = null;\n      continue;\n    }\n    if (ch === '\"' || ch === \"'\") {\n      inQuote = ch as '\"' | \"'\";\n      buf += ch;\n      prevWasSpace = false;\n      continue;\n    }\n    if (/\\s/.test(ch)) {\n      if (!prevWasSpace) {\n        buf += ' ';\n        prevWasSpace = true;\n      }\n      continue;\n    }\n    prevWasSpace = false;\n    buf += ch;\n  }\n  out = buf;\n\n  // Garante que não exista espaço após \"<\" ou \"</\" novamente (pós-colapso).\n  out = out.replace(/^<\\s+/, '<');\n  out = out.replace(/^<\\/\\s+/, '</');\n\n  // Remove espaço antes do fechamento após colapso.\n  out = out.replace(/\\s+\\/>$/, '/>');\n  out = out.replace(/\\s+>$/, '>');\n  return {\n    tag: out,\n    changed: out !== original\n  };\n}\nfunction hasXmlMixedContent(tokens: Array<{\n  kind: 'tag' | 'text';\n  value: string;\n}>): boolean {\n  for (const t of tokens) {\n    if (t.kind !== 'text') continue;\n    // Se existe texto não-whitespace entre tags, indentação pode alterar semântica.\n    if (/[\\S]/.test(t.value)) return true;\n  }\n  return false;\n}\nfunction prettyPrintXmlIfSafe(xml: string): {\n  xml: string;\n  changed: boolean;\n} {\n  const tokens = tokenizeXml(xml);\n  if (hasXmlMixedContent(tokens)) return {\n    xml,\n    changed: false\n  };\n  let changed = false;\n  let indent = 0;\n  const indentStr = (n: number) => '  '.repeat(Math.max(0, n));\n  const outLines: string[] = [];\n  const pushLine = (line: string) => {\n    if (!line) return;\n    outLines.push(line);\n  };\n  for (const tok of tokens) {\n    if (tok.kind === 'text') {\n      // texto é só whitespace aqui; ignoramos e reconstruímos.\n      continue;\n    }\n    const raw = tok.value.trim();\n    if (!raw) continue;\n    const isClosing = /^<\\//.test(raw);\n    const isSelfClosing = /\\/>$/.test(raw);\n    const isDecl = /^<\\?xml\\b/i.test(raw) || /^<\\?/.test(raw);\n    const isDoctype = /^<!DOCTYPE\\b/i.test(raw);\n    const isComment = /^<!--/.test(raw);\n    const isCdata = /^<!\\[CDATA\\[/.test(raw);\n    if (isClosing) indent = Math.max(0, indent - 1);\n    const line = `${indentStr(indent)}${raw}`;\n    pushLine(line);\n    if (!isClosing && !isSelfClosing && !isDecl && !isDoctype && !isComment && !isCdata) {\n      indent += 1;\n    }\n  }\n  const out = `${outLines.join('\\n').trimEnd()}\\n`;\n  if (out !== xml) changed = true;\n  return {\n    xml: out,\n    changed\n  };\n}\nfunction formatarXmlMinimo(code: string): FormatadorMinimoResult {\n  const normalized = normalizarFimDeLinha(removerBom(code));\n  const semEspacosFinais = removerEspacosFinaisPorLinha(normalized);\n\n  // 1) Correções seguras de tags (sem tocar em CDATA/comentários)\n  const tokens = tokenizeXml(semEspacosFinais);\n  let changedTokens = false;\n  const rebuilt = tokens.map(t => {\n    if (t.kind === 'text') return t.value;\n    const r = normalizeXmlTagToken(t.value);\n    if (r.changed) changedTokens = true;\n    return r.tag;\n  }).join('');\n\n  // 2) Se ficar válido e sem mixed content, aplica pretty-print.\n  let pretty = rebuilt;\n  let changedPretty = false;\n  const valid = XMLValidator.validate(pretty);\n  if (valid === true) {\n    const pp = prettyPrintXmlIfSafe(pretty);\n    pretty = pp.xml;\n    changedPretty = pp.changed;\n  } else {\n    // Mesmo inválido, ao menos normaliza newline final.\n    pretty = `${pretty.trimEnd()}\\n`;\n  }\n  const formatted = normalizarNewlinesFinais(pretty);\n  const baseline = normalizarNewlinesFinais(normalized);\n  return {\n    ok: true,\n    parser: 'xml',\n    formatted,\n    changed: formatted !== baseline,\n    reason: changedPretty ? 'xml-pretty' : changedTokens ? 'xml-normalizacao-tags' : 'normalizacao-basica'\n  };\n}\nexport function formatarPrettierMinimo(params: {\n  code: string;\n  relPath?: string;\n}): FormatadorMinimoResult {\n  const relPath = (params.relPath ?? '').toLowerCase();\n  const code = params.code;\n  const temComentariosJsonc = (src: string): boolean => {\n    const normalized = normalizarFimDeLinha(src);\n    return /(^|\\n)\\s*\\/\\//.test(normalized) || /(^|\\n)\\s*\\/\\*/.test(normalized);\n  };\n  if (relPath.endsWith('.json')) {\n    // Alguns arquivos .json do ecossistema TS usam comentários (JSONC), ex.: tsconfig*.json.\n    // Nesses casos, não tentamos parsear como JSON; apenas normalizamos whitespace.\n    if (temComentariosJsonc(code)) {\n      return formatarCodeMinimo(code, {\n        normalizarSeparadoresDeSecao: false,\n        relPath\n      });\n    }\n    return formatarJsonMinimo(code);\n  }\n  if (relPath.endsWith('.md') || relPath.endsWith('.markdown')) {\n    return formatarMarkdownMinimo(code);\n  }\n  if (relPath.endsWith('.yml') || relPath.endsWith('.yaml')) {\n    return formatarYamlMinimo(code);\n  }\n  if (relPath.endsWith('.ts') || relPath.endsWith('.tsx') || relPath.endsWith('.cts') || relPath.endsWith('.mts') || relPath.endsWith('.js') || relPath.endsWith('.jsx') || relPath.endsWith('.mjs') || relPath.endsWith('.cjs')) {\n    // Para JS/TS, normalizamos separadores de seção (inclui formatos legados).\n    return formatarCodeMinimo(code, {\n      normalizarSeparadoresDeSecao: true,\n      relPath\n    });\n  }\n  if (relPath.endsWith('.html') || relPath.endsWith('.htm')) {\n    return formatarCodeMinimo(code, {\n      normalizarSeparadoresDeSecao: false,\n      parser: 'html'\n    });\n  }\n  if (relPath.endsWith('.xml')) {\n    return formatarXmlMinimo(code);\n  }\n  if (relPath.endsWith('.css')) {\n    return formatarCodeMinimo(code, {\n      normalizarSeparadoresDeSecao: true,\n      parser: 'css'\n    });\n  }\n  if (relPath.endsWith('.py')) {\n    return formatarCodeMinimo(code, {\n      normalizarSeparadoresDeSecao: false,\n      parser: 'python'\n    });\n  }\n  if (relPath.endsWith('.php')) {\n    return formatarCodeMinimo(code, {\n      normalizarSeparadoresDeSecao: false,\n      parser: 'php'\n    });\n  }\n  return {\n    ok: true,\n    parser: 'unknown',\n    formatted: code,\n    changed: false\n  };\n}\ntype PrettierApi = {\n  format: (code: string, options: Record<string, unknown>) => string | Promise<string>;\n  resolveConfig: (fileCaminho: string, options?: Record<string, unknown>) => Promise<Record<string, unknown> | null>;\n};\nconst prettierCache = new Map<string, Promise<PrettierApi | null>>();\nasync function carregarPrettierDoProjeto(baseDir: string): Promise<PrettierApi | null> {\n  const base = baseDir || process.cwd();\n  const cached = prettierCache.get(base);\n  if (cached) return cached;\n  const loader = (async (): Promise<PrettierApi | null> => {\n    const tryImportPrettier = async (resolved: string): Promise<PrettierApi | null> => {\n      try {\n        const mod = (await import(resolved)) as unknown as {\n          default?: unknown;\n        };\n        const api = (mod && typeof mod === 'object' && 'default' in mod ? mod.default : mod) as PrettierApi | undefined;\n        if (!api || typeof api.format !== 'function' || typeof api.resolveConfig !== 'function') {\n          return null;\n        }\n        return api;\n      } catch {\n        return null;\n      }\n    };\n    const tryResolveFrom = async (req: NodeRequire): Promise<PrettierApi | null> => {\n      try {\n        const resolved = req.resolve('prettier');\n        return await tryImportPrettier(resolved);\n      } catch {\n        return null;\n      }\n    };\n\n    // 1) Resolve a partir do projeto-alvo (comportamento atual).\n    try {\n      const projectPkg = path.join(base, 'package.json');\n      if (fs.existsSync(projectPkg)) {\n        const api = await tryResolveFrom(createRequire(projectPkg));\n        if (api) return api;\n      }\n    } catch {\n      // ignora\n    }\n\n    // 2) Fallback: tenta resolver do contexto do Prometheus (útil em dev, monorepos, etc.).\n    {\n      const api = await tryResolveFrom(createRequire(import.meta.url));\n      if (api) return api;\n    }\n\n    // 3) Fallback: bundle local em feedback/prettier (quando existe no workspace).\n    // Mantém isso “best effort” para não mudar comportamento em instalações normais.\n    const feedbackDir = process.env.PROMETHEUS_PRETTIER_FEEDBACK_DIR || path.join(base, 'feedback', 'prettier');\n    const feedbackPkg = path.join(feedbackDir, 'package.json');\n    if (fs.existsSync(feedbackPkg)) {\n      const candidates = [path.join(feedbackDir, 'index.mjs'), path.join(feedbackDir, 'index.cjs')];\n      for (const p of candidates) {\n        if (!fs.existsSync(p)) continue;\n        const api = await tryImportPrettier(p);\n        if (api) return api;\n      }\n    }\n    return null;\n  })();\n  prettierCache.set(base, loader);\n  return loader;\n}\nfunction inferPrettierParser(relPath?: string, code?: string): string | null {\n  const info = getSyntaxInfoForPath(relPath ?? '');\n  if (!info) return null;\n  if (!info.formatavel) return null;\n  const rp = (relPath ?? '').toLowerCase();\n  if (rp.endsWith('.json')) {\n    const src = code ?? '';\n    const normalized = normalizarFimDeLinha(src);\n    const temComentarios = /(^|\\n)\\s*\\/\\//.test(normalized) || /(^|\\n)\\s*\\/\\*/.test(normalized);\n    return temComentarios ? 'jsonc' : 'json';\n  }\n  return info.parser ?? null;\n}\nexport async function formatarComPrettierProjeto(params: {\n  code: string;\n  relPath: string;\n  baseDir?: string;\n}): Promise<FormatadorMinimoResult> {\n  const baseDir = params.baseDir || process.cwd();\n  const relPath = params.relPath;\n  const absCaminho = path.resolve(baseDir, relPath);\n  const prettier = await carregarPrettierDoProjeto(baseDir);\n  if (!prettier) {\n    return {\n      ok: true,\n      parser: 'unknown',\n      formatted: params.code,\n      changed: false,\n      reason: 'prettier-nao-disponivel'\n    };\n  }\n  const parser = inferPrettierParser(relPath, params.code);\n  if (!parser) {\n    return {\n      ok: true,\n      parser: 'unknown',\n      formatted: params.code,\n      changed: false,\n      reason: 'prettier-parser-desconhecido'\n    };\n  }\n  try {\n    const resolvedConfiguracao = await prettier.resolveConfig(absCaminho, {\n      editorconfig: true\n    });\n\n    // Heurística: quando o projeto NÃO define `singleQuote`, inferimos a preferência\n    // a partir do conteúdo do arquivo para evitar que o formatador troque o estilo\n    // de aspas inesperadamente (ex.: converta ' para \" ou vice-versa).\n    const inferSingleQuoteFromCodigo = (src: string): boolean => {\n      try {\n        // Conta ocorrências de aspas simples e duplas fora de comentários/string parsing\n        // Heurística simples: conta totais brutos (suficiente para maioria dos casos).\n        const singles = (src.match(/'/g) || []).length;\n        const doubles = (src.match(/\"/g) || []).length;\n        return singles > doubles;\n      } catch {\n        return false;\n      }\n    };\n    const options: Record<string, unknown> = {\n      ...(resolvedConfiguracao || {}),\n      filepath: absCaminho,\n      parser\n    };\n\n    // Se o projeto não especificou explicitamente `singleQuote`, aplicar inferência\n    if (!resolvedConfiguracao || !Object.prototype.hasOwnProperty.call(resolvedConfiguracao, 'singleQuote')) {\n      if (parser === 'babel' || parser === 'typescript') {\n        options.singleQuote = inferSingleQuoteFromCodigo(params.code);\n      }\n    }\n    const out = await prettier.format(params.code, options);\n    const formatted = String(out);\n    return {\n      ok: true,\n      parser: 'code',\n      formatted,\n      changed: formatted !== params.code,\n      reason: 'prettier-projeto'\n    };\n  } catch (e) {\n    const msg = e instanceof Error ? e.message : String(e);\n    return {\n      ok: false,\n      parser: 'code',\n      error: msg\n    };\n  }\n}\n\n// Registrar formatadores padrão — facilita extensão futura e evita que o motor\n// Prettier seja invocado para arquivos que temos handlers dedicados.\nregisterFormatter('.json', (code, _relPath) => formatarJsonMinimo(code));\nregisterFormatter('.md', (code, _relPath) => formatarMarkdownMinimo(code));\nregisterFormatter('.markdown', (code, _relPath) => formatarMarkdownMinimo(code));\nregisterFormatter('.yml', (code, _relPath) => formatarYamlMinimo(code));\nregisterFormatter('.yaml', (code, _relPath) => formatarYamlMinimo(code));\nregisterFormatter('.xml', (code, _relPath) => formatarXmlMinimo(code));\nregisterFormatter('.html', (code, _relPath) => formatarCodeMinimo(code, {\n  normalizarSeparadoresDeSecao: false,\n  parser: 'html'\n}));\nregisterFormatter('.htm', (code, _relPath) => formatarCodeMinimo(code, {\n  normalizarSeparadoresDeSecao: false,\n  parser: 'html'\n}));\nregisterFormatter('.css', (code, _relPath) => formatarCodeMinimo(code, {\n  normalizarSeparadoresDeSecao: true,\n  parser: 'css'\n}));\nregisterFormatter('.py', (code, _relPath) => formatarCodeMinimo(code, {\n  normalizarSeparadoresDeSecao: false,\n  parser: 'python'\n}));\nregisterFormatter('.php', (code, _relPath) => formatarCodeMinimo(code, {\n  normalizarSeparadoresDeSecao: false,\n  parser: 'php'\n}));\nregisterFormatter('.svg', (code, _relPath) => formatarXmlMinimo(code));\nregisterFormatter('.java', (code, _relPath) => formatarCodeMinimo(code, {\n  normalizarSeparadoresDeSecao: true,\n  parser: 'code'\n}));\n\n// Antes de delegar ao Prettier no fluxo \"auto/prettier\", verificamos se existe\n// um formatador registrado. Essa função auxilia o comando `formatar`.\nexport function getRegisteredFormatter(relPath: string): FormatterFn | null {\n  return getFormatterForPath(relPath);\n}"]}