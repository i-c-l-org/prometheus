{"version":3,"file":"framework-detector.js","sourceRoot":"","sources":["../../../src/shared/helpers/framework-detector.ts"],"names":[],"mappings":"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","sourcesContent":["// SPDX-License-Identifier: MIT-0\n// @prometheus-disable PROBLEMA_PERFORMANCE\n// Justificativa: leitura única de package.json para detecção de frameworks\n\nimport fs from 'node:fs';\nimport path from 'node:path';\n\nimport type { FrameworkInfo } from '@';\n\nexport type { FrameworkInfo };\n\n/**\n * Detecta frameworks instalados no projeto via package.json\n */\nexport function detectarFrameworks(rootDir: string): FrameworkInfo[] {\n  const frameworks: FrameworkInfo[] = [];\n  try {\n    const packageJsonCaminho = path.join(rootDir, 'package.json');\n    if (!fs.existsSync(packageJsonCaminho)) {\n      return frameworks;\n    }\n    const packageJson = JSON.parse(fs.readFileSync(packageJsonCaminho, 'utf-8'));\n    const dependencies = packageJson.dependencies || {};\n    const devDependencies = packageJson.devDependencies || {};\n\n    // Lista de frameworks conhecidos com seus identificadores\n    const knownFrameworks = [{\n      pkg: 'discord.js',\n      name: 'Discord.js'\n    }, {\n      pkg: '@discordjs/rest',\n      name: 'Discord.js'\n    }, {\n      pkg: 'stripe',\n      name: 'Stripe'\n    }, {\n      pkg: '@stripe/stripe-js',\n      name: 'Stripe'\n    }, {\n      pkg: 'aws-sdk',\n      name: 'AWS SDK'\n    }, {\n      pkg: '@aws-sdk/client-s3',\n      name: 'AWS SDK'\n    }, {\n      pkg: 'express',\n      name: 'Express'\n    }, {\n      pkg: 'fastify',\n      name: 'Fastify'\n    }, {\n      pkg: 'next',\n      name: 'Next.js'\n    }, {\n      pkg: 'react',\n      name: 'React'\n    }, {\n      pkg: 'vue',\n      name: 'Vue'\n    }, {\n      pkg: '@angular/core',\n      name: 'Angular'\n    }];\n\n    // Verificar dependências\n    for (const {\n      pkg,\n      name\n    } of knownFrameworks) {\n      if (dependencies[pkg]) {\n        frameworks.push({\n          name,\n          version: dependencies[pkg],\n          isDev: false\n        });\n      } else if (devDependencies[pkg]) {\n        frameworks.push({\n          name,\n          version: devDependencies[pkg],\n          isDev: true\n        });\n      }\n    }\n\n    // Remover duplicatas (mesma framework em prod e dev)\n    const unique = frameworks.reduce((acc, curr) => {\n      if (!acc.find(f => f.name === curr.name)) {\n        acc.push(curr);\n      }\n      return acc;\n    }, [] as FrameworkInfo[]);\n    return unique;\n  } catch {\n    return frameworks;\n  }\n}\n\n/**\n * Verifica se um framework específico está instalado\n */\nexport function hasFramework(rootDir: string, frameworkName: string): boolean {\n  const frameworks = detectarFrameworks(rootDir);\n  return frameworks.some(f => f.name === frameworkName);\n}"]}