{"version":3,"file":"resultado.js","sourceRoot":"","sources":["../../../src/types/guardian/resultado.ts"],"names":[],"mappings":"AA0CA,MAAM,UAAU,gBAAgB,CAAC,KAAc;IAC7C,IAAI,KAAK,KAAK,IAAI,IAAI,KAAK,KAAK,SAAS,EAAE,CAAC;QAC1C,OAAO,IAAI,CAAC;IACd,CAAC;IAED,IAAI,OAAO,KAAK,KAAK,QAAQ,EAAE,CAAC;QAC9B,OAAO,KAAK,CAAC;IACf,CAAC;IAED,MAAM,GAAG,GAAG,KAAgC,CAAC;IAE7C,IAAI,CAAC,CAAC,QAAQ,IAAI,GAAG,CAAC,EAAE,CAAC;QACvB,OAAO,KAAK,CAAC;IACf,CAAC;IAED,MAAM,MAAM,GAAG,GAAG,CAAC,MAAM,CAAC;IAC1B,OAAO,CACL,MAAM,KAAK,IAAI,IAAI,MAAM,KAAK,uBAAuB,IAAI,MAAM,KAAK,MAAM,CAC3E,CAAC;AACJ,CAAC;AAKD,MAAM,UAAU,0BAA0B,CACxC,SAAmE;IAEnE,IAAI,CAAC,SAAS,EAAE,CAAC;QACf,OAAO,IAAI,CAAC;IACd,CAAC;IAGD,IAAI,gBAAgB,CAAC,SAAS,CAAC,EAAE,CAAC;QAChC,OAAO,SAAS,CAAC;IACnB,CAAC;IAGD,MAAM,MAAM,GAAG,SAAS,CAAC,MAAM,CAAC;IAEhC,IAAI,MAAM,KAAK,IAAI,IAAI,MAAM,KAAK,iBAAiB,EAAE,CAAC;QACpD,OAAO;YACL,MAAM,EAAE,IAAI;YACZ,QAAQ,EAAE;gBACR,IAAI,EAAE,EAAE;gBACR,SAAS,EAAE,IAAI,CAAC,GAAG,EAAE;gBACrB,KAAK,EAAE,EAAE;aACV;YACD,OAAO,EAAE,SAAS,CAAC,QAAQ,EAAE,IAAI,CAAC,IAAI,CAAC;SACxC,CAAC;IACJ,CAAC;IAED,IAAI,MAAM,KAAK,uBAAuB,EAAE,CAAC;QACvC,OAAO;YACL,MAAM,EAAE,uBAAuB;YAC/B,QAAQ,EAAE;gBACR,IAAI,EAAE,EAAE;gBACR,SAAS,EAAE,IAAI,CAAC,GAAG,EAAE;gBACrB,KAAK,EAAE,EAAE;aACV;YACD,UAAU,EAAE,CAAC,SAAS,CAAC,QAAQ,IAAI,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,CAAC;gBACnD,IAAI,EAAE,WAAW;gBACjB,QAAQ,EAAE,GAAG;aACd,CAAC,CAAC;YACH,OAAO,EAAE,SAAS,CAAC,QAAQ,EAAE,IAAI,CAAC,IAAI,CAAC,IAAI,uBAAuB;SACnE,CAAC;IACJ,CAAC;IAGD,OAAO,IAAI,CAAC;AACd,CAAC","sourcesContent":["// SPDX-License-Identifier: MIT\n/**\n * Tipos para resultados do Guardian\n */\n\nexport interface GuardianBaseline {\n  hash: string;\n  timestamp: number;\n  files: Record<string, string>;\n}\n\nexport interface GuardianViolation {\n  tipo: string;\n  mensagem: string;\n  arquivo?: string;\n  esperado?: string;\n  encontrado?: string;\n}\n\nexport type GuardianResult =\n  | {\n      status: 'ok';\n      baseline: GuardianBaseline;\n      message?: string;\n    }\n  | {\n      status: 'alteracoes-detectadas';\n      baseline: GuardianBaseline;\n      violations: GuardianViolation[];\n      message: string;\n    }\n  | {\n      status: 'erro';\n      error: string;\n      details?: unknown;\n    }\n  | null\n  | undefined;\n\n/**\n * Type guard para verificar se é resultado válido do Guardian\n */\nexport function isGuardianResult(value: unknown): value is GuardianResult {\n  if (value === null || value === undefined) {\n    return true;\n  }\n\n  if (typeof value !== 'object') {\n    return false;\n  }\n\n  const obj = value as Record<string, unknown>;\n\n  if (!('status' in obj)) {\n    return false;\n  }\n\n  const status = obj.status;\n  return (\n    status === 'ok' || status === 'alteracoes-detectadas' || status === 'erro'\n  );\n}\n\n/**\n * Converte ResultadoGuardian (tipo legado) para GuardianResult\n */\nexport function converterResultadoGuardian(\n  resultado: import('./integridade.js').ResultadoGuardian | undefined,\n): GuardianResult {\n  if (!resultado) {\n    return null;\n  }\n\n  // Se já for GuardianResult, retorna como está\n  if (isGuardianResult(resultado)) {\n    return resultado;\n  }\n\n  // Converter de ResultadoGuardian para GuardianResult\n  const status = resultado.status;\n\n  if (status === 'ok' || status === 'baseline-aceito') {\n    return {\n      status: 'ok',\n      baseline: {\n        hash: '',\n        timestamp: Date.now(),\n        files: {},\n      },\n      message: resultado.detalhes?.join('; '),\n    };\n  }\n\n  if (status === 'alteracoes-detectadas') {\n    return {\n      status: 'alteracoes-detectadas',\n      baseline: {\n        hash: '',\n        timestamp: Date.now(),\n        files: {},\n      },\n      violations: (resultado.detalhes || []).map((msg) => ({\n        tipo: 'alteracao',\n        mensagem: msg,\n      })),\n      message: resultado.detalhes?.join('; ') || 'Alterações detectadas',\n    };\n  }\n\n  // Outros casos\n  return null;\n}\n"]}