{"version":3,"file":"validacao.js","sourceRoot":"","sources":["../../../src/types/shared/validacao.ts"],"names":[],"mappings":"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","sourcesContent":["// SPDX-License-Identifier: MIT\n\n/**\n * Sistema próprio de validação e tipos para dados externos\n * Substitui unknown/any com tipos TypeScript específicos + validação manual\n *\n * FILOSOFIA: Tolerância zero ao código frágil, sem compromissos com dependências externas\n */\n\n/**\n * Tipo padronizado para errors em toda a aplicação\n * Use este tipo em catch blocks e error handling\n */\nexport type ErrorLike = Error | ErroComMensagem | { message: string };\n\n/**\n * Helper para extrair mensagem de erro de forma segura\n */\nexport function extrairMensagemErro(error: unknown): string {\n  if (error instanceof Error) {\n    return error.message;\n  }\n  if (isErroComMensagem(error)) {\n    if (typeof error.message === 'string') {\n      return error.message;\n    }\n    if (error.message instanceof Error) {\n      return error.message.message;\n    }\n  }\n  if (typeof error === 'string') {\n    return error;\n  }\n  if (error && typeof error === 'object' && 'message' in error) {\n    const msg = (error as { message: string | Error }).message;\n    if (typeof msg === 'string') return msg;\n  }\n  return 'Erro desconhecido';\n}\n\n/**\n * Objetos de erro genéricos\n */\nexport interface ErroComMensagem {\n  message: string | Error;\n  name?: string;\n  stack?: string;\n  code?: string | number;\n  cause?: Error;\n}\n\n/**\n * API DisplayNames do Intl\n */\nexport interface DisplayNamesAPI {\n  of: (input: string) => string | undefined;\n}\n\n/**\n * Constructor de DisplayNames\n */\nexport interface DisplayNamesConstructor {\n  new (locales: string[], options: { type: string }): DisplayNamesAPI;\n}\n\n/**\n * Intl com DisplayNames tipado\n */\nexport interface IntlComDisplayNames {\n  DisplayNames?: DisplayNamesConstructor;\n  DateTimeFormat?: typeof Intl.DateTimeFormat;\n  NumberFormat?: typeof Intl.NumberFormat;\n  Collator?: typeof Intl.Collator;\n}\n\n/**\n * Função de import dinâmico\n */\nexport type ImportDinamico = (path: string) => Promise<unknown>;\n\n/**\n * Contexto global com import dinâmico\n */\nexport interface GlobalComImport {\n  import?: ImportDinamico;\n  require?: NodeRequire;\n  process?: NodeJS.Process;\n}\n\n/**\n * Mock function do Vitest\n */\nexport type VitestMockFn<T = unknown> = {\n  (...args: unknown[]): T;\n  mockReturnValue: (value: T) => VitestMockFn<T>;\n  mockResolvedValue: (value: T) => VitestMockFn<T>;\n  mockImplementation: (fn: (...args: unknown[]) => T) => VitestMockFn<T>;\n};\n\n/**\n * Contexto global Vitest\n */\nexport interface GlobalComVitest {\n  vi?: {\n    fn?: <T = unknown>(\n      implementation?: (...args: unknown[]) => T,\n    ) => VitestMockFn<T>;\n    mock?: (path: string, factory?: () => unknown) => void;\n    spyOn?: <T extends object, K extends keyof T>(\n      object: T,\n      method: K,\n    ) => VitestMockFn<T[K]>;\n    clearAllMocks?: () => void;\n    resetAllMocks?: () => void;\n    restoreAllMocks?: () => void;\n  };\n  describe?: (name: string, fn: () => void) => void;\n  it?: (name: string, fn: () => void | Promise<void>) => void;\n  test?: (name: string, fn: () => void | Promise<void>) => void;\n  expect?: unknown;\n}\n\n/**\n * Pendência processável (estende Pendencia base)\n */\nexport interface PendenciaProcessavel {\n  arquivo: string;\n  motivo: string;\n  detectedAt: number;\n  scheduleAt: number;\n  diasInativo?: number;\n  categoria?: 'critico' | 'importante' | 'baixa-prioridade' | 'informativo';\n  prioridade?: 'alta' | 'media' | 'baixa';\n  status?: 'pendente' | 'processando' | 'concluido' | 'erro' | 'cancelado';\n  tentativas?: number;\n  ultimoErro?: string;\n}\n\n/**\n * Configuração com plugins\n */\nexport interface ConfigPlugin {\n  STRUCTURE_PLUGINS?: Array<{\n    nome: string;\n    habilitado?: boolean;\n    config?: Record<string, unknown>;\n  }>;\n  pluginsPaths?: string[];\n  autoload?: boolean;\n}\n\n/**\n * Item de movimentação de plano\n */\nexport interface PlanoMoverItem {\n  de: string;\n  para: string;\n  motivo?: string;\n}\n\n/**\n * Plano de sugestão estrutural\n */\nexport interface PlanoSugestaoEstrutura {\n  mover: PlanoMoverItem[];\n  conflitos?: Array<{ alvo: string; motivo: string }>;\n  resumo?: {\n    total: number;\n    zonaVerde: number;\n    bloqueados: number;\n  };\n}\n\n/**\n * Snapshot de análise (para mapa de reversão)\n */\nexport interface SnapshotAnalise {\n  timestamp: string;\n  arquivos: string[];\n  metricas: {\n    totalArquivos?: number;\n    totalLinhas?: number;\n    complexidade?: number;\n    [key: string]: unknown;\n  };\n  configuracao: {\n    versao?: string;\n    ambiente?: string;\n    [key: string]: unknown;\n  };\n}\n\n/**\n * Entrada de mapa de reversão\n */\nexport interface EntradaMapaReversao {\n  arquivo: string;\n  operacao: 'adicionar' | 'remover' | 'modificar';\n  timestamp: string;\n  snapshot?: SnapshotAnalise;\n  conteudoAnterior?: string;\n  conteudoPosterior?: string;\n  hash?: string;\n}\n\n/**\n * Contexto de relatório\n */\nexport interface ContextoRelatorio {\n  total: number;\n  processados: number;\n  erros: number;\n  tempo?: number;\n  avisos?: number;\n  sucessos?: number;\n  fase?: string;\n  detalhes?: string;\n}\n\n/**\n * Erro de validação de combinação de flags\n * Originalmente em: src/shared/validation/validacao.ts\n */\nexport interface ErroValidacaoCombinacao {\n  codigo: string;\n  mensagem: string;\n}\n\n/**\n * Função helper para validação segura com fallback (sem dependências externas)\n */\nexport function validarSeguro<T>(\n  validador: (dados: unknown) => dados is T,\n  dados: unknown,\n  fallback: T,\n  contexto?: string,\n): T {\n  if (validador(dados)) {\n    return dados;\n  }\n\n  // Em modo DEV, logga o problema de validação\n  if (process.env.NODE_ENV === 'development' || process.env.VITEST) {\n    console.warn(\n      `[Validação] Falhou${contexto ? ` em ${contexto}` : ''}, usando fallback`,\n    );\n  }\n\n  return fallback;\n}\n\n/**\n * Type guards para verificação runtime - Nossa implementação própria\n */\nexport function isErroComMensagem(obj: unknown): obj is ErroComMensagem {\n  return typeof obj === 'object' && obj !== null && 'message' in obj;\n}\n\nexport function isGlobalComVitest(obj: unknown): obj is GlobalComVitest {\n  return typeof obj === 'object' && obj !== null && 'vi' in obj;\n}\n\nexport function isPendenciaProcessavel(\n  obj: unknown,\n): obj is PendenciaProcessavel {\n  return (\n    typeof obj === 'object' &&\n    obj !== null &&\n    'arquivo' in obj &&\n    'motivo' in obj &&\n    typeof (obj as PendenciaProcessavel).arquivo === 'string' &&\n    typeof (obj as PendenciaProcessavel).motivo === 'string'\n  );\n}\n\nexport function isIntlComDisplayNames(\n  obj: unknown,\n): obj is IntlComDisplayNames {\n  return (\n    typeof obj === 'object' &&\n    obj !== null &&\n    ('DisplayNames' in obj || Object.keys(obj).length >= 0)\n  );\n}\n\nexport function isGlobalComImport(obj: unknown): obj is GlobalComImport {\n  return (\n    typeof obj === 'object' &&\n    obj !== null &&\n    ('import' in obj || Object.keys(obj).length >= 0)\n  );\n}\n\nexport function isConfigPlugin(obj: unknown): obj is ConfigPlugin {\n  return typeof obj === 'object' && obj !== null;\n}\n\nexport function isPlanoSugestaoEstrutura(\n  obj: unknown,\n): obj is PlanoSugestaoEstrutura {\n  return (\n    typeof obj === 'object' &&\n    obj !== null &&\n    'mover' in obj &&\n    Array.isArray((obj as PlanoSugestaoEstrutura).mover)\n  );\n}\n\nexport function isSnapshotAnalise(obj: unknown): obj is SnapshotAnalise {\n  return (\n    typeof obj === 'object' &&\n    obj !== null &&\n    'timestamp' in obj &&\n    'arquivos' in obj &&\n    Array.isArray((obj as SnapshotAnalise).arquivos)\n  );\n}\n\nexport function isEntradaMapaReversao(\n  obj: unknown,\n): obj is EntradaMapaReversao {\n  return (\n    typeof obj === 'object' &&\n    obj !== null &&\n    'arquivo' in obj &&\n    'operacao' in obj &&\n    typeof (obj as EntradaMapaReversao).arquivo === 'string' &&\n    ['adicionar', 'remover', 'modificar'].includes(\n      (obj as EntradaMapaReversao).operacao,\n    )\n  );\n}\n\n/**\n * Helpers para conversão segura (nossa alternativa ao casting frágil)\n */\nexport function converterSeguro<T>(\n  obj: unknown,\n  validador: (dados: unknown) => dados is T,\n  fallback: T,\n): T {\n  return validador(obj) ? obj : fallback;\n}\n\n/**\n * Helper para validação de string não vazia\n */\nexport function isStringNaoVazia(valor: unknown): valor is string {\n  return typeof valor === 'string' && valor.trim().length > 0;\n}\n\n/**\n * Helper para validação de número válido\n */\nexport function isNumeroValido(valor: unknown): valor is number {\n  return typeof valor === 'number' && !isNaN(valor) && isFinite(valor);\n}\n\n/**\n * Helper para validação de array não vazio\n */\nexport function isArrayNaoVazio<T>(valor: unknown): valor is T[] {\n  return Array.isArray(valor) && valor.length > 0;\n}\n"]}