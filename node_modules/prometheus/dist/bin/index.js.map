{"version":3,"file":"index.js","sourceRoot":"","sources":["../../src/bin/index.ts"],"names":[],"mappings":"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","sourcesContent":["#!/usr/bin/env node\n// SPDX-License-Identifier: MIT\n// Bootstrap do binário: registra o loader ESM programaticamente e importa ./cli.js\nimport path from 'node:path';\nimport { fileURLToPath, pathToFileURL } from 'node:url';\n\nimport type { ErrorLike } from '@';\nimport { extrairMensagemErro } from '@';\n\n// Resolve o diretório raiz do dist usando import.meta.url para funcionar em instalações globais\nconst __filename = fileURLToPath(import.meta.url);\nconst __dirname = path.dirname(__filename);\nconst distRaiz = path.resolve(__dirname, '..');\n// Observação: usar o loader original 'node.loader.mjs' (com ponto) para compatibilidade dos testes e runtime\nconst loaderCaminho = path.resolve(distRaiz, 'node.loader.mjs');\nconst loaderUrl = pathToFileURL(loaderCaminho).toString();\nconst entryCaminho = path.resolve(distRaiz, 'bin', 'cli.js');\nconst entryUrl = pathToFileURL(entryCaminho).toString();\n\n// Registra o loader sem usar --experimental-loader (evita ExperimentalWarning)\n(async () => {\n  try {\n    const {\n      register\n    } = await import('node:module');\n    register(loaderUrl, pathToFileURL('./'));\n    // Importa o módulo CLI e, quando presente, invoca explicitamente a função mainCli\n    type CliModule = {\n      mainCli?: () => unknown;\n    };\n    const cliMod = (await import(entryUrl)) as unknown;\n    const maybeCli = cliMod as CliModule;\n    if (maybeCli && typeof maybeCli.mainCli === 'function') {\n      await maybeCli.mainCli();\n    }\n  } catch (err: unknown) {\n    // Commander lança códigos especiais quando --version ou --help são usados —\n    // tratá-los como sucesso silencioso (exit 0) em vez de logar como erro.\n    const code = err && typeof err === 'object' && 'code' in err ? (err as {\n      code?: unknown;\n    }).code : undefined;\n    const message = err && typeof err === 'object' && 'message' in err ? (err as {\n      message?: unknown;\n    }).message : typeof err === 'string' ? err : undefined;\n    if (code === 'commander.version' || code === 'commander.help' || code === 'commander.helpDisplayed' || message === 'outputHelp' || message === '(outputHelp)') {\n      process.exit(0);\n    }\n    const msg = typeof message === 'string' ? message : extrairMensagemErro(err);\n    console.error('Erro ao inicializar o prometheus:', msg);\n    if (err && typeof err === 'object' && 'stack' in err) {\n      console.error((err as {\n        stack?: string;\n      }).stack);\n    }\n    process.exit(1);\n  }\n})().catch((err: ErrorLike) => {\n  const code = err && typeof err === 'object' && 'code' in err ? (err as {\n    code?: unknown;\n  }).code : undefined;\n  const message = err && typeof err === 'object' && 'message' in err ? (err as {\n    message?: unknown;\n  }).message : typeof err === 'string' ? err : undefined;\n  if (code === 'commander.version' || code === 'commander.help' || code === 'commander.helpDisplayed' || message === 'outputHelp' || message === '(outputHelp)') {\n    process.exit(0);\n  }\n  const msg = typeof message === 'string' ? message : extrairMensagemErro(err);\n  console.error('Erro ao inicializar o prometheus:', msg);\n  if (err && typeof err === 'object' && 'stack' in err) {\n    console.error((err as {\n      stack?: string;\n    }).stack);\n  }\n  process.exit(1);\n});"]}