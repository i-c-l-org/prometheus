{"version":3,"file":"detector-documentacao.js","sourceRoot":"","sources":["../../../src/analistas/plugins/detector-documentacao.ts"],"names":[],"mappings":"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","sourcesContent":["// SPDX-License-Identifier: MIT\nimport type { NodePath } from '@babel/traverse';\nimport type { Node } from '@babel/types';\nimport { DetectorAgregadosMensagens } from '@core/messages/analistas/detector-agregados-messages.js';\nimport { detectarContextoProjeto } from '@shared/contexto-projeto.js';\nimport { filtrarOcorrenciasSuprimidas } from '@shared/helpers/suppressao.js';\n\nimport type { Analista, Ocorrencia, ProblemaDocumentacao } from '@';\nimport { criarOcorrencia } from '@';\n\nexport const analistaDocumentacao: Analista = {\n  nome: 'documentacao',\n  categoria: 'manutenibilidade',\n  descricao: 'Detecta problemas de documenta√ß√£o e legibilidade do c√≥digo',\n  test: (relPath: string): boolean => {\n    return /\\.(js|jsx|ts|tsx|mjs|cjs)$/.test(relPath);\n  },\n  aplicar: (src: string, relPath: string, ast: NodePath<Node> | null): Ocorrencia[] => {\n    if (!src) return [];\n    const contextoArquivo = detectarContextoProjeto({\n      arquivo: relPath,\n      conteudo: src,\n      relPath\n    });\n    const problemas: ProblemaDocumentacao[] = [];\n    try {\n      // Detectar problemas por padr√µes de texto\n      detectarPadroesDocumentacao(src, problemas, relPath);\n\n      // Detectar problemas via AST quando dispon√≠vel\n      if (ast) {\n        detectarProblemasDocumentacaoAST(ast, problemas);\n      }\n\n      // Converter para ocorr√™ncias\n      const ocorrencias: Ocorrencia[] = [];\n\n      // Agrupar por prioridade\n      const porPrioridade = agruparPorPrioridade(problemas);\n      for (const [prioridade, items] of Object.entries(porPrioridade)) {\n        if (items.length > 0) {\n          const nivel = mapearPrioridadeParaNivel(prioridade as ProblemaDocumentacao['prioridade']);\n\n          // Ser mais relaxado com testes e arquivos de configura√ß√£o\n          const nivelAjustado = (contextoArquivo.isTest || contextoArquivo.isConfiguracao) && nivel === 'aviso' ? 'info' : nivel;\n          const resumo = items.slice(0, 3).map(p => p.tipo).join(', ');\n          ocorrencias.push(criarOcorrencia({\n            tipo: 'problema-documentacao',\n            nivel: nivelAjustado,\n            mensagem: DetectorAgregadosMensagens.problemasDocumentacaoResumo(prioridade, resumo, items.length),\n            relPath,\n            linha: items[0].linha\n          }));\n        }\n      }\n\n      // Aplicar supress√µes inline antes de retornar\n      return filtrarOcorrenciasSuprimidas(ocorrencias, 'documentacao', src);\n    } catch (erro) {\n      return [criarOcorrencia({\n        tipo: 'ERRO_ANALISE',\n        nivel: 'aviso',\n        mensagem: DetectorAgregadosMensagens.erroAnalisarDocumentacao(erro),\n        relPath,\n        linha: 1\n      })];\n    }\n  }\n};\nfunction detectarPadroesDocumentacao(src: string, problemas: ProblemaDocumentacao[], relPath: string): void {\n  const linhas = src.split('\\n');\n\n  // üéØ FILOSOFIA: Documenta√ß√£o √© importante mas n√£o deve poluir\n  // - Detectar apenas problemas reais, n√£o aus√™ncia de JSDoc em c√≥digo interno\n  // - Priorizar qualidade do c√≥digo sobre quantidade de coment√°rios\n  // - Arquivos de biblioteca p√∫blica precisam mais documenta√ß√£o que utils internos\n\n  // Verificar se √© arquivo de biblioteca p√∫blica (requer documenta√ß√£o rigorosa)\n  const isLibraryArquivo = relPath.includes('src/shared/') || relPath.includes('src/core/') || relPath.includes('lib/');\n\n  // Arquivos que n√£o precisam JSDoc rigoroso\n  const isInternalArquivo = relPath.includes('/cli/') || relPath.includes('/test') || relPath.includes('/spec') || relPath.includes('/__tests__/') || relPath.includes('/fixtures/') || relPath.includes('/mocks/') || relPath.includes('config.') || relPath.includes('setup.');\n  let temExportacaoPublica = false;\n  let temJSDoc = false;\n  let dentroDeJSDoc = false;\n  linhas.forEach((linha, index) => {\n    const numeroLinha = index + 1;\n\n    // Rastrear contexto JSDoc\n    if (/\\/\\*\\*/.test(linha)) {\n      temJSDoc = true;\n      dentroDeJSDoc = true;\n    }\n\n    // Pular an√°lise de problemas se estiver dentro de JSDoc ou linha come√ßa com * (JSDoc)\n    const linhaJSDoc = dentroDeJSDoc || /^\\s*\\*/.test(linha);\n    if (linhaJSDoc) {\n      // Verificar fechamento depois de pular an√°lise\n      if (/\\*\\//.test(linha)) {\n        dentroDeJSDoc = false;\n      }\n      return; // N√£o analisar c√≥digo dentro de coment√°rios JSDoc\n    }\n\n    // Detectar exporta√ß√µes\n    if (/^export\\s+(function|class|const|let|var|default)/.test(linha.trim())) {\n      temExportacaoPublica = true;\n    }\n\n    // Vari√°veis com nomes de uma letra (exceto loops, cast types, e contextos leg√≠timos)\n    const singleLetterMatch = /\\b(const|let|var)\\s+([a-z])\\s*=/.exec(linha);\n    if (singleLetterMatch && !/for\\s*\\(/.test(linha) && !/while\\s*\\(/.test(linha)) {\n      const varNome = singleLetterMatch[2];\n      // Excluir vari√°veis leg√≠timas: i, j, k em contexto de itera√ß√£o, tipos (x as Type)\n      const isLoopContext = /\\b(i|j|k)\\s*=\\s*\\d+/.test(linha) || /\\b(i|j|k)\\s*[+\\-]=/.test(linha);\n      const isTipoCast = /as\\s+\\w+/.test(linha) || /:\\s*\\w+\\s*=/.test(linha);\n      if (!isLoopContext && !isTipoCast) {\n        problemas.push({\n          tipo: 'poor-naming',\n          descricao: `Vari√°vel '${varNome}' com nome de uma letra dificulta compreens√£o`,\n          prioridade: 'media',\n          linha: numeroLinha,\n          coluna: linha.indexOf(singleLetterMatch[0]) + 1,\n          contexto: linha.trim(),\n          sugestao: 'Use nomes descritivos para vari√°veis'\n        });\n      }\n    }\n\n    // N√∫meros m√°gicos (n√£o em arrays ou compara√ß√µes simples)\n    const numMagico = /\\b(\\d{2,})\\b/.exec(linha);\n    if (numMagico && !/(length|size|count)\\s*[=><!]/.test(linha) && !/\\[\\s*\\d+\\s*\\]/.test(linha) && parseInt(numMagico[1]) > 10) {\n      problemas.push({\n        tipo: 'magic-constants',\n        descricao: `N√∫mero m√°gico ${numMagico[1]} sem explica√ß√£o`,\n        prioridade: 'baixa',\n        linha: numeroLinha,\n        coluna: linha.indexOf(numMagico[0]) + 1,\n        contexto: linha.trim(),\n        sugestao: 'Extraia para constante nomeada com coment√°rio'\n      });\n    }\n\n    // Coment√°rios TODO antigos (aproxima√ß√£o heur√≠stica)\n    if (/TODO.*\\d{4}/.test(linha)) {\n      const ano = /TODO.*(\\d{4})/.exec(linha)?.[1];\n      const anoAtual = new Date().getFullYear();\n      if (ano && anoAtual - parseInt(ano) > 1) {\n        problemas.push({\n          tipo: 'outdated-comments',\n          descricao: `TODO de ${ano} pode estar desatualizado`,\n          prioridade: 'baixa',\n          linha: numeroLinha,\n          coluna: linha.indexOf('TODO') + 1,\n          contexto: linha.trim(),\n          sugestao: 'Revisar e atualizar ou implementar TODO antigo'\n        });\n      }\n    }\n\n    // TypeScript: tipos 'any' sem coment√°rio explicativo (exceto em strings literais)\n    if (/:\\s*any\\b/.test(linha) && !/\\/\\/|\\/\\*/.test(linha)) {\n      // Verificar se n√£o est√° dentro de string (ex: const code = 'x: any')\n      const anyMatch = /:\\s*any\\b/.exec(linha);\n      if (anyMatch) {\n        const position = anyMatch.index;\n        const before = linha.substring(0, position);\n        // Contar aspas antes da posi√ß√£o\n        const singleQuotes = (before.match(/'/g) || []).length;\n        const doubleQuotes = (before.match(/\"/g) || []).length;\n        const backticks = (before.match(/`/g) || []).length;\n\n        // Se n√∫mero √≠mpar de aspas, est√° dentro de string\n        const dentroDeString = singleQuotes % 2 !== 0 || doubleQuotes % 2 !== 0 || backticks % 2 !== 0;\n        if (!dentroDeString) {\n          problemas.push({\n            tipo: 'missing-types',\n            descricao: 'Tipo any sem justificativa via coment√°rio',\n            prioridade: 'media',\n            linha: numeroLinha,\n            coluna: position + 1,\n            contexto: linha.trim(),\n            sugestao: 'Adicione coment√°rio explicando uso de any ou use tipo mais espec√≠fico'\n          });\n        }\n      }\n    }\n  });\n\n  // üìö DETEC√á√ÉO INTELIGENTE DE FALTA DE DOCUMENTA√á√ÉO\n  // Apenas reportar se:\n  // 1. √â arquivo de biblioteca p√∫blica (shared/, core/, lib/) E\n  // 2. Tem exporta√ß√µes p√∫blicas E\n  // 3. N√£o tem nenhum JSDoc E\n  // 4. N√£o √© arquivo de teste/config/setup\n  if (isLibraryArquivo && temExportacaoPublica && !temJSDoc && !isInternalArquivo && src.length > 200) {\n    // Arquivo grande o suficiente para justificar documenta√ß√£o\n    problemas.push({\n      tipo: 'missing-jsdoc',\n      descricao: 'Arquivo de biblioteca p√∫blica sem documenta√ß√£o',\n      prioridade: 'media',\n      // Reduzido de 'alta' para 'media'\n      linha: 1,\n      coluna: 1,\n      contexto: 'Arquivo de biblioteca',\n      sugestao: 'Considere adicionar JSDoc para APIs p√∫blicas (fun√ß√µes/classes exportadas principais)'\n    });\n  }\n}\nfunction detectarProblemasDocumentacaoAST(ast: NodePath<Node>, problemas: ProblemaDocumentacao[]): void {\n  try {\n    ast.traverse({\n      // üéØ FILOSOFIA: Detectar apenas exports DEFAULT sem JSDoc\n      // Exports nomeados podem ser auto-explicativos pelo nome\n      ExportDefaultDeclaration(path) {\n        if ((path.node.declaration.type === 'FunctionDeclaration' || path.node.declaration.type === 'ClassDeclaration') && !path.node.leadingComments?.some(c => c.value.startsWith('*'))) {\n          problemas.push({\n            tipo: 'missing-jsdoc',\n            descricao: 'Export default (principal) sem JSDoc',\n            prioridade: 'media',\n            // Reduzido de 'alta'\n            linha: path.node.loc?.start.line || 0,\n            coluna: path.node.loc?.start.column || 0,\n            contexto: 'Export default',\n            sugestao: 'Documente a API principal do m√≥dulo para facilitar uso'\n          });\n        }\n      },\n      // Classes p√∫blicas complexas (>3 m√©todos) sem documenta√ß√£o\n      ClassDeclaration(path) {\n        const node = path.node;\n        if (node.body.body.length > 3 &&\n        // Apenas classes n√£o-triviais\n        !node.leadingComments?.some(c => c.value.startsWith('*')) && node.id?.name && !node.id.name.toLowerCase().includes('test') && !node.id.name.toLowerCase().includes('mock')) {\n          // Verificar se √© exportada\n          const parent = path.parent;\n          const isExported = parent.type === 'ExportNamedDeclaration' || parent.type === 'ExportDefaultDeclaration';\n          if (isExported) {\n            problemas.push({\n              tipo: 'missing-jsdoc',\n              descricao: `Classe p√∫blica ${node.id.name} (${node.body.body.length} membros) sem documenta√ß√£o`,\n              prioridade: 'media',\n              linha: node.loc?.start.line || 0,\n              coluna: node.loc?.start.column || 0,\n              contexto: 'ClassDeclaration',\n              sugestao: 'Documente o prop√≥sito e principais responsabilidades da classe'\n            });\n          }\n        }\n      }\n\n      // üö´ REMOVIDO: Detec√ß√£o de fun√ß√µes com muitos par√¢metros\n      // Motivo: Gera muito ru√≠do em c√≥digo interno/utils\n      // Alternativa: Revisar code review manual ou usar linter espec√≠fico\n    });\n  } catch {\n    // Ignorar erros de traverse\n  }\n}\nfunction agruparPorPrioridade(problemas: ProblemaDocumentacao[]): Record<string, ProblemaDocumentacao[]> {\n  return problemas.reduce((acc, problema) => {\n    const prioridade = problema.prioridade;\n    if (prioridade) {\n      if (!acc[prioridade]) {\n        acc[prioridade] = [];\n      }\n      acc[prioridade].push(problema);\n    }\n    return acc;\n  }, {} as Record<string, ProblemaDocumentacao[]>);\n}\nfunction mapearPrioridadeParaNivel(prioridade: ProblemaDocumentacao['prioridade']): 'info' | 'aviso' | 'erro' {\n  switch (prioridade) {\n    case 'alta':\n      return 'aviso';\n    // Documenta√ß√£o raramente √© erro cr√≠tico\n    case 'media':\n      return 'aviso';\n    case 'baixa':\n    default:\n      return 'info';\n  }\n}"]}