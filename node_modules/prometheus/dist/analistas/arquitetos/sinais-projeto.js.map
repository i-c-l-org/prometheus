{"version":3,"file":"sinais-projeto.js","sourceRoot":"","sources":["../../../src/analistas/arquitetos/sinais-projeto.ts"],"names":[],"mappings":"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","sourcesContent":["// SPDX-License-Identifier: MIT-0\n// import path from 'node:path'; // Removido: não utilizado\nimport type { ClassDeclaration, ImportDeclaration, Program, Statement, TSEnumDeclaration, TSInterfaceDeclaration, TSTypeAliasDeclaration, VariableDeclaration } from '@babel/types';\n\nimport type { FileEntryWithAst, PackageJson, SinaisProjetoAvancados } from '@';\n\nexport function extrairSinaisAvancados(fileEntries: FileEntryWithAst[], packageJson?: PackageJson): SinaisProjetoAvancados {\n  // Auxiliar para checar se o nó possui id.name string\n  const hasIdNome = (node: unknown): node is {\n    id: {\n      name: string;\n    };\n  } => {\n    return typeof node === 'object' && node !== null && 'id' in node && typeof (node as {\n      id?: {\n        name?: unknown;\n      };\n    }).id?.name === 'string';\n  };\n  const sinais: SinaisProjetoAvancados = {\n    funcoes: 0,\n    imports: [],\n    variaveis: 0,\n    tipos: [],\n    classes: 0,\n    frameworksDetectados: [],\n    dependencias: [],\n    scripts: [],\n    pastasPadrao: [],\n    arquivosPadrao: [],\n    arquivosConfiguracao: [],\n    padroesArquiteturais: [],\n    tecnologiasDominantes: [],\n    complexidadeEstrutura: 'baixa',\n    tipoDominante: 'desconhecido'\n  };\n  for (const fe of fileEntries) {\n    let body: Statement[] = [];\n    if (fe.ast && 'node' in fe.ast && fe.ast.node && (fe.ast.node as Program).type === 'Program' && Array.isArray((fe.ast.node as Program).body)) {\n      body = (fe.ast.node as Program).body;\n    }\n    // Funções\n    sinais.funcoes += body.filter((n): n is import('@babel/types').FunctionDeclaration => n.type === 'FunctionDeclaration').length;\n    // Imports\n    const imports = body.filter((n): n is ImportDeclaration => n.type === 'ImportDeclaration');\n    sinais.imports.push(...imports.map(i => i.source.value));\n    // Variáveis\n    sinais.variaveis += body.filter((n): n is VariableDeclaration => n.type === 'VariableDeclaration').length;\n    // Tipos (TypeScript)\n    sinais.tipos.push(...body.filter((n): n is TSTypeAliasDeclaration | TSInterfaceDeclaration | TSEnumDeclaration => ['TSTypeAliasDeclaration', 'TSInterfaceDeclaration', 'TSEnumDeclaration'].includes(n.type)).map(n => hasIdNome(n) ? n.id.name : undefined).filter((v): v is string => typeof v === 'string'));\n    // Classes\n    sinais.classes += body.filter((n): n is ClassDeclaration => n.type === 'ClassDeclaration').length;\n    // Frameworks por import\n    for (const i of imports) {\n      if (typeof i.source.value === 'string') {\n        if (/express|react|next|electron|discord\\.js|telegraf/.test(i.source.value)) {\n          sinais.frameworksDetectados.push(i.source.value);\n        }\n      }\n    }\n    // Padrões de pastas/arquivos\n    const rel = fe.relPath.replace(/\\\\/g, '/');\n    if (/src\\/controllers|pages|api|prisma|packages|apps/.test(rel)) {\n      sinais.pastasPadrao.push(rel);\n    }\n    if (/main\\.js|index\\.ts|bot\\.ts|electron\\.js/.test(rel)) {\n      sinais.arquivosPadrao.push(rel);\n    }\n    if (/tsconfig\\.json|turbo\\.json|pnpm-workspace\\.yaml/.test(rel)) {\n      sinais.arquivosConfiguracao.push(rel);\n    }\n  }\n  // Dependências e scripts do package.json\n  if (packageJson) {\n    sinais.dependencias.push(...Object.keys(packageJson.dependencies || {}));\n    sinais.scripts.push(...Object.keys(packageJson.scripts || {}));\n  }\n  // Normaliza arrays\n  sinais.imports = Array.from(new Set(sinais.imports));\n  sinais.frameworksDetectados = Array.from(new Set(sinais.frameworksDetectados));\n  sinais.pastasPadrao = Array.from(new Set(sinais.pastasPadrao));\n  sinais.arquivosPadrao = Array.from(new Set(sinais.arquivosPadrao));\n  sinais.arquivosConfiguracao = Array.from(new Set(sinais.arquivosConfiguracao));\n  sinais.tipos = Array.from(new Set(sinais.tipos));\n  return sinais;\n}"]}