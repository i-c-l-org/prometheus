{"version":3,"file":"detector-performance.js","sourceRoot":"","sources":["../../../src/analistas/detectores/detector-performance.ts"],"names":[],"mappings":"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","sourcesContent":["// SPDX-License-Identifier: MIT-0\n// @prometheus-disable PROBLEMA_PERFORMANCE\n// Justificativa: detector de performance que analisa código-fonte - loops são esperados\nimport type { NodePath } from '@babel/traverse';\nimport type { CallExpression, ForStatement, Node } from '@babel/types';\nimport { config } from '@core/config/config.js';\nimport { traverse } from '@core/config/traverse.js';\nimport { DetectorAgregadosMensagens } from '@core/messages/analistas/detector-agregados-messages.js';\nimport { detectarContextoProjeto } from '@shared/contexto-projeto.js';\nimport { filtrarOcorrenciasSuprimidas } from '@shared/helpers/suppressao.js';\n\nimport type { Analista, Ocorrencia, ProblemaPerformance } from '@';\nimport { criarOcorrencia } from '@';\n\nconst LIMITE_PERFORMANCE = config.ANALISE_LIMITES?.PERFORMANCE ?? {\n  MAX_LOOPS_ANNIDED: 2,\n  MAX_BLOCKING_OPS: 0,\n  MAX_MEMORY_LEAKS: 0,\n  MAX_N_PLUS_ONE: 0,\n  MAX_INEFFICIENT_SPREAD: 0,\n  MAX_LARGE_BUNDLE: 0,\n  MAX_CONSOLE_LOG: 10,\n  MAX_IGNORAR_TESTES: true\n};\n\nexport const analistaDesempenho: Analista = {\n  nome: 'performance',\n  categoria: 'performance',\n  descricao: 'Detecta problemas de performance e otimizações possíveis',\n  limites: LIMITE_PERFORMANCE,\n  test: (relPath: string): boolean => {\n    return /\\.(js|jsx|ts|tsx|mjs|cjs)$/.test(relPath);\n  },\n  aplicar: (src: string, relPath: string, ast: NodePath<Node> | null): Ocorrencia[] => {\n    if (!src) return [];\n    const contextoArquivo = detectarContextoProjeto({\n      arquivo: relPath,\n      conteudo: src,\n      relPath\n    });\n    const problemas: ProblemaPerformance[] = [];\n    try {\n      // Detectar problemas por padrões de texto\n      detectarPadroesPerformance(src, problemas, relPath);\n\n      // Detectar problemas via AST quando disponível\n      if (ast) {\n        detectarProblemasPerformanceAST(ast, problemas, relPath);\n      }\n\n      // Converter para ocorrências\n      const ocorrencias: Ocorrencia[] = [];\n\n      // Agrupar por impacto\n      const porImpacto = agruparPorImpacto(problemas);\n      for (const [impacto, items] of Object.entries(porImpacto)) {\n        if (items.length > 0) {\n          const nivel = mapearImpactoParaNivel(impacto as ProblemaPerformance['impacto']);\n\n          // Ser menos rigoroso com testes\n          const nivelAjustado = contextoArquivo.isTest && nivel === 'aviso' ? 'info' : nivel;\n          const resumo = items.slice(0, 3).map(p => p.tipo).join(', ');\n          ocorrencias.push(criarOcorrencia({\n            tipo: 'PROBLEMA_PERFORMANCE',\n            nivel: nivelAjustado,\n            mensagem: DetectorAgregadosMensagens.problemasPerformanceResumo(impacto, resumo, items.length),\n            relPath,\n            linha: items[0].linha\n          }));\n        }\n      }\n\n      // Aplicar supressões inline antes de retornar\n      return filtrarOcorrenciasSuprimidas(ocorrencias, 'performance', src);\n    } catch (erro) {\n      return [criarOcorrencia({\n        tipo: 'ERRO_ANALISE',\n        nivel: 'aviso',\n        mensagem: DetectorAgregadosMensagens.erroAnalisarPerformance(erro),\n        relPath,\n        linha: 1\n      })];\n    }\n  }\n};\nfunction detectarConsoleEmProducao(linha: string, numeroLinha: number, problemas: ProblemaPerformance[]): void {\n  const consolePatterns = [\n    /console\\.(log|debug|info|warn|error)\\s*\\(/,\n  ];\n  const ignoreComments = /\\/\\/\\s*prometheus-ignore|\\/\\*\\s*prometheus-ignore/i;\n\n  for (const pattern of consolePatterns) {\n    if (pattern.test(linha) && !ignoreComments.test(linha)) {\n      problemas.push({\n        tipo: 'console-in-production',\n        descricao: 'Console.log/info/debug em código pode vazar informações em produção',\n        impacto: 'baixo',\n        linha: numeroLinha,\n        coluna: linha.indexOf('console') + 1,\n        sugestao: 'Remova console.log em produção ou use biblioteca de logging condicional'\n      });\n      return;\n    }\n  }\n}\n\nfunction detectarMemoryLeakClosure(linha: string, numeroLinha: number, problemas: ProblemaPerformance[]): void {\n  const patterns = [\n    /addEventListener\\s*\\(/,\n    /setInterval\\s*\\(/,\n    /setTimeout\\s*\\(/,\n  ];\n\n  for (const pattern of patterns) {\n    if (pattern.test(linha)) {\n      problemas.push({\n        tipo: 'potential-memory-leak',\n        descricao: 'Timer ou listener sem cleanup pode causar vazamento de memória',\n        impacto: 'medio',\n        linha: numeroLinha,\n        coluna: linha.indexOf(pattern.source.replace(/\\\\/g, '')) + 1,\n        sugestao: 'Certifique-se de remover o listener/timer no unmount do componente'\n      });\n      return;\n    }\n  }\n}\n\nfunction detectarDOMManipulation(linha: string, numeroLinha: number, problemas: ProblemaPerformance[]): void {\n  const domPatterns = [\n    /\\.innerHTML\\s*=/,\n    /\\.outerHTML\\s*=/,\n    /document\\.write\\s*\\(/,\n    /createElement\\s*\\(.*\\)\\.appendChild/,\n  ];\n\n  for (const pattern of domPatterns) {\n    if (pattern.test(linha)) {\n      const match = linha.match(pattern);\n      const matchStr = match ? match[0] : '';\n      problemas.push({\n        tipo: 'inefficient-dom',\n        descricao: 'Manipulação direta de DOM pode causar reflows/repaints desnecessários',\n        impacto: 'medio',\n        linha: numeroLinha,\n        coluna: linha.indexOf(matchStr) + 1,\n        sugestao: 'Use fragment ou batch operações DOM para minimizar reflows'\n      });\n      return;\n    }\n  }\n}\n\nfunction detectarInefficientArray(linha: string, numeroLinha: number, problemas: ProblemaPerformance[]): void {\n  const patterns = [\n    { regex: /\\.forEach\\s*\\(/, tipo: 'inefficient-array', descricao: 'forEach é mais lento que for loop tradicional', sugestao: 'Use for...of ou for loop clássico para melhor performance' },\n    { regex: /\\.filter\\s*\\([^)]*\\)\\s*\\.\\s*map\\s*\\(/, tipo: 'double-iteration', descricao: 'filter seguido de map faz duas iterações', sugestao: 'Use map com condicional ou reduce para uma única iteração' },\n    { regex: /\\.sort\\s*\\(\\s*\\([^)]*\\)\\s*=>\\s*\\w+\\.\\w+\\s*-\\s*\\w+\\.\\w+\\s*\\)/, tipo: 'inefficient-sort', descricao: 'Função de sort sem memoization pode ser lenta em grandes listas', sugestao: 'Considere usar sort fora do render ou com useMemo' },\n  ];\n\n  for (const p of patterns) {\n    if (p.regex.test(linha)) {\n      problemas.push({\n        tipo: p.tipo,\n        descricao: p.descricao,\n        impacto: 'baixo',\n        linha: numeroLinha,\n        coluna: linha.indexOf(p.regex.source.replace(/\\\\/g, '').split('(')[0]) + 1,\n        sugestao: p.sugestao\n      });\n      return;\n    }\n  }\n}\n\nfunction detectarPadroesPerformance(src: string, problemas: ProblemaPerformance[], relPath: string): void {\n  const linhas = src.split('\\n');\n  let dentroLoop = 0;\n\n  linhas.forEach((linha, index) => {\n    const numeroLinha = index + 1;\n\n    // Novas detecções de performance\n    detectarConsoleEmProducao(linha, numeroLinha, problemas);\n    detectarMemoryLeakClosure(linha, numeroLinha, problemas);\n    detectarDOMManipulation(linha, numeroLinha, problemas);\n    detectarInefficientArray(linha, numeroLinha, problemas);\n\n    // Detectar entrada de loops\n    if (/\\b(for|while)\\s*\\(/.test(linha)) {\n      dentroLoop++;\n\n      // Se já estamos em um loop e encontramos outro, é loop aninhado\n      if (dentroLoop > 1) {\n        problemas.push({\n          tipo: 'inefficient-loop',\n          descricao: 'Loops aninhados podem causar problemas de performance O(n²)',\n          impacto: 'alto',\n          linha: numeroLinha,\n          coluna: linha.indexOf('for') !== -1 ? linha.indexOf('for') + 1 : linha.indexOf('while') + 1,\n          sugestao: 'Considere usar Map, Set ou otimizar algoritmo para complexidade linear'\n        });\n      }\n    }\n\n    // Detectar saída de loops (simplificado)\n    if (/^\\s*}/.test(linha) && dentroLoop > 0) {\n      dentroLoop = Math.max(0, dentroLoop - 1);\n    }\n\n    // Operações síncronas bloqueantes\n    if (/\\b(readFileSync|writeFileSync|execSync)\\s*\\(/.test(linha)) {\n      problemas.push({\n        tipo: 'blocking-operation',\n        descricao: 'Operação síncrona pode bloquear event loop',\n        impacto: 'alto',\n        linha: numeroLinha,\n        coluna: linha.indexOf(/readFileSync|writeFileSync|execSync/.exec(linha)?.[0] || '') + 1,\n        sugestao: 'Use versões assíncronas: readFile, writeFile, exec'\n      });\n    }\n\n    // Event listeners sem cleanup\n    if (/addEventListener\\s*\\(/.test(linha)) {\n      // Verificar se há removeEventListener no código (ignorando comentários)\n      const srcSemComentarios = src.replace(/\\/\\/.*$/gm, '').replace(/\\/\\*[\\s\\S]*?\\*\\//g, '');\n      if (!srcSemComentarios.includes('removeEventListener') && !srcSemComentarios.includes('cleanup') && !srcSemComentarios.includes('destroy')) {\n        problemas.push({\n          tipo: 'memory-leak',\n          descricao: 'Event listener pode causar vazamento de memória',\n          impacto: 'medio',\n          linha: numeroLinha,\n          coluna: linha.indexOf('addEventListener') + 1,\n          sugestao: 'Adicione removeEventListener em cleanup/destroy'\n        });\n      }\n    }\n\n    // React: map sem key (detecção melhorada)\n    if (/\\.map\\s*\\([^)]*\\)/.test(linha) && (/return\\s*<|<\\w+/.test(linha) || relPath.includes('.tsx') || relPath.includes('.jsx')) && !linha.includes('key=')) {\n      problemas.push({\n        tipo: 'unnecessary-rerender',\n        descricao: 'React map sem key prop pode causar rerenders desnecessários',\n        impacto: 'medio',\n        linha: numeroLinha,\n        coluna: linha.indexOf('.map') + 1,\n        sugestao: 'Adicione key prop única para cada elemento da lista'\n      });\n    }\n\n    // N+1 queries pattern\n    if (/\\.forEach\\s*\\(.*\\.(find|get|query|select)\\s*\\(/.test(linha)) {\n      problemas.push({\n        tipo: 'n-plus-one',\n        descricao: 'Possível problema N+1 em consultas',\n        impacto: 'alto',\n        linha: numeroLinha,\n        coluna: linha.indexOf('.forEach') + 1,\n        sugestao: 'Use join/include ou agrupe consultas para evitar N+1'\n      });\n    }\n\n    // Inefficient spread in loops\n    if (dentroLoop > 0 && (linha.includes('= [...') || linha.includes('= { ...'))) {\n      problemas.push({\n        tipo: 'inefficient-spread',\n        descricao: 'Spread operator dentro de loop cria novo objeto/array a cada iteração',\n        impacto: 'alto',\n        linha: numeroLinha,\n        coluna: linha.indexOf('...') + 1,\n        sugestao: 'Use push() ou mutação controlada para evitar criação excessiva de objetos'\n      });\n    }\n\n    // Imports de bibliotecas grandes\n    if (/import.*from\\s+['\"]lodash['\"]|import.*from\\s+['\"]moment['\"]/.test(linha)) {\n      problemas.push({\n        tipo: 'large-bundle',\n        descricao: 'Import completo de biblioteca grande pode aumentar bundle',\n        impacto: 'medio',\n        linha: numeroLinha,\n        coluna: linha.indexOf('import') + 1,\n        sugestao: 'Use imports específicos: import { method } from \"lodash/method\"'\n      });\n    }\n  });\n}\nfunction detectarProblemasPerformanceAST(ast: NodePath<Node>, problemas: ProblemaPerformance[], relPath: string): void {\n  try {\n    traverse(ast.node, {\n      // Detectar loops aninhados via AST (mais preciso)\n      ForStatement(path: NodePath<ForStatement>) {\n        let parent = path.parent;\n        while (parent) {\n          if (parent.type === 'ForStatement' || parent.type === 'WhileStatement' || parent.type === 'DoWhileStatement') {\n            problemas.push({\n              tipo: 'inefficient-loop',\n              descricao: 'Loop aninhado detectado via AST - pode causar performance O(n²)',\n              impacto: 'alto',\n              linha: path.node.loc?.start.line || 0,\n              coluna: path.node.loc?.start.column || 0,\n              sugestao: 'Considere restruturar algoritmo para evitar complexidade quadrática'\n            });\n            break;\n          }\n          parent = (parent as NodePath).parent; // Parent NodePath\n        }\n      },\n      // Detectar função setTimeout/setInterval sem cleanup\n      CallExpression(path: NodePath<CallExpression>) {\n        if (path.node.callee.type === 'Identifier' && (path.node.callee.name === 'setTimeout' || path.node.callee.name === 'setInterval')) {\n          // Verificar se há clearTimeout/clearInterval no escopo\n          const binding = path.scope.getBinding(path.node.callee.name);\n          if (!binding) return;\n\n          // Heurística simples: se não há clear* na mesma função/arquivo\n          const parentFunction = path.getFunctionParent();\n          if (parentFunction && !parentFunction.toString().includes('clear') && !relPath.includes('test')) {\n            problemas.push({\n              tipo: 'memory-leak',\n              descricao: `${path.node.callee.name} sem cleanup pode causar vazamento`,\n              impacto: 'medio',\n              linha: path.node.loc?.start.line || 0,\n              coluna: path.node.loc?.start.column || 0,\n              sugestao: `Use clear${path.node.callee.name.replace('set', '')} para limpar`\n            });\n          }\n        }\n      }\n    });\n  } catch {\n    // Ignorar erros de traverse\n  }\n}\nfunction agruparPorImpacto(problemas: ProblemaPerformance[]): Record<string, ProblemaPerformance[]> {\n  return problemas.reduce((acc, problema) => {\n    const impacto = problema.impacto;\n    if (impacto) {\n      if (!acc[impacto]) {\n        acc[impacto] = [];\n      }\n      acc[impacto].push(problema);\n    }\n    return acc;\n  }, {} as Record<string, ProblemaPerformance[]>);\n}\nfunction mapearImpactoParaNivel(impacto: ProblemaPerformance['impacto']): 'info' | 'aviso' | 'erro' {\n  switch (impacto) {\n    case 'alto':\n      return 'aviso';\n    case 'medio':\n      return 'aviso';\n    case 'baixo':\n    default:\n      return 'info';\n  }\n}\n"]}