{"version":3,"file":"detector-codigo-fragil.js","sourceRoot":"","sources":["../../../src/analistas/detectores/detector-codigo-fragil.ts"],"names":[],"mappings":"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","sourcesContent":["// SPDX-License-Identifier: MIT-0\nimport type { NodePath } from '@babel/traverse';\nimport type { ArrowFunctionExpression, CallExpression, CatchClause, ClassMethod, FunctionDeclaration, FunctionExpression, Node, NumericLiteral, TSAnyKeyword } from '@babel/types';\nimport { config } from '@core/config/config.js';\nimport { traverse } from '@core/config/traverse.js';\nimport { DetectorCodigoFragilMensagens } from '@core/messages/analistas/detector-codigo-fragil-messages.js';\nimport { detectarFrameworks } from '@shared/helpers/framework-detector.js';\nimport { isWhitelistedConstant } from '@shared/helpers/magic-constants-whitelist.js';\nimport { filtrarOcorrenciasSuprimidas } from '@shared/helpers/suppressao.js';\n\nimport type { Analista, Fragilidade, Ocorrencia } from '@';\nimport { criarOcorrencia } from '@';\n\n// Cache de frameworks detectados (evita múltiplas leituras do package.json)\nlet frameworksDetectados: string[] | null = null;\nconst LIMITES = {\n  LINHAS_FUNCAO: 30,\n  PARAMETROS_FUNCAO: 4,\n  MAX_PARAMETROS_CRITICO: 6,\n  CALLBACKS_ANINHADOS: 2,\n  COMPLEXIDADE_COGNITIVA: 15,\n  REGEX_COMPLEXA_LENGTH: 50\n} as const;\nexport const analistaCodigoFragil: Analista = {\n  nome: 'codigo-fragil',\n  categoria: 'qualidade',\n  descricao: 'Detecta padrões de código que podem levar a problemas futuros',\n  limites: {\n    maxLinhasFuncao: config.ANALISE_LIMITES?.CODIGO_FRAGIL?.MAX_LINHAS_FUNCAO ?? LIMITES.LINHAS_FUNCAO,\n    maxParametros: config.ANALISE_LIMITES?.CODIGO_FRAGIL?.MAX_PARAMETROS ?? LIMITES.PARAMETROS_FUNCAO,\n    maxNestedCallbacks: config.ANALISE_LIMITES?.CODIGO_FRAGIL?.MAX_NESTED_CALLBACKS ?? LIMITES.CALLBACKS_ANINHADOS\n  },\n  test: (relPath: string): boolean => {\n    // Ignorar arquivos deprecados e abandonados\n    if (/\\.(deprecados?|abandonados?)\\//i.test(relPath) || relPath.includes('.deprecados/') || relPath.includes('abandonados/')) {\n      return false;\n    }\n    return /\\.(js|jsx|ts|tsx|mjs|cjs)$/.test(relPath);\n  },\n  aplicar: (src: string, relPath: string, ast: NodePath<Node> | null): Ocorrencia[] => {\n    if (!ast || !src) {\n      return [];\n    }\n\n    // Limites efetivos (lidos dinamicamente para respeitar overrides por env/config)\n    const maxLinhasFuncao = config.ANALISE_LIMITES?.CODIGO_FRAGIL?.MAX_LINHAS_FUNCAO ?? LIMITES.LINHAS_FUNCAO;\n    const maxParametros = config.ANALISE_LIMITES?.CODIGO_FRAGIL?.MAX_PARAMETROS ?? LIMITES.PARAMETROS_FUNCAO;\n    const maxNestedCallbacks = config.ANALISE_LIMITES?.CODIGO_FRAGIL?.MAX_NESTED_CALLBACKS ?? LIMITES.CALLBACKS_ANINHADOS;\n    const fragilidades: Fragilidade[] = [];\n    try {\n      // Detectar problemas baseados em texto\n      detectarConsoleLog(src, fragilidades);\n      detectarTodoComments(src, fragilidades);\n\n      // Detecções avançadas baseadas em texto\n      detectarProblemasAvancados(src, fragilidades);\n\n      // Detectar problemas via AST\n      traverse(ast.node, {\n        // Blocos catch vazios\n        CatchClause(path: NodePath<CatchClause>) {\n          const body = path.node.body.body;\n          const linha = path.node.loc?.start.line || 0;\n          if (body.length === 0) {\n            fragilidades.push({\n              tipo: 'catch-vazio',\n              linha,\n              coluna: path.node.loc?.start.column || 0,\n              severidade: 'media',\n              contexto: 'Bloco catch vazio'\n            });\n          } else if (body.length === 1 && isSingleConsoleLog(body[0])) {\n            fragilidades.push({\n              tipo: 'catch-apenas-log',\n              linha,\n              coluna: path.node.loc?.start.column || 0,\n              severidade: 'baixa',\n              contexto: 'Catch apenas com console.log'\n            });\n          }\n        },\n        // Uso explícito de 'any'\n        TSAnyKeyword(path: NodePath<TSAnyKeyword>) {\n          fragilidades.push({\n            tipo: 'any-explicito',\n            linha: path.node.loc?.start.line || 0,\n            coluna: path.node.loc?.start.column || 0,\n            severidade: 'media',\n            contexto: 'Tipo any explícito'\n          });\n        },\n        // Funções muito longas + muitos parâmetros\n        FunctionDeclaration(path: NodePath<FunctionDeclaration>) {\n          const node = path.node;\n\n          // Verificar tamanho da função\n          if (node.body?.type === 'BlockStatement') {\n            const inicio = node.loc?.start.line || 0;\n            const fim = node.loc?.end.line || 0;\n            const numLinhas = fim - inicio;\n            if (numLinhas > maxLinhasFuncao) {\n              fragilidades.push({\n                tipo: 'funcao-longa',\n                linha: inicio,\n                coluna: node.loc?.start.column || 0,\n                severidade: numLinhas > Math.max(maxLinhasFuncao + 20, Math.floor(maxLinhasFuncao * 1.7)) ? 'alta' : 'media',\n                contexto: `Função com ${numLinhas} linhas (máx: ${maxLinhasFuncao})`\n              });\n            }\n          }\n\n          // Verificar número de parâmetros\n          const numParams = node.params.length;\n          if (numParams > maxParametros) {\n            fragilidades.push({\n              tipo: 'muitos-parametros',\n              linha: node.loc?.start.line || 0,\n              coluna: node.loc?.start.column || 0,\n              severidade: numParams > Math.max(maxParametros + 2, Math.floor(maxParametros * 1.5)) ? 'alta' : 'media',\n              contexto: `Função com ${numParams} parâmetros (máx: ${maxParametros})`\n            });\n          }\n\n          // Complexidade Cognitiva (AST)\n          const comp = calcularComplexidadeCognitivaAST(path);\n          if (comp > LIMITES.COMPLEXIDADE_COGNITIVA) {\n            fragilidades.push({\n              tipo: 'cognitive-complexity',\n              linha: node.loc?.start.line || 0,\n              coluna: node.loc?.start.column || 0,\n              severidade: comp > LIMITES.COMPLEXIDADE_COGNITIVA * 2 ? 'alta' : 'media',\n              contexto: `Complexidade cognitiva elevada: ${comp} (limite: ${LIMITES.COMPLEXIDADE_COGNITIVA})`\n            });\n          }\n        },\n        ArrowFunctionExpression(path: NodePath<ArrowFunctionExpression>) {\n          const node = path.node;\n          if (node.body?.type === 'BlockStatement') {\n            const inicio = node.loc?.start.line || 0;\n            const fim = node.loc?.end.line || 0;\n            const numLinhas = fim - inicio;\n            if (numLinhas > maxLinhasFuncao) {\n              fragilidades.push({\n                tipo: 'funcao-longa',\n                linha: inicio,\n                coluna: node.loc?.start.column || 0,\n                severidade: numLinhas > Math.max(maxLinhasFuncao + 20, Math.floor(maxLinhasFuncao * 1.7)) ? 'alta' : 'media',\n                contexto: `Arrow function with ${numLinhas} lines (max: ${maxLinhasFuncao})`\n              });\n            }\n\n            // Complexidade Cognitiva\n            const comp = calcularComplexidadeCognitivaAST(path);\n            if (comp > LIMITES.COMPLEXIDADE_COGNITIVA) {\n              fragilidades.push({\n                tipo: 'cognitive-complexity',\n                linha: inicio,\n                coluna: node.loc?.start.column || 0,\n                severidade: comp > LIMITES.COMPLEXIDADE_COGNITIVA * 2 ? 'alta' : 'media',\n                contexto: `Complexidade cognitiva elevada (arrow): ${comp} (limite: ${LIMITES.COMPLEXIDADE_COGNITIVA})`\n              });\n            }\n          }\n        },\n        FunctionExpression(path: NodePath<FunctionExpression>) {\n          const node = path.node;\n          if (node.body?.type === 'BlockStatement') {\n            const inicio = node.loc?.start.line || 0;\n            const fim = node.loc?.end.line || 0;\n            const numLinhas = fim - inicio;\n            if (numLinhas > maxLinhasFuncao) {\n              fragilidades.push({\n                tipo: 'funcao-longa',\n                linha: inicio,\n                coluna: node.loc?.start.column || 0,\n                severidade: numLinhas > Math.max(maxLinhasFuncao + 20, Math.floor(maxLinhasFuncao * 1.7)) ? 'alta' : 'media',\n                contexto: `Function expression with ${numLinhas} lines (max: ${maxLinhasFuncao})`\n              });\n            }\n\n            // Complexidade Cognitiva\n            const comp = calcularComplexidadeCognitivaAST(path);\n            if (comp > LIMITES.COMPLEXIDADE_COGNITIVA) {\n              fragilidades.push({\n                tipo: 'cognitive-complexity',\n                linha: inicio,\n                coluna: node.loc?.start.column || 0,\n                severidade: comp > LIMITES.COMPLEXIDADE_COGNITIVA * 2 ? 'alta' : 'media',\n                contexto: `Complexidade cognitiva elevada: ${comp} (limite: ${LIMITES.COMPLEXIDADE_COGNITIVA})`\n              });\n            }\n          }\n        },\n        // Números mágicos\n        NumericLiteral(path: NodePath<NumericLiteral>) {\n          const value = path.node.value;\n\n          // Ignorar se está em declaração de variável ou índice de array\n          if (isInVariableDeclarator(path) || isInArrayIndex(path)) {\n            return;\n          }\n\n          // Detectar frameworks do projeto (cache básico via closure)\n          if (!frameworksDetectados) {\n            const rootDir = process.cwd();\n            const frameworks = detectarFrameworks(rootDir);\n            frameworksDetectados = frameworks.map(f => f.name);\n          }\n\n          // Verificar se está na whitelist (valores comuns + limites de frameworks)\n          if (isWhitelistedConstant(value, frameworksDetectados)) {\n            return;\n          }\n          fragilidades.push({\n            tipo: 'magic-number',\n            linha: path.node.loc?.start.line || 0,\n            coluna: path.node.loc?.start.column || 0,\n            severidade: 'baixa',\n            contexto: `Número mágico: ${value}`\n          });\n        },\n        // Muitos parâmetros - ClassMethod\n        ClassMethod(path: NodePath<ClassMethod>) {\n          const node = path.node;\n          const numParams = node.params && Array.isArray(node.params) ? node.params.length : 0;\n          if (numParams > LIMITES.PARAMETROS_FUNCAO) {\n            fragilidades.push({\n              tipo: 'muitos-parametros',\n              linha: node.loc?.start.line || 0,\n              coluna: node.loc?.start.column || 0,\n              severidade: numParams > LIMITES.MAX_PARAMETROS_CRITICO ? 'alta' : 'media',\n              contexto: `Método com ${numParams} parâmetros`\n            });\n          }\n\n          // Complexidade Cognitiva\n          const comp = calcularComplexidadeCognitivaAST(path);\n          if (comp > LIMITES.COMPLEXIDADE_COGNITIVA) {\n            fragilidades.push({\n              tipo: 'cognitive-complexity',\n              linha: node.loc?.start.line || 0,\n              coluna: node.loc?.start.column || 0,\n              severidade: comp > LIMITES.COMPLEXIDADE_COGNITIVA * 2 ? 'alta' : 'media',\n              contexto: `Complexidade cognitiva elevada (método): ${comp} (limite: ${LIMITES.COMPLEXIDADE_COGNITIVA})`\n            });\n          }\n        }\n      });\n\n      // Detectar callbacks aninhados (requer análise específica)\n      detectarNestedCallbacks(ast, fragilidades, maxNestedCallbacks);\n\n      // Gerar ocorrências por severidade\n      const ocorrencias: Ocorrencia[] = [];\n\n      // Agrupar por severidade\n      const porSeveridade = agruparPorSeveridade(fragilidades);\n      for (const [severidade, items] of Object.entries(porSeveridade)) {\n        if (items.length > 0) {\n          const nivel = severidade === 'alta' ? 'erro' : severidade === 'media' ? 'aviso' : 'info';\n\n          // Criar resumo por tipo\n          const resumoPorTipo = items.reduce((acc, item) => {\n            acc[item.tipo] = (acc[item.tipo] || 0) + 1;\n            return acc;\n          }, {} as Record<string, number>);\n          const resumo = Object.entries(resumoPorTipo).map(([tipo, count]) => `${tipo}: ${count}`).join(', ');\n          ocorrencias.push(criarOcorrencia({\n            tipo: 'codigo-fragil',\n            nivel,\n            mensagem: DetectorCodigoFragilMensagens.fragilidadesResumo(severidade, resumo, {\n              severidade,\n              total: items.length,\n              tipos: resumoPorTipo,\n              amostra: items.slice(0, 3).map(f => `${f.tipo}:L${f.linha}`)\n            }),\n            relPath,\n            linha: items[0].linha\n          }));\n        }\n      }\n\n      // Aplicar supressões inline antes de retornar\n      return filtrarOcorrenciasSuprimidas(ocorrencias, 'codigo-fragil', src);\n    } catch (erro) {\n      return [criarOcorrencia({\n        tipo: 'ERRO_ANALISE',\n        nivel: 'aviso',\n        mensagem: DetectorCodigoFragilMensagens.erroAnalisarCodigoFragil(erro),\n        relPath,\n        linha: 1\n      })];\n    }\n  }\n};\nfunction detectarConsoleLog(src: string, fragilidades: Fragilidade[]): void {\n  const lines = src.split('\\n');\n  for (let i = 0; i < lines.length; i++) {\n    const line = lines[i];\n    const trimmedLine = line.trim();\n\n    // Ignorar linhas comentadas (// ou /* ... */)\n    if (trimmedLine.startsWith('//') || trimmedLine.startsWith('/*') && trimmedLine.endsWith('*/')) {\n      continue;\n    }\n\n    // Detectar console.log não comentado\n    const consoleMatch = line.match(/console\\.log\\s*\\(/);\n    if (consoleMatch) {\n      // Verificar se não está dentro de comentário de bloco\n      const beforeMatch = line.substring(0, consoleMatch.index);\n      if (beforeMatch.includes('/*') && !beforeMatch.includes('*/')) {\n        continue; // Está dentro de comentário de bloco\n      }\n      fragilidades.push({\n        tipo: 'console-log',\n        linha: i + 1,\n        coluna: consoleMatch.index || 0,\n        severidade: 'baixa',\n        contexto: 'console.log encontrado'\n      });\n    }\n  }\n}\nfunction detectarTodoComments(src: string, fragilidades: Fragilidade[]): void {\n  const regex = /\\/\\/\\s*TODO|\\/\\*\\s*TODO/gi;\n  let match;\n  while ((match = regex.exec(src)) !== null) {\n    const linha = src.substring(0, match.index).split('\\n').length;\n    fragilidades.push({\n      tipo: 'todo-comment',\n      linha,\n      coluna: 0,\n      severidade: 'baixa',\n      contexto: 'Comentário TODO encontrado'\n    });\n  }\n}\n\n/**\n * Detecta problemas avançados de código que indicam fragilidade (não duplicados com outros analistas)\n */\nfunction detectarProblemasAvancados(src: string, fragilidades: Fragilidade[]): void {\n  const lines = src.split('\\n');\n  for (let i = 0; i < lines.length; i++) {\n    const line = lines[i];\n    const trimmedLine = line.trim();\n\n    // Ignorar linhas comentadas\n    if (trimmedLine.startsWith('//') || trimmedLine.startsWith('/*') && trimmedLine.endsWith('*/')) {\n      continue;\n    }\n\n    // Promise sem catch (exclusivo - não coberto por outros analistas)\n    if (/\\.then\\s*\\(/.test(line) && !line.includes('.catch')) {\n      const nextLines = lines.slice(i, Math.min(i + 3, lines.length)).join(' ');\n      if (!nextLines.includes('.catch')) {\n        fragilidades.push({\n          tipo: 'promise-sem-catch',\n          linha: i + 1,\n          coluna: line.indexOf('.then'),\n          severidade: 'media',\n          contexto: 'Promise sem tratamento de erro (.catch)'\n        });\n      }\n    }\n\n    // addEventListener sem removeEventListener (detecção aprimorada)\n    if (/addEventListener\\s*\\(/.test(line)) {\n      const eventNome = line.match(/addEventListener\\s*\\(\\s*['\"`]([^'\"`]+)['\"`]/);\n      if (eventNome && !src.includes(`removeEventListener`) && !src.includes(`{ once: true }`) && !src.includes('AbortController')) {\n        fragilidades.push({\n          tipo: 'event-listener-sem-cleanup',\n          linha: i + 1,\n          coluna: line.indexOf('addEventListener'),\n          severidade: 'media',\n          contexto: `Event listener '${eventNome[1]}' sem cleanup`\n        });\n      }\n    }\n\n    // Regex complexa (mais de 50 caracteres com múltiplos grupos)\n    const regexMatch = line.match(/\\/([^\\/\\\\]|\\\\.)+\\/[gimuy]*/);\n    if (regexMatch && regexMatch[0].length > LIMITES.REGEX_COMPLEXA_LENGTH && (regexMatch[0].match(/\\(/g) || []).length > 3) {\n      fragilidades.push({\n        tipo: 'regex-complexa',\n        linha: i + 1,\n        coluna: line.indexOf(regexMatch[0]),\n        severidade: 'media',\n        contexto: 'Regex complexa - considere quebrar em partes menores'\n      });\n    }\n\n    // Potencial vazamento de memória - setInterval/setTimeout sem clear + addEventListener sem remove\n    if ((/setInterval\\s*\\(/.test(line) || /setTimeout\\s*\\(/.test(line)) && !src.includes('clear') && !line.includes('once')) {\n      fragilidades.push({\n        tipo: 'memory-leak-potential',\n        linha: i + 1,\n        coluna: line.search(/setInterval|setTimeout/),\n        severidade: 'media',\n        contexto: 'Potencial vazamento: timer sem cleanup'\n      });\n    }\n  }\n\n  // No longer needed: regex detection removed in favor of AST\n}\n\n/**\n * Detecta complexidade cognitiva alta baseada em estruturas de controle (mais avançado que analista de funções longas)\n */\nfunction calcularComplexidadeCognitivaAST(path: NodePath): number {\n  let score = 0;\n  let nesting = 0;\n\n  const incrementTypes = [\n    'IfStatement', 'WhileStatement', 'DoWhileStatement',\n    'ForStatement', 'ForInStatement', 'ForOfStatement',\n    'SwitchStatement', 'CatchClause', 'ConditionalExpression'\n  ];\n\n  path.traverse({\n    enter(p) {\n      if (incrementTypes.includes(p.node.type)) {\n        score += 1 + nesting;\n        nesting++;\n      }\n      if (p.node.type === 'LogicalExpression' && (p.node.operator === '&&' || p.node.operator === '||')) {\n        score += 1;\n      }\n    },\n    exit(p) {\n      if (incrementTypes.includes(p.node.type)) {\n        nesting--;\n      }\n    }\n  });\n\n  return score;\n}\n\nfunction detectarNestedCallbacks(ast: NodePath<Node>, fragilidades: Fragilidade[], limite: number): void {\n  const lim = Number.isFinite(limite) && limite >= 0 ? limite : 2;\n  traverse(ast.node, {\n    CallExpression(path: NodePath<CallExpression>) {\n      const profundidade = calcularProfundidadeCallback(path);\n      if (profundidade > lim) {\n        fragilidades.push({\n          tipo: 'nested-callbacks',\n          linha: path.node.loc?.start.line || 0,\n          coluna: path.node.loc?.start.column || 0,\n          severidade: profundidade > lim + 1 ? 'alta' : 'media',\n          contexto: `Callbacks aninhados (nível ${profundidade}, máx: ${lim})`\n        });\n      }\n    }\n  });\n}\nfunction calcularProfundidadeCallback(path: NodePath): number {\n  let profundidade = 0;\n  let current: NodePath | null = path;\n  while (current) {\n    if (current.isCallExpression() && hasCallbackArgument(current)) {\n      profundidade++;\n    }\n    current = current.parentPath;\n  }\n  return profundidade;\n}\nfunction hasCallbackArgument(path: NodePath): boolean {\n  if (!path.isCallExpression()) return false;\n  return path.node.arguments.some(arg => arg.type === 'ArrowFunctionExpression' || arg.type === 'FunctionExpression');\n}\nfunction isSingleConsoleLog(stmt: Node): boolean {\n  // Statement node\n  return stmt.type === 'ExpressionStatement' && stmt.expression?.type === 'CallExpression' && stmt.expression.callee?.type === 'MemberExpression' && stmt.expression.callee.object?.type === 'Identifier' && stmt.expression.callee.object.name === 'console';\n}\nfunction isInVariableDeclarator(path: NodePath): boolean {\n  return path.findParent(p => p.isVariableDeclarator()) !== null;\n}\nfunction isInArrayIndex(path: NodePath): boolean {\n  return path.findParent(p => p.isMemberExpression() && p.node.computed) !== null;\n}\nfunction agruparPorSeveridade(fragilidades: Fragilidade[]): Record<string, Fragilidade[]> {\n  return fragilidades.reduce((acc, frag) => {\n    const sev = frag.severidade as string || 'media';\n    if (!acc[sev]) {\n      acc[sev] = [];\n    }\n    acc[sev].push(frag);\n    return acc;\n  }, {} as Record<string, Fragilidade[]>);\n}\n"]}