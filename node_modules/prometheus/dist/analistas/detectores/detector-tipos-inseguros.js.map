{"version":3,"file":"detector-tipos-inseguros.js","sourceRoot":"","sources":["../../../src/analistas/detectores/detector-tipos-inseguros.ts"],"names":[],"mappings":"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","sourcesContent":["// SPDX-License-Identifier: MIT-0\n/**\n * Detector de tipos inseguros (any e unknown) - Vers√£o Inteligente\n * Identifica uso de any e unknown com an√°lise contextual avan√ßada\n *\n * Estrat√©gia:\n * - Analisa contexto para determinar legitimidade do uso\n * - Sugere alternativas espec√≠ficas quando poss√≠vel\n * - Explica variantes e possibilidades quando an√°lise √© incerta\n * - Sempre recomenda revis√£o manual para casos complexos\n */\n\nimport { categorizarUnknown, extractVariableName, isAnyInGenericFunction, isInStringOrComment, isLegacyOrVendorFile, isTypeScriptContext, isUnknownInGenericContext } from '@analistas/corrections/type-safety/context-analyzer.js';\nimport type { NodePath } from '@babel/traverse';\nimport type { Node } from '@babel/types';\nimport { config } from '@core/config/config.js';\nimport { shouldSuppressOccurrence } from '@shared/helpers/rule-config.js';\n\nimport type { Analista, Ocorrencia } from '@';\n\nconst ANALISTA: Analista = {\n  nome: 'detector-tipos-inseguros',\n  categoria: 'code-quality',\n  descricao: 'Detecta uso de any e unknown que podem ser substitu√≠dos por tipos espec√≠ficos',\n  test: (relPath: string) => {\n    return relPath.endsWith('.ts') || relPath.endsWith('.tsx');\n  },\n  aplicar: async (srcParam: string, relPath: string, _ast: NodePath<Node> | null, fullCaminho?: string): Promise<Ocorrencia[]> => {\n    const ocorrencias: Ocorrencia[] = [];\n\n    // IMPORTANTE: Normaliza√ß√£o de line endings para compatibilidade Windows/Linux\n    // Sem isso, arquivos com \\r\\n causam split('\\n') incorreto (retorna 1 linha)\n    // Ver: docs/reports/DEBUG-TYPE-SAFETY-DETECTOR-2025-11-03.md\n    const src = srcParam.replace(/\\r\\n/g, '\\n');\n\n    // Ignorar arquivos de teste quando permitido na configura√ß√£o\n    const isTestArquivo = (p: string) => {\n      const rel = p.replace(/\\\\/g, '/').toLowerCase();\n      return /(^|\\/)tests?(\\/|\\.)/.test(rel) || /__tests__/.test(rel) || /\\.(test|spec)\\.(ts|tsx|js|jsx)$/.test(rel);\n    };\n    const allowAnyInTests = Boolean((config as unknown as {\n      testPadroes?: {\n        allowAnyType?: boolean;\n      };\n    }).testPadroes?.allowAnyType);\n    if (allowAnyInTests && isTestArquivo(fullCaminho || relPath)) {\n      return ocorrencias;\n    }\n\n    // Verificar se √© arquivo que deve ser ignorado\n    if (isLegacyOrVendorFile(fullCaminho || relPath)) {\n      return ocorrencias;\n    }\n\n    // Detectar uso de any\n    const anyPadrao = /:\\s*any\\b/g;\n    let anyMatch: RegExpMatchArray | null;\n    while ((anyMatch = anyPadrao.exec(src)) !== null) {\n      const position = anyMatch.index || 0;\n\n      // Pular se estiver em string ou coment√°rio\n      if (isInStringOrComment(src, position)) {\n        continue;\n      }\n\n      // Pular se estiver em contexto TypeScript espec√≠fico (type assertions)\n      if (isTypeScriptContext(src, position)) {\n        continue;\n      }\n\n      // Pular se any est√° em fun√ß√£o gen√©rica apropriada\n      if (isAnyInGenericFunction(src, position)) {\n        continue;\n      }\n\n      // Extrair nome da vari√°vel e contexto\n      const varNome = extractVariableName(anyMatch, src);\n      const linha = src.substring(0, position).split('\\n').length;\n      const lineContext = src.split('\\n')[linha - 1]?.trim() || '';\n\n      // An√°lise contextual para any\n      let mensagem = '';\n      let sugestao = '';\n\n      // Detectar padr√µes espec√≠ficos\n      if (/catch\\s*\\(\\s*\\w+\\s*:\\s*any\\s*\\)/.test(lineContext)) {\n        mensagem = varNome ? `'any' em catch block '${varNome}' - TypeScript recomenda 'unknown'` : \"'any' em catch block - TypeScript recomenda 'unknown'\";\n        sugestao = 'Substitua por: catch (error: unknown) { ... }';\n      } else if (/callback\\s*:\\s*\\([^)]*:\\s*any/.test(lineContext)) {\n        mensagem = varNome ? `Callback '${varNome}' com par√¢metro 'any' - tipagem fraca` : \"Callback com par√¢metro 'any' - tipagem fraca\";\n        sugestao = 'Defina interface do callback: (param: TipoEspecifico) => void';\n      } else if (/event\\s*:\\s*any|e\\s*:\\s*any/.test(lineContext)) {\n        mensagem = varNome ? `Event handler '${varNome}' com 'any' - pode usar Event types` : \"Event handler com 'any' - pode usar Event types\";\n        sugestao = 'Use tipos do DOM: MouseEvent, KeyboardEvent, etc ou React.SyntheticEvent<T>';\n      } else if (/\\[\\s*key\\s*:\\s*string\\s*\\]\\s*:\\s*any/.test(lineContext)) {\n        mensagem = '√çndice extens√≠vel com any - muito permissivo';\n        sugestao = 'Use: [key: string]: unknown (mais seguro) ou defina union type';\n      } else if (/Record<[^,]+,\\s*any>/.test(lineContext)) {\n        mensagem = varNome ? `Record com 'any' em '${varNome}' - sem type safety` : \"Record com 'any' - sem type safety\";\n        sugestao = 'Use Record<string, unknown> ou interface espec√≠fica';\n      } else if (/Array<any>/.test(lineContext) || /any\\[\\]/.test(lineContext)) {\n        mensagem = varNome ? `Array de 'any' em '${varNome}' - perde tipagem` : \"Array de 'any' - perde tipagem\";\n        sugestao = 'Especifique tipo do array: string[], number[], CustomType[], etc';\n      } else {\n        // Caso gen√©rico\n        mensagem = varNome ? `Tipo 'any' em '${varNome}' desabilita verifica√ß√£o de tipos` : \"Tipo 'any' desabilita verifica√ß√£o de tipos\";\n        sugestao = 'Analise uso da vari√°vel e defina tipo espec√≠fico ou use unknown com type guards';\n      }\n\n      // Adicionar contexto adicional baseado no arquivo\n      let contextoAdicional = '';\n      if (fullCaminho?.includes('tipos/')) {\n        contextoAdicional = ' | ‚ö†Ô∏è  Arquivo de tipos - impacta toda base de c√≥digo';\n      } else if (fullCaminho?.includes('core/') || fullCaminho?.includes('shared/')) {\n        contextoAdicional = ' | ‚ö†Ô∏è  M√≥dulo core/shared - usado por muitos componentes';\n      }\n      const mensagemCompleta = `${mensagem} | üí° ${sugestao}${contextoAdicional} | üîç Revis√£o manual obrigat√≥ria`;\n\n      // Verifica se regra est√° suprimida para este arquivo\n      if (shouldSuppressOccurrence('tipo-inseguro-any', relPath)) {\n        continue;\n      }\n      ocorrencias.push({\n        tipo: 'tipo-inseguro-any',\n        nivel: 'aviso',\n        mensagem: mensagemCompleta,\n        relPath,\n        linha,\n        contexto: lineContext\n      });\n    }\n\n  /* -------------------------- DETECTAR TYPE ASSERTIONS (as any) -------------------------- */\n    const asAnyPadrao = /\\b(as\\s+any)\\b/g;\n    let asAnyMatch: RegExpMatchArray | null;\n    while ((asAnyMatch = asAnyPadrao.exec(src)) !== null) {\n      const position = asAnyMatch.index || 0;\n\n      // Pular se estiver em string ou coment√°rio\n      if (isInStringOrComment(src, position)) {\n        continue;\n      }\n      const linha = src.substring(0, position).split('\\n').length;\n      const lineContext = src.split('\\n')[linha - 1]?.trim() || '';\n\n      // Extrair contexto da express√£o\n      const after = src.substring(position, Math.min(src.length, position + 50));\n      const mensagem = \"Type assertion 'as any' desabilita verifica√ß√£o de tipos completamente\";\n      let sugestao = '';\n\n      // Detectar padr√µes comuns de type assertion\n      if (/\\)\\s*as\\s+any/.test(lineContext)) {\n        sugestao = 'Evite cast de retorno de fun√ß√£o - tipar fun√ß√£o corretamente ou usar unknown com type guard';\n      } else if (/\\.\\w+\\s+as\\s+any/.test(lineContext)) {\n        sugestao = 'Evite cast de propriedade - definir tipo correto no objeto pai';\n      } else if (/\\bas\\s+any\\s*\\)/.test(after)) {\n        sugestao = 'Type assertion em par√¢metro - definir tipo correto na assinatura da fun√ß√£o chamada';\n      } else {\n        sugestao = 'Substitua por tipo espec√≠fico ou use unknown com valida√ß√£o runtime';\n      }\n      const mensagemCompleta = `${mensagem} | üí° ${sugestao} | üö® CR√çTICO: Type safety completamente desabilitado | üîç Revis√£o manual obrigat√≥ria`;\n\n      // Verifica se regra est√° suprimida para este arquivo\n      if (shouldSuppressOccurrence('tipo-inseguro-any-assertion', relPath)) {\n        continue;\n      }\n      ocorrencias.push({\n        tipo: 'tipo-inseguro-any-assertion',\n        nivel: 'erro',\n        // Mais severo que declara√ß√£o de tipo\n        mensagem: mensagemCompleta,\n        relPath,\n        linha,\n        contexto: lineContext\n      });\n    }\n\n  /* -------------------------- DETECTAR ANGLE BRACKET CASTING (<any>) -------------------------- */\n    const angleBracketPadrao = /<any>/g;\n    let angleBracketMatch: RegExpMatchArray | null;\n    while ((angleBracketMatch = angleBracketPadrao.exec(src)) !== null) {\n      const position = angleBracketMatch.index || 0;\n\n      // Pular se estiver em string ou coment√°rio\n      if (isInStringOrComment(src, position)) {\n        continue;\n      }\n      const linha = src.substring(0, position).split('\\n').length;\n      const lineContext = src.split('\\n')[linha - 1]?.trim() || '';\n      const mensagemCompleta = \"Type casting '<any>' (sintaxe legada) desabilita type safety | üí° Use sintaxe 'as' moderna e tipo espec√≠fico | üö® CR√çTICO: Migrar para sintaxe moderna e tipo correto | üîç Revis√£o manual obrigat√≥ria\";\n\n      // Verifica se regra est√° suprimida para este arquivo\n      if (shouldSuppressOccurrence('tipo-inseguro-any-cast', relPath)) {\n        continue;\n      }\n      ocorrencias.push({\n        tipo: 'tipo-inseguro-any-cast',\n        nivel: 'erro',\n        mensagem: mensagemCompleta,\n        relPath,\n        linha,\n        contexto: lineContext\n      });\n    }\n\n    // Detectar uso de unknown\n    const unknownPadrao = /:\\s*unknown\\b/g;\n    let unknownMatch: RegExpMatchArray | null;\n    while ((unknownMatch = unknownPadrao.exec(src)) !== null) {\n      const position = unknownMatch.index || 0;\n\n      // Pular se estiver em string ou coment√°rio\n      if (isInStringOrComment(src, position)) {\n        continue;\n      }\n\n      // Pular se unknown est√° em contexto gen√©rico apropriado (valida√ß√£o b√°sica)\n      if (isUnknownInGenericContext(src, position)) {\n        continue;\n      }\n\n      // An√°lise contextual inteligente\n      const linha = src.substring(0, position).split('\\n').length;\n      const lineContext = src.split('\\n')[linha - 1]?.trim() || '';\n      const categorizacao = categorizarUnknown(src, fullCaminho || relPath, lineContext);\n\n      // Extrair nome da vari√°vel\n      const varNome = extractVariableName(unknownMatch, src);\n\n      // Construir mensagem baseada na categoriza√ß√£o\n      let mensagem = '';\n      let nivel: 'info' | 'aviso' | 'erro' = 'info';\n      if (categorizacao.categoria === 'legitimo') {\n        // Leg√≠timo com alta confian√ßa (>=95%) - PULAR completamente\n        if (categorizacao.confianca >= 95) {\n          continue;\n        }\n\n        // Leg√≠timo com confian√ßa moderada (85-94%) - info apenas\n        mensagem = varNome ? `Tipo 'unknown' em '${varNome}': ${categorizacao.motivo}` : `Tipo 'unknown': ${categorizacao.motivo}`;\n        nivel = 'info';\n\n        // Se tem sugest√£o, adicionar\n        if (categorizacao.sugestao) {\n          mensagem += ` | üí° ${categorizacao.sugestao}`;\n        }\n      } else if (categorizacao.categoria === 'melhoravel') {\n        // Melhor√°vel - aviso com sugest√£o\n        nivel = 'aviso';\n        mensagem = varNome ? `Tipo 'unknown' em '${varNome}' pode ser melhorado (${categorizacao.confianca}% confian√ßa)` : `Tipo 'unknown' pode ser melhorado (${categorizacao.confianca}% confian√ßa)`;\n        mensagem += ` | ${categorizacao.motivo}`;\n        if (categorizacao.sugestao) {\n          mensagem += ` | üí° ${categorizacao.sugestao}`;\n        } else {\n          mensagem += ` | üí° Revisar uso para inferir tipo mais espec√≠fico`;\n        }\n        mensagem += ` | ‚ö†Ô∏è  Revis√£o manual recomendada`;\n      } else {\n        // Corrigir - erro que deve ser tratado\n        nivel = 'erro';\n        mensagem = varNome ? `Tipo 'unknown' em '${varNome}' deve ser corrigido (${categorizacao.confianca}% confian√ßa)` : `Tipo 'unknown' deve ser corrigido (${categorizacao.confianca}% confian√ßa)`;\n        mensagem += ` | ${categorizacao.motivo}`;\n        if (categorizacao.sugestao) {\n          mensagem += ` | ‚úèÔ∏è  ${categorizacao.sugestao}`;\n        }\n        mensagem += ` | üîç Revis√£o manual obrigat√≥ria`;\n      }\n\n      // Verifica se regra est√° suprimida para este arquivo\n      if (shouldSuppressOccurrence('tipo-inseguro-unknown', relPath)) {\n        continue;\n      }\n      ocorrencias.push({\n        tipo: 'tipo-inseguro-unknown',\n        nivel,\n        mensagem,\n        relPath,\n        linha,\n        contexto: lineContext\n      });\n    }\n    return ocorrencias;\n  }\n};\nexport default ANALISTA;\n"]}