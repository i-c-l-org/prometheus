{"version":3,"file":"inquisidor.js","sourceRoot":"","sources":["../../../src/core/execution/inquisidor.ts"],"names":[],"mappings":"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","sourcesContent":["// SPDX-License-Identifier: MIT\n// @prometheus-disable PROBLEMA_PERFORMANCE\n// Justificativa: inquisidor principal que processa an√°lise de c√≥digo - loops s√£o esperados\nimport { promises as fs } from 'node:fs';\n\nimport { config } from '@core/config/config.js';\nimport { isMetaPath } from '@core/config/paths.js';\nimport { InquisidorMensagens } from '@core/messages/core/inquisidor-messages.js';\nimport { log } from '@core/messages/index.js';\nimport { lerEstado } from '@shared/persistence/persistencia.js';\nimport * as path from 'path';\n\nimport type { CacheValor, EstadoIncArquivo, FileEntry, FileEntryWithAst, InquisicaoOptions, MetricasGlobais, OcorrenciaParseErro, ReporterFn,ResultadoInquisicaoCompleto, SimbolosLog, Tecnica } from '@';\nimport { ocorrenciaParseErro } from '@';\n\nimport { executarInquisicao as executarExecucao, registrarUltimasMetricas } from './executor.js';\nimport { scanRepository } from './scanner.js';\n// Fallback de s√≠mbolos para cen√°rios de teste onde o mock de log n√£o inclui `simbolos`.\nconst SIMBOLOS_ALTERNATIVA: SimbolosLog = {\n  info: '‚ÑπÔ∏è',\n  sucesso: '‚úÖ',\n  erro: '‚ùå',\n  aviso: '‚ö†Ô∏è',\n  debug: 'üêû',\n  fase: 'üî∂',\n  passo: '‚ñ´Ô∏è',\n  scan: 'üîç',\n  guardian: 'üõ°Ô∏è',\n  pasta: 'üìÇ'\n};\nconst S: SimbolosLog = typeof (log as unknown as {\n  simbolos?: SimbolosLog;\n}).simbolos === 'object' ? (log as unknown as {\n  simbolos: SimbolosLog;\n}).simbolos : SIMBOLOS_ALTERNATIVA;\n// Fallback seguro para infoDestaque quando mocks de teste n√£o exp√µem o m√©todo\nconst __infoDestaque = (mensagem: string) => {\n  const l = log as unknown as {\n    infoDestaque?: (m: string) => void;\n    info: (m: string) => void;\n  };\n  if (typeof l.infoDestaque === 'function') return l.infoDestaque(mensagem);\n  return l.info(mensagem);\n};\n\n// Extens√µes consideradas para tentativa de AST. Observa√ß√µes:\n// - .d.ts √© propositalmente exclu√≠da pelo parser (retorna null) e aqui n√£o entra.\n// - .map (source maps) n√£o deve ser parseado ‚Äì marcamos como N√ÉO pertencente ao conjunto.\nconst EXTENSOES_COM_AST = new Set(\n  Array.isArray(config.SCANNER_EXTENSOES_COM_AST)\n    ? config.SCANNER_EXTENSOES_COM_AST\n    : ['.js', '.jsx', '.ts', '.tsx', '.mjs', '.cjs'],\n);\nexport async function prepararComAst(\n  entries: FileEntry[],\n  baseDir: string,\n): Promise<FileEntryWithAst[]> {\n  // Cache em mem√≥ria (process-level). Chave: relPath\n  // Guarda: { mtimeMs, size, ast } - tipo importado de @types\n  const globalStore = globalThis as unknown as Record<string, unknown>;\n  const cache: Map<string, CacheValor> = globalStore.__PROMETHEUS_AST_CACHE__ as Map<string, CacheValor> || new Map();\n  if (!globalStore.__PROMETHEUS_AST_CACHE__) globalStore.__PROMETHEUS_AST_CACHE__ = cache;\n  const metricas: MetricasGlobais = globalStore.__PROMETHEUS_METRICAS__ as MetricasGlobais || {\n    parsingTimeMs: 0,\n    cacheHits: 0,\n    cacheMiss: 0\n  };\n  // Reset m√©tricas de parsing a cada prepara√ß√£o completa\n  metricas.parsingTimeMs = 0;\n  metricas.cacheHits = 0;\n  metricas.cacheMiss = 0;\n  globalStore.__PROMETHEUS_METRICAS__ = metricas;\n  return Promise.all(entries.map(async (entry): Promise<FileEntryWithAst> => {\n    let ast: import('@babel/traverse').NodePath<import('@babel/types').Node> | undefined = undefined;\n    const ext = path.extname(entry.relPath);\n    const absCaminho = typeof entry.fullCaminho === 'string' ? entry.fullCaminho : path.resolve(baseDir, entry.relPath);\n    let stats: import('node:fs').Stats | undefined;\n    try {\n      stats = await fs.stat(absCaminho);\n    } catch {\n      stats = undefined;\n    }\n\n    // Detec√ß√£o de extens√£o com suporte a sufixos compostos (ex.: .d.ts, .js.map)\n    const nomeLower = entry.relPath.toLowerCase();\n    const extEfetiva = nomeLower.endsWith('.d.ts') ? '.d.ts' : nomeLower.endsWith('.map') ? '.map' : ext;\n    if (entry.content && EXTENSOES_COM_AST.has(extEfetiva)) {\n      const chave = entry.relPath;\n      if (config.ANALISE_AST_CACHE_ENABLED && stats) {\n        const anterior = cache.get(chave);\n        if (anterior && anterior.mtimeMs === stats.mtimeMs && anterior.size === stats.size) {\n          // Se o cache tinha AST v√°lida, reutiliza; caso contr√°rio, mant√©m undefined para obrigar tentative parsing novamente.\n          ast = anterior.ast;\n          metricas.cacheHits++;\n        }\n      }\n      try {\n        if (!ast) {\n          const inicioParse = performance.now();\n          // Usa a API decifrarSintaxe esperada pelos testes (com spies)\n          const parsed = await import('@core/parsing/parser.js').then(m => m.decifrarSintaxe(entry.content || '', extEfetiva, {\n            relPath: entry.relPath\n          }));\n          if (parsed && typeof parsed === 'object') {\n            // Mant√©m ast undefined quando parsed √© objeto vazio (forma inv√°lida)\n            if (Object.keys(parsed as unknown as Record<string, unknown>).length > 0) {\n              // Sentinel convertida para o tipo NodePath via unknown cast ‚Äì suficiente para diferenciar truthy\n              ast = {} as unknown as import('@babel/traverse').NodePath<import('@babel/types').Node>;\n            }\n          } else if (parsed == null) {\n            // Politica: para arquivos em node_modules, n√£o tratar falha de parsing como erro;\n            // em vez disso, seguimos com um sentinel de AST para permitir analistas que n√£o dependem de AST completa.\n            const inNodeModules = /(^|\\/)node_modules(\\/|\\\\)/.test(entry.relPath);\n            if (inNodeModules) {\n              ast = {} as unknown as import('@babel/traverse').NodePath<import('@babel/types').Node>;\n            } else {\n              // Tentar extrair linha/coluna do parser executando uma parse r√°pida\n              // que lan√ßa uma exce√ß√£o com informa√ß√£o de localiza√ß√£o (quando dispon√≠vel).\n              const globalStore2 = globalStore as unknown as Record<string, unknown>;\n              const lista = globalStore2.__PROMETHEUS_PARSE_ERROS__ as OcorrenciaParseErro[] | undefined || [];\n              try {\n                // Importar babel parser diretamente e for√ßar parse para capturar erro com loc\n                const babel = await import('@babel/parser');\n                try {\n                  // tentativa intencional para capturar a exce√ß√£o com posi√ß√£o\n                  const parseOpts = {\n                    sourceType: 'unambiguous',\n                    plugins: ['typescript', 'jsx', 'decorators-legacy', 'classProperties']\n                  };\n                  babel.parse(entry.content || '', parseOpts as unknown as import('@babel/parser').ParserOptions);\n                  // se por algum motivo n√£o lan√ßar, registra erro gen√©rico\n                  lista.push(ocorrenciaParseErro({\n                    mensagem: InquisidorMensagens.parseAstNaoGerada,\n                    relPath: entry.relPath,\n                    origem: 'parser'\n                  }));\n                } catch (e) {\n                  type ParserErrorLike = {\n                    loc?: {\n                      line?: number;\n                      column?: number;\n                    };\n                    message?: string;\n                  };\n                  const err = e as unknown as ParserErrorLike;\n                  const linha = typeof err.loc?.line === 'number' ? err.loc.line : undefined;\n                  const coluna = typeof err.loc?.column === 'number' ? err.loc.column : undefined;\n                  const detalhe = err && err.message ? String(err.message) : undefined;\n                  lista.push(ocorrenciaParseErro({\n                    mensagem: InquisidorMensagens.parseErro(detalhe || InquisidorMensagens.parseAstNaoGerada),\n                    relPath: entry.relPath,\n                    origem: 'parser',\n                    linha,\n                    coluna,\n                    detalhe\n                  }));\n                }\n              } catch {\n                // Se n√£o conseguimos importar/usar o babel parser, fallback para mensagem gen√©rica\n                lista.push(ocorrenciaParseErro({\n                  mensagem: InquisidorMensagens.parseAstNaoGerada,\n                  relPath: entry.relPath,\n                  origem: 'parser'\n                }));\n              }\n              globalStore2.__PROMETHEUS_PARSE_ERROS__ = lista;\n            }\n          }\n          metricas.parsingTimeMs += performance.now() - inicioParse;\n          metricas.cacheMiss++;\n          if (config.ANALISE_AST_CACHE_ENABLED && stats) {\n            cache.set(entry.relPath, {\n              mtimeMs: stats.mtimeMs,\n              size: stats.size,\n              ast\n            });\n          }\n        }\n      } catch (e) {\n        const err = e as Error;\n        log.erro(InquisidorMensagens.falhaGerarAst(entry.relPath, err.message));\n        // Registra ocorr√™ncia de parse erro\n        const lista = globalStore.__PROMETHEUS_PARSE_ERROS__ as OcorrenciaParseErro[] | undefined || [];\n        lista.push(ocorrenciaParseErro({\n          mensagem: InquisidorMensagens.parseErro(err.message),\n          relPath: entry.relPath,\n          origem: 'parser'\n        }));\n        globalStore.__PROMETHEUS_PARSE_ERROS__ = lista;\n      }\n    }\n    return {\n      ...entry,\n      ast,\n      content: entry.content ?? null,\n      fullCaminho: typeof entry.fullCaminho === 'string' ? entry.fullCaminho : path.resolve(baseDir, entry.relPath)\n    } as FileEntryWithAst;\n  }));\n}\nexport async function iniciarInquisicao(\n  baseDir: string = process.cwd(),\n  options: InquisicaoOptions = {},\n  tecnicas?: Tecnica[],\n  /** Opcional: repassa op√ß√µes para o executor (events/reporter/fast/verbose) */\n  executorOpts?: {\n    events?: import('./executor.js').ExecutorEventEmitter;\n    reporter?: ReporterFn;\n    verbose?: boolean;\n    compact?: boolean;\n    fast?: boolean;\n  }\n): Promise<ResultadoInquisicaoCompleto> {\n  const {\n    includeContent = true,\n    incluirMetadados = true,\n    skipExec = false\n  } = options;\n  log.info(`${S.scan} ${InquisidorMensagens.iniciando(baseDir)}`);\n  const fileMap = await scanRepository(baseDir, {\n    includeContent,\n    onProgress: msg => {\n      // S√≥ exibe diret√≥rios e erros, e em formato leg√≠vel por m√°quina/pessoa\n      try {\n        const progressData = JSON.parse(msg);\n        if (progressData.tipo === 'diretorio') {\n          // Atualiza contador e amostra em mem√≥ria, sem emitir logs incrementais.\n          // A pol√≠tica sem√¢ntica correta: n√£o mostrar progresso parcial durante a varredura;\n          // em vez disso, exibimos apenas um resumo final ap√≥s a conclus√£o da varredura.\n          const g = globalThis as unknown as {\n            __PROMETHEUS_DIR_COUNT__?: number;\n            __PROMETHEUS_DIR_SAMPLES__?: string[];\n          };\n          g.__PROMETHEUS_DIR_COUNT__ = (g.__PROMETHEUS_DIR_COUNT__ || 0) + 1;\n          // Armazena primeiros N diret√≥rios como amostra para diagn√≥stico posterior\n          const SAMPLE_MAX = 5;\n          if (!g.__PROMETHEUS_DIR_SAMPLES__) g.__PROMETHEUS_DIR_SAMPLES__ = [];\n          if (g.__PROMETHEUS_DIR_SAMPLES__.length < SAMPLE_MAX) {\n            g.__PROMETHEUS_DIR_SAMPLES__.push(progressData.caminho);\n          }\n          // contador atualizado em g.__PROMETHEUS_DIR_COUNT__ (n√£o usado diretamente aqui)\n          // Em modo verbose original poder√≠amos mostrar mais detalhes, mas por padr√£o\n          // evitamos ru√≠do progressivo. Erros continuam sendo reportados abaixo.\n        } else if (progressData.tipo === 'erro') {\n          log.erro(InquisidorMensagens.erroAcaoCaminho(progressData.acao, progressData.caminho, progressData.mensagem));\n        }\n      } catch {\n        // fallback para logs antigos\n        if (msg && msg.includes('‚ö†Ô∏è')) log.aviso(msg);\n      }\n    }\n  });\n  let fileEntries: FileEntryWithAst[];\n  let entriesBase = Object.values(fileMap);\n  // Filtra arquivos meta com helper central: tudo fora de src/ √© meta por padr√£o\n  const metaSet = new Set(entriesBase.filter(e => isMetaPath(e.relPath)).map(e => e.relPath));\n  // Prioriza√ß√£o (usa estado incremental anterior somente para ordenar)\n  if (config.ANALISE_PRIORIZACAO_ENABLED && config.ANALISE_INCREMENTAL_STATE_PATH) {\n    try {\n      type EstadoIncremental = {\n        arquivos: Record<string, EstadoIncArquivo>;\n      };\n      const inc = await lerEstado<EstadoIncremental>(config.ANALISE_INCREMENTAL_STATE_PATH).catch(() => null);\n      if (inc && inc.arquivos) {\n        const pesos = (config.ANALISE_PRIORIZACAO_PESOS || {\n          duracaoMs: 1,\n          ocorrencias: 2,\n          penalidadeReuso: 0.5\n        }) as {\n          duracaoMs: number;\n          ocorrencias: number;\n          penalidadeReuso: number;\n        };\n        const scored = entriesBase.map(e => {\n          const hist = inc.arquivos[e.relPath];\n          if (!hist) return {\n            ...e,\n            __score: 0\n          } as FileEntry & {\n            __score: number;\n          };\n          let dur = 0;\n          let occ = 0;\n          if (hist.analistas) {\n            for (const a of Object.values(hist.analistas)) {\n              dur += a.duracaoMs;\n              occ += a.ocorrencias;\n            }\n          } else {\n            occ = hist.ocorrencias?.length || 0;\n          }\n          const reuso = hist.reaproveitadoCount || 0;\n          const score = dur * pesos.duracaoMs + occ * pesos.ocorrencias - reuso * pesos.penalidadeReuso;\n          return {\n            ...e,\n            __score: score\n          } as FileEntry & {\n            __score: number;\n          };\n        });\n        scored.sort((a, b) => (b as unknown as {\n          __score: number;\n        }).__score - (a as unknown as {\n          __score: number;\n        }).__score);\n        // Reorganiza empurrando meta para o final\n        const prioritarios: (FileEntry & {\n          __score: number;\n        })[] = [];\n        const metas: (FileEntry & {\n          __score: number;\n        })[] = [];\n        for (const s of scored) (metaSet.has(s.relPath) ? metas : prioritarios).push(s);\n        const reconstituido = [...prioritarios, ...metas];\n        entriesBase = reconstituido as unknown as typeof entriesBase;\n        const somentePrioritarios = reconstituido.filter(e => !metaSet.has(e.relPath));\n        if (config.LOG_ESTRUTURADO) {\n          log.info(JSON.stringify({\n            tipo: 'priorizacao',\n            estrategia: 'historico-incremental',\n            top: somentePrioritarios.slice(0, 10).map(e => ({\n              arq: e.relPath,\n              score: (e as unknown as {\n                __score: number;\n              }).__score\n            })),\n            metaEmpurrados: metas.length\n          }));\n        } else {\n          const exibidos = somentePrioritarios.slice(0, 5).map(e => e.relPath).join(', ') || '‚Äî';\n          log.info(InquisidorMensagens.priorizacaoAplicada(exibidos));\n          if (metas.length) {\n            log.info(InquisidorMensagens.arquivosMetaMovidos(metas.length));\n          }\n        }\n      }\n    } catch (e) {\n      if (config.DEV_MODE) log.erro(InquisidorMensagens.falhaPriorizacao((e as Error).message));\n    }\n  }\n  if (incluirMetadados) {\n    fileEntries = await prepararComAst(entriesBase, baseDir);\n  } else {\n    fileEntries = entriesBase.map(entry => ({\n      ...entry,\n      ast: undefined,\n      fullCaminho: typeof entry.fullCaminho === 'string' ? entry.fullCaminho : path.resolve(baseDir, entry.relPath)\n    }));\n  }\n\n  // Exibe um resumo √∫nico da varredura preliminar, imediatamente antes da an√°lise principal.\n  try {\n    const g = globalThis as unknown as {\n      __PROMETHEUS_DIR_COUNT__?: number;\n      __PROMETHEUS_DIR_SAMPLES__?: string[];\n    };\n    const totalDirs = g.__PROMETHEUS_DIR_COUNT__ || 0;\n    // N√£o exibir caminhos nem moldura ‚Äî apenas resumo simples em texto.\n    const amostra = Array.isArray(g.__PROMETHEUS_DIR_SAMPLES__) ? g.__PROMETHEUS_DIR_SAMPLES__ : [];\n    if (config.LOG_ESTRUTURADO) {\n      log.info(JSON.stringify({\n        tipo: 'varredura_preliminar',\n        totalDiretorios: totalDirs,\n        amostraDiretorios: amostra\n      }));\n    } else {\n      // Em modo simples, n√£o emite resumo redundante\n      // A mensagem \"‚úÖ Varredura conclu√≠da: X arquivos em Y diret√≥rios\" j√° cobre isso\n    }\n  } catch {\n    /* ignore */\n  }\n\n  // Agora fileEntries √© FileEntryWithAst[]\n  let totalArquivos = fileEntries.length;\n  let ocorrencias: Array<OcorrenciaParseErro | import('@').Ocorrencia> = [];\n  if (!skipExec) {\n    // Invers√£o de Controle: tecnicas devem ser fornecidas pelo chamador sempre que skipExec=false.\n    // For√ßar inje√ß√£o quando execu√ß√£o real √© necess√°ria.\n    let tecnicasEfetivas = tecnicas;\n    if (!tecnicasEfetivas && !skipExec) {\n      throw new Error('iniciarInquisicao: tecnicas devem ser fornecidas pelo chamador quando skipExec=false');\n    }\n    if (!tecnicasEfetivas) tecnicasEfetivas = [] as Tecnica[];\n    const execRes = await executarExecucao(\n      fileEntries,\n      tecnicasEfetivas,\n      baseDir,\n      undefined,\n      {\n        verbose: executorOpts?.verbose ?? config.VERBOSE,\n        compact: executorOpts?.compact ?? config.COMPACT_MODE,\n        fast: executorOpts?.fast,\n        events: executorOpts?.events,\n        reporter: executorOpts?.reporter\n      }\n    );\n    totalArquivos = execRes.totalArquivos;\n    ocorrencias = execRes.ocorrencias;\n  }\n\n  // Anexa ocorr√™ncias de parse se existirem\n  const parseErros: OcorrenciaParseErro[] = (globalThis as unknown as Record<string, unknown>).__PROMETHEUS_PARSE_ERROS__ as OcorrenciaParseErro[] || [];\n  if (parseErros.length) {\n    // Armazena contagem original para m√©tricas (usado em sa√≠da JSON)\n    (globalThis as unknown as {\n      __PROMETHEUS_PARSE_ERROS_ORIGINAIS__?: number;\n    }).__PROMETHEUS_PARSE_ERROS_ORIGINAIS__ = parseErros.length;\n    if (config.PARSE_ERRO_AGRUPAR) {\n      const porArquivo: Record<string, OcorrenciaParseErro[]> = {};\n      for (const pe of parseErros) {\n        const k = pe.relPath || '__desconhecido__';\n        (porArquivo[k] = porArquivo[k] || []).push(pe);\n      }\n      for (const [arq, lista] of Object.entries(porArquivo)) {\n        if (lista.length <= (config.PARSE_ERRO_MAX_POR_ARQUIVO || 1)) {\n          ocorrencias.push(...lista);\n        } else {\n          // Consolida em uma √∫nica ocorr√™ncia representativa\n          ocorrencias.push(ocorrenciaParseErro({\n            mensagem: InquisidorMensagens.parseErrosAgregados(lista.length),\n            relPath: arq || '',\n            origem: 'parser'\n          }));\n        }\n      }\n    } else {\n      ocorrencias.push(...parseErros);\n    }\n  }\n  if (!skipExec) {\n    log.sucesso(InquisidorMensagens.concluida(ocorrencias.length));\n  } else if (!config.COMPACT_MODE) {\n    __infoDestaque(InquisidorMensagens.varreduraConcluida(fileEntries.length));\n  }\n  return {\n    totalArquivos,\n    ocorrencias,\n    arquivosAnalisados: fileEntries.map(f => f.relPath),\n    timestamp: Date.now(),\n    duracaoMs: 0,\n    fileEntries,\n    guardian: undefined\n  };\n}\nexport { executarExecucao as executarInquisicao, registrarUltimasMetricas };"]}