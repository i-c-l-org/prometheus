{"version":3,"file":"type-safety.js","sourceRoot":"","sources":["../../../../src/types/analistas/corrections/type-safety.ts"],"names":[],"mappings":"","sourcesContent":["// SPDX-License-Identifier: MIT\n/**\n * Tipos para sistema de Type Safety Auto-Fix\n * Suporta análise e correção inteligente de tipos `any` e `unknown`\n */\n\nimport type { Node } from '@babel/types';\n\n/**\n * Tipo auxiliar para nós AST com propriedades específicas\n */\nexport interface ASTNode {\n  type?: string;\n  name?: string;\n  object?: ASTNode;\n  property?: ASTNode;\n  callee?: ASTNode;\n  value?: unknown;\n  loc?: {\n    start?: {\n      line?: number;\n      column?: number;\n    };\n  };\n  [key: string]: unknown;\n}\nexport interface TypeAnalysis {\n  /** Confiança na inferência do tipo (0-100) */\n  confidence: number;\n\n  /** Tipo inferido a partir da análise */\n  inferredTipo: string;\n\n  /** Se é tipo primitivo (string, number, boolean, etc) */\n  isSimpleType: boolean;\n\n  /** Nome do tipo se for interface/type complexo */\n  typeName: string;\n\n  /** Definição completa do tipo (para criação de arquivo) */\n  typeDefinition: string;\n\n  /** Caminho sugerido para criar o tipo (ex: 'analistas/dados-padroes.ts') */\n  suggestedPath: string;\n\n  /** Sugestão adicional para o usuário */\n  suggestion?: string;\n\n  /** Se criou novo tipo */\n  createdNewType?: boolean;\n\n  /** Se requer import */\n  requiresImport?: boolean;\n}\nexport interface UsagePattern {\n  /** Todos os usos são de string */\n  allUsagesAreString: boolean;\n\n  /** Todos os usos são de number */\n  allUsagesAreNumber: boolean;\n\n  /** Todos os usos são de boolean */\n  allUsagesAreBoolean: boolean;\n\n  /** Tem estrutura de objeto com propriedades acessadas */\n  hasObjectStructure: boolean;\n\n  /** Propriedades acessadas no objeto */\n  objectProperties?: PropertyUsage[];\n\n  /** Tem type guards (typeof, instanceof, in, etc) */\n  hasTypeGuards: boolean;\n\n  /** Type guards encontrados */\n  typeGuards?: TypeGuard[];\n\n  /** É usado como função */\n  isFunction: boolean;\n\n  /** É usado como array */\n  isArray: boolean;\n\n  /** Tipos encontrados em uniões */\n  unionTypes?: string[];\n}\nexport interface PropertyUsage {\n  /** Nome da propriedade */\n  name: string;\n\n  /** Tipo inferido da propriedade */\n  inferredTipo: string;\n\n  /** Confiança na inferência */\n  confidence: number;\n\n  /** É opcional (não usado sempre) */\n  isOptional: boolean;\n\n  /** Métodos chamados nesta propriedade */\n  methodsCalled?: string[];\n}\nexport interface TypeGuard {\n  /** Tipo do guard (typeof, instanceof, in, custom) */\n  type: 'typeof' | 'instanceof' | 'in' | 'custom';\n\n  /** Expressão do type guard */\n  expression: string;\n\n  /** Tipo inferido do guard */\n  inferredTipo: string;\n\n  /** Confiança no guard */\n  confidence: number;\n}\nexport interface InferredInterface {\n  /** Nome da interface */\n  name: string;\n\n  /** Definição TypeScript da interface */\n  definition: string;\n\n  /** Confiança na inferência */\n  confidence: number;\n\n  /** Propriedades da interface */\n  properties: PropertyUsage[];\n}\nexport interface TypeReplacementValidation {\n  /** Se o tipo é compatível com os usos */\n  isCompatible: boolean;\n\n  /** Tipo esperado baseado em uso */\n  expectedType: string;\n\n  /** Erros de compilação TypeScript */\n  errors: string[];\n\n  /** Avisos */\n  warnings: string[];\n}\nexport interface AdditionalChange {\n  /** Tipo de mudança adicional */\n  type: 'add-import' | 'create-type-file' | 'update-index' | 'add-type-guard';\n\n  /** Conteúdo da mudança */\n  content: string;\n\n  /** Caminho do arquivo afetado (para create-type-file) */\n  path?: string;\n}\nexport interface TypeSafetyWarning {\n  /** Tipo do aviso */\n  type: 'type-suggestion' | 'unsafe-type' | 'keep-unknown' | 'duplicate-type';\n\n  /** Mensagem do aviso */\n  message: string;\n\n  /** Sugestão para o usuário */\n  suggestion: string;\n\n  /** Confiança da análise */\n  confidence?: number;\n\n  /** Requer revisão manual */\n  needsManualReview?: boolean;\n\n  /** Caminho do arquivo com tipo conflitante */\n  conflictingTypePath?: string;\n}\nexport interface QuickFixResult {\n  /** Código modificado */\n  code: string;\n\n  /** Mudanças adicionais necessárias */\n  additionalChanges?: AdditionalChange[];\n\n  /** Avisos gerados */\n  warnings?: TypeSafetyWarning[];\n\n  /** Se a correção foi aplicada */\n  applied?: boolean;\n\n  /** Motivo de não aplicação */\n  reason?: string;\n}\nexport interface VariableUsage {\n  /** Nome da variável */\n  name: string;\n\n  /** Tipo do nó AST */\n  nodeType: string;\n\n  /** Linha no código */\n  line: number;\n\n  /** Coluna no código */\n  column: number;\n\n  /** Contexto ao redor */\n  context: string;\n\n  /** Operação realizada (call, access, assignment, etc) */\n  operation: 'call' | 'access' | 'assignment' | 'comparison' | 'return' | 'argument';\n\n  /** Propriedade acessada (se aplicável) */\n  property?: string;\n\n  /** Método chamado (se aplicável) */\n  method?: string;\n\n  /** Argumento de função (se aplicável) */\n  argumentIndex?: number;\n}\nexport interface TypeInferenceContext {\n  /** Arquivo sendo analisado */\n  fileCaminho: string;\n\n  /** Domínio do arquivo (analistas, cli, core, etc) */\n  domain: string;\n\n  /** Se é arquivo TypeScript */\n  isTypeScript: boolean;\n\n  /** Se é arquivo de definição (.d.ts) */\n  isDefinitionFile: boolean;\n\n  /** Se é arquivo legado */\n  isLegacy: boolean;\n\n  /** AST do arquivo (Babel Node) */\n  ast: Node | null;\n\n  /** Código completo */\n  code: string;\n}\nexport interface ExistingType {\n  /** Nome do tipo */\n  name: string;\n\n  /** Caminho do arquivo */\n  path: string;\n\n  /** Definição do tipo */\n  definition: string;\n\n  /** Se é tipo exportado */\n  isExported: boolean;\n\n  /** Domínio do tipo */\n  domain: string;\n}\n\n/**\n * Categorização de uso de unknown\n */\nexport interface CategorizacaoUnknown {\n  categoria: 'legitimo' | 'melhoravel' | 'corrigir';\n  confianca: number;\n  motivo: string;\n  sugestao?: string;\n  variantes?: string[]; // Possibilidades alternativas quando análise é incerta\n}"]}