{"version":3,"file":"hash.js","sourceRoot":"","sources":["../../src/guardian/hash.ts"],"names":[],"mappings":"AACA,OAAO,EAAE,UAAU,EAAE,SAAS,EAAE,MAAM,aAAa,CAAC;AAIpD,OAAO,EAAE,cAAc,EAAE,MAAM,iBAAiB,CAAC;AAMjD,MAAM,UAAU,YAAY,CAAC,QAAgB;IAC3C,MAAM,UAAU,GAAG,CAAC,cAAc,EAAE,QAAQ,EAAE,MAAM,EAAE,KAAK,CAAC,CAAC;IAC7D,MAAM,WAAW,GAAG,IAAI,GAAG,CAAC,SAAS,EAAE,CAAC,CAAC;IACzC,KAAK,MAAM,GAAG,IAAI,UAAU,EAAE,CAAC;QAC7B,IAAI,CAAC;YACH,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,GAAG,CAAC;gBAAE,SAAS;YACpC,OAAO,UAAU,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;QACxD,CAAC;QAAC,MAAM,CAAC;QAET,CAAC;IACH,CAAC;IAED,IAAI,IAAI,GAAG,CAAC,CAAC;IACb,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,QAAQ,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;QACzC,IAAI,GAAG,CAAC,IAAI,GAAG,EAAE,GAAG,QAAQ,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC;IACpD,CAAC;IACD,OAAO,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC,QAAQ,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC;AAC5C,CAAC;AASD,MAAM,UAAU,uBAAuB,CAAC,QAAgB;IACtD,MAAM,MAAM,GAAG,QAAQ,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;IACpC,MAAM,QAAQ,GAAoB;QAChC,IAAI,EAAE,YAAY,CAAC,QAAQ,CAAC;QAC5B,MAAM,EAAE,MAAM,CAAC,MAAM;QACrB,OAAO,EAAE,MAAM,CAAC,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC,EAAE,GAAG,CAAC,IAAI,EAAE;KACxC,CAAC;IACF,OAAO,QAAQ,CAAC,IAAI,CAAC;AACvB,CAAC","sourcesContent":["// SPDX-License-Identifier: MIT\nimport { createHash, getHashes } from 'node:crypto';\n\nimport type { SnapshotArquivo } from '@';\n\nimport { ALGORITMO_HASH } from './constantes.js';\n\n/**\n * Gera um hash hexadecimal a partir do conte�do fornecido.\n */\n\nexport function gerarHashHex(conteudo: string): string {\n  const candidatos = [ALGORITMO_HASH, 'sha256', 'sha1', 'md5'];\n  const disponiveis = new Set(getHashes());\n  for (const alg of candidatos) {\n    try {\n      if (!disponiveis.has(alg)) continue; // ignora n�o suportados no runtime\n      return createHash(alg).update(conteudo).digest('hex');\n    } catch {\n      // tenta pr�ximo\n    }\n  }\n  // Fallback ultra simples (n�o criptogr�fico) � evita exception ruidosa\n  let hash = 0;\n  for (let i = 0; i < conteudo.length; i++) {\n    hash = (hash * 31 + conteudo.charCodeAt(i)) >>> 0;\n  }\n  return hash.toString(16).padStart(8, '0');\n}\n\n/**\n * Gera um snapshot do conteúdo incluindo:\n * - Hash de integridade\n * - Número de linhas\n * - Amostra textual do início do arquivo\n */\n\nexport function gerarSnapshotDoConteudo(conteudo: string): string {\n  const linhas = conteudo.split('\\n');\n  const snapshot: SnapshotArquivo = {\n    hash: gerarHashHex(conteudo),\n    linhas: linhas.length,\n    amostra: linhas[0]?.slice(0, 200) ?? '',\n  };\n  return snapshot.hash;\n}\n"]}