{"version":3,"file":"processamento-diagnostico.js","sourceRoot":"","sources":["../../src/cli/processamento-diagnostico.ts"],"names":[],"mappings":"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","sourcesContent":["// SPDX-License-Identifier: MIT-0\n// @prometheus-disable PROBLEMA_PERFORMANCE\n// Justificativa: processamento de diagnstico que varre dados - loops so esperados\nimport fs from 'node:fs';\nimport path from 'node:path';\n\nimport { detectarArquetipos } from '@analistas/detectores/detector-arquetipos.js';\nimport { normalizarOcorrenciaParaJson } from '@cli/diagnostico/normalizar-ocorrencias-json.js';\nimport { exibirBlocoFiltros, listarAnalistas } from '@cli/processing/display.js';\nimport { configurarFiltros, expandIncludes, processPatternGroups, processPatternListAchatado } from '@cli/processing/filters.js';\nimport chalk from '@core/config/chalk-safe.js';\nimport { config } from '@core/config/config.js';\nimport { executarInquisicao, iniciarInquisicao, prepararComAst, registrarUltimasMetricas } from '@core/execution/inquisidor.js';\nimport { CliProcessamentoDiagnosticoMensagens } from '@core/messages/cli/cli-processamento-diagnostico-messages.js';\nimport { ExcecoesMensagens } from '@core/messages/core/excecoes-messages.js';\nimport { log, logGuardian, logRelatorio, logSistema, MENSAGENS_AUTOFIX } from '@core/messages/index.js';\nimport { aplicarSupressaoOcorrencias } from '@core/parsing/filters.js';\nimport { scanSystemIntegrity } from '@guardian/sentinela.js';\nimport { emitirConselhoPrometheus } from '@relatorios/conselheiro-prometheus.js';\nimport { gerarRelatorioMarkdown } from '@relatorios/gerador-relatorio.js';\nimport fragmentarRelatorio from '@shared/data-processing/fragmentar-relatorio.js';\nimport { stringifyJsonEscaped } from '@shared/data-processing/json.js';\nimport { dedupeOcorrencias } from '@shared/data-processing/ocorrencias.js';\n\n// Importar tipos centralizados (consolidado)\nimport { asTecnicas, converterResultadoGuardian, type FileEntry, type FileEntryWithAst, type FiltrosConfig, IntegridadeStatus, type LinguagensJson, type LogExtensions, type OpcoesProcessamentoDiagnostico, type ParseErrosJson, type ResultadoGuardian, type ResultadoInquisicaoCompleto, type ResultadoProcessamentoDiagnostico, type SaidaJsonDiagnostico } from '@';\n\n// Persistncia: usar helper centralizado, mas com resolver dinmico para compat com mocks de teste\nlet salvarEstado: (caminho: string, dados: unknown) => Promise<void>;\nasync function getSalvarEstado(): Promise<(caminho: string, dados: unknown) => Promise<void>> {\n  if (salvarEstado) return salvarEstado;\n  // Em testes, permitir mock do path .ts para compatibilidade com Vitest\n  const candidates = process.env.VITEST ? ['@shared/persistence/persistencia.js', '@shared/persistence/persistencia.ts'] : ['@shared/persistence/persistencia.js'];\n  for (const p of candidates) {\n    try {\n      const mod = await import(p as string).catch(() => undefined as Record<string, unknown> | undefined);\n      if (mod && typeof mod.salvarEstado === 'function') {\n        salvarEstado = mod.salvarEstado as (c: string, d: unknown) => Promise<void>;\n        break;\n      }\n    } catch { }\n  }\n\n  // Fallback: importar pelo alias oficial\n  if (!salvarEstado) {\n    const mod = await import('@shared/persistence/persistencia.js');\n    salvarEstado = (mod as {\n      salvarEstado: (c: string, d: unknown) => Promise<void>;\n    }).salvarEstado;\n  }\n  return salvarEstado;\n}\n// Reexports para compatibilidade com testes que importam utilitrios diretamente deste mdulo\nexport { configurarFiltros, getDefaultExcludes } from '@cli/processing/filters.js';\n// registroAnalistas ser importado dinamicamente quando necessrio\n\n// Helpers deduplicao/agrupamento: agora centralizados em @shared/data-processing/ocorrencias\n\n// Constante para timeout de deteco de arqutipos (em milissegundos)\nconst DETECTAR_TEMPO_LIMITE_MS = process.env.VITEST ? 1000 : 30000;\n\n// Helper: deteco de arqutipos com timeout e absoro de rejeies\n\nasync function detectarArquetiposComTimeout(ctx: Parameters<typeof detectarArquetipos>[0], baseDir: Parameters<typeof detectarArquetipos>[1], options?: {\n  quiet?: boolean;\n}): Promise<Awaited<ReturnType<typeof detectarArquetipos>> | undefined> {\n  try {\n    const detectPromise = detectarArquetipos(ctx, baseDir, options).catch(e => {\n      // Em DEV_MODE, registra erro explcito\n      try {\n        if (config.DEV_MODE && typeof (log as {\n          erro?: Function;\n        }).erro === 'function') {\n          const msg = e instanceof Error ? e.message : String(e);\n          (log as {\n            erro: Function;\n          }).erro(`Falha detector arquetipos: ${msg}`);\n        }\n      } catch { }\n      return undefined;\n    });\n    const timeoutPromise = new Promise<undefined>(resolve => setTimeout(() => resolve(undefined), DETECTAR_TEMPO_LIMITE_MS));\n    return (await Promise.race([detectPromise, timeoutPromise])) as Awaited<ReturnType<typeof detectarArquetipos>> | undefined;\n  } catch {\n    return undefined;\n  }\n}\n\n// Utilitrios para processamento de filtros\n\n// Hook de teste: permite injetar uma ocorrncia sinttica mnima para\n// exercitar ramos de exportao e despedida sem custo alto de anlise.\n\n// Expanso de includes: aceita diretrios sem curingas\n\n// Funo para obter padres de excluso padro do config\n// Funo auxiliar para detectar o tipo de projeto (simplificada)\n\n// Funo para configurar filtros no config global\n\n// Funo auxiliar para sincronizar arrays de excluso\n\n// Funo para exibir bloco de filtros (verbose)\n\n// Funo principal de processamento do diagnstico\n\nexport async function processarDiagnostico(opts: OpcoesProcessamentoDiagnostico): Promise<ResultadoProcessamentoDiagnostico> {\n  // Configurar flags globais\n  config.GUARDIAN_ENABLED = opts.guardianCheck ?? false;\n  // Novo comportamento: --full ativa verbose, padro  compacto/resumido\n  config.VERBOSE = opts.full ?? false;\n  // Compacto: respeita --compact explcito; por padro  o inverso de --full\n  if ((opts as unknown as Record<string, unknown>).compact !== undefined) {\n    config.COMPACT_MODE = Boolean((opts as unknown as Record<string, unknown>).compact);\n  } else {\n    config.COMPACT_MODE = !opts.full;\n  }\n\n  // Configurar nvel de log\n  if (opts.logNivel && ['erro', 'aviso', 'info', 'debug'].includes(opts.logNivel)) {\n    config.LOG_LEVEL = opts.logNivel as 'erro' | 'aviso' | 'info' | 'debug';\n  }\n\n  // Processar filtros\n  const includeGroupsRaw = processPatternGroups(opts.include);\n  const includeGroupsExpanded = includeGroupsRaw.map(g => expandIncludes(g));\n  const includeListFlat = includeGroupsExpanded.flat();\n  const excludeList = processPatternListAchatado(opts.exclude);\n  const incluiNodeModules = includeListFlat.some(p => /node_modules/.test(p));\n\n  // Exibir bloco de filtros se verbose\n  exibirBlocoFiltros(includeGroupsExpanded, includeListFlat, excludeList, incluiNodeModules);\n\n  // Configurar filtros no config global\n  configurarFiltros(includeGroupsRaw, includeListFlat, excludeList, incluiNodeModules);\n  let iniciouDiagnostico = false;\n  const baseDir = process.cwd();\n  let guardianResultado: ResultadoGuardian | undefined;\n  let fileEntries: FileEntryWithAst[] = [];\n  let totalOcorrencias = 0;\n  let _jsonEmitted = false;\n\n  // Listar analistas se solicitado\n  if (opts.listarAnalistas && !opts.json) {\n    await listarAnalistas();\n  }\n\n  // Nota: antigamente tentvamos resolver dinamicamente uma outra\n  // instncia de `log` aqui (usando casts para `any`) para compatibilidade\n  // com mocks; atualmente usamos o `log` importado estaticamente e, quando\n  // necessrio, importamos dinamicamente nos trechos locais onde isto \n  // requisitado pelos testes. Isso evita uso de `any` e elimina variveis\n  // no utilizadas.\n\n  try {\n    // Fase inicial do diagnstico\n    if (opts.json) {\n      // Suprime cabealhos verbosos no modo JSON\n    } else if (!iniciouDiagnostico && !config.COMPACT_MODE) {\n      // Usa optional chaining para suportar mocks parciais do mdulo de log nos testes\n      (log as typeof log & LogExtensions).fase?.('Iniciando diagnstico completo');\n      iniciouDiagnostico = true;\n    } else if (!iniciouDiagnostico && config.COMPACT_MODE) {\n      (log as typeof log & LogExtensions).fase?.('Diagnstico (modo compacto)');\n      iniciouDiagnostico = true;\n    }\n\n    // 1) Primeira varredura rpida (sem AST) apenas para obter entries e opcionalmente rodar Guardian\n    (log as typeof log & LogExtensions).fase?.('Varredura');\n    // Orquestrao: carregar registro de analistas na camada CLI e passar como dependncia\n    const { registroAnalistas } = await import('@analistas/registry/registry.js');\n    const leituraInicial = await iniciarInquisicao(baseDir, {\n      incluirMetadados: false,\n      skipExec: true\n    }, registroAnalistas as unknown as import('@').Tecnica[]);\n    fileEntries = leituraInicial.fileEntries; // contm contedo mas sem AST\n\n    // Criao e/ou salvamento de arqutipo personalizado sob demanda\n    if (opts.criarArquetipo) {\n      try {\n        const norm = (p: string) => p.replace(/\\\\/g, '/');\n        const dirSet = new Set<string>();\n        const arquivosRaiz: string[] = [];\n        for (const fe of fileEntries) {\n          const rel = norm(fe.relPath || fe.fullCaminho || '');\n          if (!rel) continue;\n          if (!rel.includes('/')) {\n            arquivosRaiz.push(rel);\n          }\n          const parts = rel.split('/');\n          if (parts.length > 1) {\n            // acumula prefixos de diretrios: ex.: src/a/b -> 'src', 'src/a', 'src/a/b'\n            for (let i = 1; i < parts.length; i++) {\n              const d = parts.slice(0, i).join('/');\n              if (d) dirSet.add(d);\n            }\n          }\n        }\n\n        // Tenta obter nome do projeto a partir do package.json (preferncia: fileEntries; fallback: disco)\n        let nomeProjeto = path.basename(baseDir);\n        try {\n          const pkg = fileEntries.find(fe => /(^|[\\\\/])package\\.json$/.test(fe.relPath || fe.fullCaminho));\n          if (pkg && typeof pkg.content === 'string' && pkg.content.trim()) {\n            const parsed = JSON.parse(pkg.content);\n            if (parsed && typeof parsed.name === 'string' && parsed.name.trim()) {\n              nomeProjeto = parsed.name.trim();\n            }\n          } else {\n            const pkgCaminho = path.join(baseDir, 'package.json');\n            try {\n              const raw = await fs.promises.readFile(pkgCaminho, 'utf-8');\n              const parsed = JSON.parse(raw);\n              if (parsed && typeof parsed.name === 'string' && parsed.name.trim()) {\n                nomeProjeto = parsed.name.trim();\n              }\n            } catch { }\n          }\n        } catch { }\n        const estruturaDetectada = Array.from(dirSet);\n        const {\n          criarTemplateArquetipoPersonalizado,\n          salvarArquetipoPersonalizado\n        } = await import('@analistas/js-ts/arquetipos-personalizados.js');\n        const arquetipo = criarTemplateArquetipoPersonalizado(nomeProjeto, estruturaDetectada, arquivosRaiz, 'generico');\n        if (opts.salvarArquetipo) {\n          await salvarArquetipoPersonalizado(arquetipo, baseDir);\n        } else if (config.VERBOSE) {\n          log.info(CliProcessamentoDiagnosticoMensagens.templateArquetipoPreview);\n        }\n      } catch (e) {\n        log.aviso(`Falha ao gerar/salvar arqutipo personalizado: ${e instanceof Error ? e.message : String(e)}`);\n      }\n    }\n\n    // Executar Guardian se solicitado\n    if (config.GUARDIAN_ENABLED) {\n      // Usa optional chaining para evitar erro quando o mock no prover `fase`\n      (log as typeof log & LogExtensions).fase?.('Verificando integridade do Prometheus');\n      try {\n        const resultado = await scanSystemIntegrity(fileEntries, {\n          suppressLogs: true\n        });\n        guardianResultado = resultado;\n        switch (resultado.status) {\n          case IntegridadeStatus.Ok:\n            logGuardian.integridadeOk();\n            break;\n          case IntegridadeStatus.Criado:\n            logGuardian.baselineCriado();\n            break;\n          case IntegridadeStatus.Aceito:\n            logGuardian.baselineAceito();\n            break;\n          case IntegridadeStatus.AlteracoesDetectadas:\n            logGuardian.alteracoesDetectadas();\n            totalOcorrencias++;\n            break;\n        }\n      } catch (err) {\n        logGuardian.bloqueado();\n        if (config.GUARDIAN_ENFORCE_PROTECTION && typeof err === 'object' && err && 'detalhes' in err && Array.isArray((err as {\n          detalhes?: unknown;\n        }).detalhes)) {\n          (err as {\n            detalhes: string[];\n          }).detalhes.forEach(d => {\n            logGuardian.aviso(d);\n          });\n          if (!process.env.VITEST) {\n            try {\n              process.exit(1);\n            } catch (e) {\n              throw e;\n            }\n            throw new Error(ExcecoesMensagens.exit1);\n          }\n        } else {\n          logGuardian.modoPermissivo();\n        }\n      }\n    }\n\n    // Se modo somente varredura estiver ativo, encerramos aps coleta inicial\n    if (config.SCAN_ONLY) {\n      log.info(chalk.bold(`\\n`));\n      logGuardian.scanOnly(fileEntries.length);\n      if (config.REPORT_EXPORT_ENABLED) {\n        try {\n          const ts = new Date().toISOString().replace(/[:.]/g, '-');\n          const dir = typeof config.REPORT_OUTPUT_DIR === 'string' ? config.REPORT_OUTPUT_DIR : path.join(baseDir, 'prometheus-reports');\n          const fs = await import('node:fs');\n          await fs.promises.mkdir(dir, {\n            recursive: true\n          });\n          const nome = `prometheus-scan-${ts}`;\n          const resumo = {\n            modo: 'scan-only',\n            totalArquivos: fileEntries.length,\n            timestamp: new Date().toISOString()\n          };\n          const salvar = await getSalvarEstado();\n          await salvar(path.join(dir, `${nome}.json`), resumo);\n          log.sucesso(CliProcessamentoDiagnosticoMensagens.relatorioScanSalvo(dir));\n        } catch (e) {\n          const msg = CliProcessamentoDiagnosticoMensagens.falhaExportarRelatorioScanOnly((e as Error).message);\n          log.erro(msg);\n        }\n      }\n      if (opts.json) {\n        console.log(JSON.stringify({\n          modo: 'scan-only',\n          totalArquivos: fileEntries.length\n        }));\n      }\n      // Evita encerramento forado em testes/ambiente de automao\n      if (!process.env.VITEST && !opts.json) process.exit(0); else if (!process.env.VITEST && opts.json) process.exitCode = 0;\n      return {\n        totalOcorrencias: 0,\n        temErro: false,\n        guardianResultado,\n        fileEntriesComAst: [],\n        resultadoFinal: {\n          ocorrencias: [],\n          metricas: {\n            totalArquivos: 0,\n            tempoTotal: 0,\n            analistas: []\n          }\n        }\n      };\n    }\n    // (bloco de criao de arqutipo removido)\n\n    // Preparar AST para os arquivos coletados\n    // Suporte ao fast-mode: reduz carga (parcialmente) quando ativo\n    const fastMode = Boolean((opts as unknown as Record<string, unknown>)['fast']);\n    (log as typeof log & LogExtensions).fase?.('Preparando AST');\n    let fileEntriesComAst = await prepararComAst(fileEntries, baseDir);\n    if (fastMode) {\n      // Heurstica simples: prioriza arquivos em src/ e ignora testes/configs\n      fileEntriesComAst = fileEntriesComAst.filter(fe => {\n        const rel = (fe.relPath || fe.fullCaminho || '').replace(/\\\\/g, '/').toLowerCase();\n        const isTest = /(^|\\/)tests?(\\/|\\.)/.test(rel) || /\\.(test|spec)\\.(ts|js|tsx|jsx)$/.test(rel) || /__tests__/.test(rel);\n        const isConfiguracao = /config|\\.config\\.|\\.rc\\.|package\\.json|tsconfig|eslint|prettier|vitest|jest|babel/.test(rel);\n        const isSrc = /(^|\\/)src\\//.test(rel);\n        return isSrc && !isTest && !isConfiguracao;\n      });\n    }\n\n    // Detectar arqutipos (pode retornar undefined em casos mnimos)\n    const arquetiposResultado: Awaited<ReturnType<typeof detectarArquetipos>> | undefined = await detectarArquetiposComTimeout({\n      arquivos: fileEntriesComAst,\n      baseDir\n    }, baseDir, {\n      quiet: opts.json\n    });\n\n    // Continuar com o processamento restante...\n    // Em fast-mode, reduz o conjunto de analistas para acelerar\n    const registro = (await import('@analistas/registry/registry.js')).registroAnalistas;\n    let tecnicas = asTecnicas(registro);\n    if (fastMode) {\n      const fmIncluirSrc: unknown = (config as unknown as Record<string, unknown>).fastMode && (config as unknown as Record<string, unknown>).fastMode as Record<string, unknown>;\n      const includeList = Array.isArray((fmIncluirSrc as Record<string, unknown>)?.analystsInclude) ? (fmIncluirSrc as Record<string, unknown>).analystsInclude as string[] : [];\n      const fmExcluirSrc: unknown = (config as unknown as Record<string, unknown>).fastMode && (config as unknown as Record<string, unknown>).fastMode as Record<string, unknown>;\n      const excludeList = Array.isArray((fmExcluirSrc as Record<string, unknown>)?.analystsExclude) ? (fmExcluirSrc as Record<string, unknown>).analystsExclude as string[] : [];\n      tecnicas = asTecnicas((registro as (import('@').Analista | import('@').Tecnica)[]).filter(a => {\n        // Normaliza nomes para comparao robusta\n        const nomeRaw = (a as unknown as {\n          nome?: string;\n        }).nome || '';\n        const norm = (s: string) => s.toLowerCase().replace(/[^a-z0-9]+/g, '-');\n        const nome = norm(nomeRaw);\n        const matchIncluir = includeList.length ? includeList.some(n => {\n          const nn = norm(n);\n          return nome.includes(nn) || nomeRaw.toLowerCase().includes(n.toLowerCase());\n        }) : true;\n        const matchExcluir = excludeList.some(n => {\n          const nn = norm(n);\n          return nome.includes(nn) || nomeRaw.toLowerCase().includes(n.toLowerCase());\n        });\n        return matchIncluir && !matchExcluir;\n      }));\n    }\n    (log as typeof log & LogExtensions).fase?.('Executando analistas');\n\n    // Flags especiais (disponveis para detectores/analistas via config global)\n    try {\n      const verifyCycles = Boolean((opts as unknown as Record<string, unknown>)['verifyCycles'] || (config as unknown as Record<string, unknown>)['SPECIAL_VERIFY_CYCLES']);\n      (config as unknown as Record<string, unknown>)['SPECIAL_VERIFY_CYCLES'] = verifyCycles;\n    } catch { }\n    const resultadoExecucao = await executarInquisicao(fileEntriesComAst, tecnicas, baseDir, converterResultadoGuardian(guardianResultado), {\n      verbose: config.VERBOSE,\n      compact: config.COMPACT_MODE,\n      fast: opts.fast ?? false // Modo rpido: workers paralelos\n    });\n\n    // Processar mtricas e ocorrncias\n    registrarUltimasMetricas(resultadoExecucao.metricas);\n    // Deduplica ocorrncias repetidas para reduzir rudo no orquestrador\n    let ocorrenciasFiltradas = dedupeOcorrencias(resultadoExecucao.ocorrencias || []);\n    // Trust Compiler: se habilitado, reduzir ocorrncias quando TS/ESLint no reportam\n    const trustCompiler = Boolean((opts as unknown as Record<string, unknown>)['trustCompiler'] || (config as unknown as Record<string, unknown>)['SPECIAL_TRUST_COMPILER']);\n    if (trustCompiler) {\n      try {\n        // Heurstica simples: se projeto tem tsconfig e tsc --noEmit no reporta erros, rebaixa severidades conhecidas\n        const hasTs = fs.existsSync(path.join(baseDir, 'tsconfig.json'));\n        let tsOk = true;\n        if (hasTs) {\n          // Evitar spawn pesado: usar flag existente de sucesso da build no pipeline\n          // Caso no disponvel, assume ok para reduzir rudo em modo confiana\n          tsOk = true;\n        }\n        if (tsOk) {\n          ocorrenciasFiltradas = ocorrenciasFiltradas.filter(o => {\n            const regra = o.tipo || '';\n            // regras que o compilador/ESLint normalmente cobrem\n            const cobertas = [/import.*nao.*usado/i, /tipo-inseguro.*unknown/i];\n            return !cobertas.some(r => r.test(regra));\n          });\n        }\n      } catch { }\n    }\n    // Conciliao simples entre analistas: rebaixa severidade em casos de conflito\n    try {\n      const byLoc = new Map<string, {\n        tipos: Set<string>;\n        items: Record<string, unknown>[];\n      }>();\n      for (const o of ocorrenciasFiltradas as unknown as Record<string, unknown>[]) {\n        const key = `${o.relPath || ''}:${o.linha || 0}`;\n        const tipo = String(o.tipo || '');\n        if (!byLoc.has(key)) byLoc.set(key, {\n          tipos: new Set(),\n          items: []\n        });\n        const entry = byLoc.get(key);\n        if (!entry) continue;\n        entry.tipos.add(tipo);\n        entry.items.push(o);\n      }\n      for (const [, entry] of byLoc) {\n        const tipos = Array.from(entry.tipos);\n        const hasTipoUnsafe = tipos.some(t => t.startsWith('tipo-inseguro'));\n        const hasComplexity = tipos.some(t => /complexidade|funcoes-longas/i.test(t));\n        if (hasTipoUnsafe && hasComplexity) {\n          for (const item of entry.items) {\n            const tipo = String(item.tipo || '');\n            if (tipo.startsWith('tipo-inseguro')) {\n              item.nivel = 'aviso';\n              item.mensagem = `${item.mensagem} |  Conciliao: inferncia e tipagem explcita em conflito; revisar caso`;\n            }\n          }\n        }\n      }\n    } catch { }\n    // Aplicar supresses configuradas em prometheus.config.json\n    ocorrenciasFiltradas = aplicarSupressaoOcorrencias(ocorrenciasFiltradas, config as unknown as FiltrosConfig || undefined);\n    const totalOcorrenciasProcessadas = ocorrenciasFiltradas.length;\n\n    //  PROCESSAMENTO DE FLAGS INTUITIVAS\n    // Mapear flags intuitivas para as flags internas\n    if (opts.fix && !opts.autoFix) {\n      opts.autoFix = true;\n      logSistema.processamentoFixDetectada();\n    }\n    if (opts.fixSafe && !opts.autoFixConservative) {\n      opts.autoFixConservative = true;\n      opts.autoFix = true;\n      log.info(MENSAGENS_AUTOFIX.flags.fixSafe);\n    }\n\n    // Aplicar correes automticas (quick fixes) se solicitado\n    if (opts.autoFix) {\n      try {\n        // Importar mdulos de quick fixes e configurao\n        // O registro de quick fixes foi consolidado em fix-config.js\n        const {\n          findQuickFixes,\n          applyQuickFix\n        } = await import('@core/config/auto/fix-config.js');\n        const {\n          getAutoFixConfig\n        } = await import('@core/config/auto/auto-fix-config.js');\n\n        // Determinar configurao do auto-fix\n        let autoCorrecaoMode = opts.autoCorrecaoMode || 'balanced';\n        if (opts.autoFixConservative) {\n          autoCorrecaoMode = 'conservative';\n          opts.autoFix = true; // Ativar auto-fix automaticamente\n        }\n        const autoCorrecaoConfiguracao = getAutoFixConfig(autoCorrecaoMode);\n        if (autoCorrecaoMode === 'conservative') {\n          log.info(MENSAGENS_AUTOFIX.logs.modoConservador);\n        } else if (autoCorrecaoMode === 'aggressive') {\n          log.aviso(CliProcessamentoDiagnosticoMensagens.autoFixModoAgressivo);\n        }\n\n        // Encontrar arquivos com quick fixes disponveis\n        const quickFixesDisponiveis = ocorrenciasFiltradas.filter(occ => occ.tipo === 'auto-fix-disponivel' || occ.tipo === 'QUICK_FIX_DISPONIVEL');\n        if (quickFixesDisponiveis.length === 0) {\n          logSistema.autoFixNenhumaCorrecao();\n        } else {\n          logSistema.autoFixAplicando(autoCorrecaoMode);\n          let arquivosCorrigidos = 0;\n          let totalCorrecoes = 0;\n          let correcoesPuladas = 0;\n\n          // Agrupar por arquivo para aplicar todas as correes de uma vez\n          const correcoesPorArquivo = new Map<string, typeof quickFixesDisponiveis>();\n          for (const fix of quickFixesDisponiveis) {\n            const arquivo = fix.relPath || fix.arquivo;\n            if (!arquivo) continue;\n            if (!correcoesPorArquivo.has(arquivo)) {\n              correcoesPorArquivo.set(arquivo, []);\n            }\n            correcoesPorArquivo.get(arquivo)?.push(fix);\n          }\n\n          // Aplicar correes arquivo por arquivo\n          const maxFixesPerArquivo = autoCorrecaoConfiguracao?.maxFixesPerArquivo ?? Infinity;\n          for (const [arquivo, _fixes] of correcoesPorArquivo) {\n            try {\n              // Encontrar o FileEntry correspondente\n              const fileEntrada = fileEntriesComAst.find(fe => fe.relPath === arquivo || fe.fullCaminho === arquivo);\n              if (!fileEntrada || typeof fileEntrada.content !== 'string') {\n                logSistema.autoFixArquivoNaoEncontrado(arquivo);\n                continue;\n              }\n              let codigoCorrigido = fileEntrada.content;\n              let corrigiuAlgo = false;\n              let correcoesPorArquivoContagem = 0;\n\n              // Encontrar e aplicar quick fixes com configurao\n              const quickFixesEncontrados = findQuickFixes(codigoCorrigido, undefined, autoCorrecaoConfiguracao, arquivo);\n              for (const quickCorrecao of quickFixesEncontrados) {\n                // Verificar limite de correes por arquivo\n                const maxFixesPerArquivo = autoCorrecaoConfiguracao?.maxFixesPerArquivo ?? Infinity;\n                if (correcoesPorArquivoContagem >= maxFixesPerArquivo) {\n                  correcoesPuladas += quickCorrecao.matches.length;\n                  break;\n                }\n                for (const match of quickCorrecao.matches) {\n                  try {\n                    const novocodigo = applyQuickFix(codigoCorrigido, quickCorrecao, match);\n                    if (novocodigo !== codigoCorrigido) {\n                      codigoCorrigido = novocodigo;\n                      corrigiuAlgo = true;\n                      totalCorrecoes++;\n                      correcoesPorArquivoContagem++;\n                      if (config.VERBOSE) {\n                        logSistema.autoFixAplicada(quickCorrecao.title, quickCorrecao.confidence);\n                      }\n                    }\n                  } catch (err) {\n                    logSistema.autoFixFalha(quickCorrecao.id, err instanceof Error ? err.message : String(err));\n                  }\n\n                  // Verificar limite de correes por arquivo\n                  if (correcoesPorArquivoContagem >= maxFixesPerArquivo) {\n                    break;\n                  }\n                }\n              }\n\n              // Salvar arquivo se houve alteraes\n              if (corrigiuAlgo) {\n                const {\n                  promises: fs\n                } = await import('node:fs');\n                const caminhoCompleto = path.isAbsolute(arquivo) ? arquivo : path.join(baseDir, arquivo);\n                await fs.writeFile(caminhoCompleto, codigoCorrigido, 'utf-8');\n                arquivosCorrigidos++;\n                if (config.VERBOSE) {\n                  logSistema.autoFixCorrigido(arquivo);\n                }\n              }\n            } catch (err) {\n              log.erro(` Erro ao corrigir ${arquivo}: ${err instanceof Error ? err.message : String(err)}`);\n            }\n          }\n          if (arquivosCorrigidos > 0) {\n            const estatisticas = [`${totalCorrecoes} correes aplicadas em ${arquivosCorrigidos} arquivo(s)`];\n            if (correcoesPuladas > 0) {\n              estatisticas.push(`${correcoesPuladas} correes puladas (limite por arquivo: ${maxFixesPerArquivo === Infinity ? '' : maxFixesPerArquivo})`);\n            }\n            if (autoCorrecaoMode === 'conservative') {\n              estatisticas.push('modo conservador (alta confiana apenas)');\n            }\n            logSistema.autoFixEstatisticas(estatisticas);\n\n            // Validao ESLint ps-auto-fix para harmonia total\n            if (process.env.PROMETHEUS_ESLINT_VALIDATION !== '0' && autoCorrecaoConfiguracao.validateAfterFix) {\n              try {\n                log.info(MENSAGENS_AUTOFIX.logs.validarEslint);\n                const {\n                  spawn\n                } = await import('node:child_process');\n\n                // Lista de arquivos corrigidos para validao\n                const arquivosParaValidar = Array.from(correcoesPorArquivo.keys());\n                if (arquivosParaValidar.length > 0) {\n                  // Executar ESLint --fix apenas nos arquivos modificados\n                  const eslintArgs = ['--fix', ...arquivosParaValidar];\n                  const proc = spawn('npx', ['eslint', ...eslintArgs], {\n                    cwd: baseDir,\n                    stdio: 'pipe'\n                  });\n                  let stdout = '';\n                  let _stderr = '';\n                  proc.stdout?.on('data', data => {\n                    stdout += data;\n                  });\n                  proc.stderr?.on('data', data => {\n                    _stderr += data;\n                  });\n                  await new Promise((resolve, _reject) => {\n                    proc.on('close', code => {\n                      if (code === 0) {\n                        logSistema.autoFixESLintHarmonia();\n                        resolve(void 0);\n                      } else {\n                        // ESLint encontrou/corrigiu issues - isso  normal\n                        if (config.VERBOSE && stdout) {\n                          logSistema.processamentoESLintOutput(stdout);\n                        }\n                        logSistema.autoFixESLintAjustes();\n                        resolve(void 0);\n                      }\n                    });\n                    proc.on('error', err => {\n                      logSistema.autoFixESLintFalha(err.message);\n                      resolve(void 0); // No falha o processo principal\n                    });\n                  });\n                }\n              } catch (err) {\n                log.aviso(`  Validao ESLint no executada: ${err instanceof Error ? err.message : String(err)}`);\n              }\n            }\n          } else {\n            logSistema.autoFixNenhumaAplicada();\n          }\n\n          // Remover quick fixes das ocorrncias j que foram aplicados\n          const ocorrenciasSemQuickFixes = ocorrenciasFiltradas.filter(occ => occ.tipo !== 'auto-fix-disponivel' && occ.tipo !== 'QUICK_FIX_DISPONIVEL');\n\n          // Atualizar contadores e usar ocorrncias sem quick fixes nos relatrios\n          totalOcorrencias = ocorrenciasSemQuickFixes.length;\n        }\n      } catch (err) {\n        log.erro(` Falha ao executar auto-fix: ${err instanceof Error ? err.message : String(err)}`);\n      }\n    } else {\n      // CRTICO: Definir totalOcorrencias no fluxo normal (sem auto-fix)\n      totalOcorrencias = ocorrenciasFiltradas.length;\n    }\n\n    // Logging bsico sempre, detalhado para --verbose e --debug\n    const tiposOcorrencias = new Map<string, number>();\n    const nivelOcorrencias = new Map<string, number>();\n    ocorrenciasFiltradas.forEach(ocorrencia => {\n      const tipo = ocorrencia.tipo || 'DESCONHECIDO';\n      const nivel = ocorrencia.nivel || 'info';\n      tiposOcorrencias.set(tipo, (tiposOcorrencias.get(tipo) || 0) + 1);\n      nivelOcorrencias.set(nivel, (nivelOcorrencias.get(nivel) || 0) + 1);\n    });\n    if (tiposOcorrencias.size > 0 && !opts.json) {\n      // Modo executivo: mostrar resumo executivo conciso e acionvel\n      if (opts.executive) {\n        try {\n          const criticos = nivelOcorrencias.get('erro') || 0;\n          const altos = nivelOcorrencias.get('alto') || 0;\n          const total = totalOcorrenciasProcessadas;\n\n          // Top arquivos por ocorrncias (somente erros/avisos crticos para executivo)\n          const arquivoContagem = new Map<string, number>();\n          for (const oc of ocorrenciasFiltradas) {\n            const pathChave = (oc.relPath || oc.arquivo || 'desconhecido') as string;\n            const nivel = oc.nivel || 'info';\n            if (nivel === 'erro' || nivel === 'alto') {\n              arquivoContagem.set(pathChave, (arquivoContagem.get(pathChave) || 0) + 1);\n            }\n          }\n          const topArquivos = Array.from(arquivoContagem.entries()).sort((a, b) => b[1] - a[1]).slice(0, 5);\n          const header = CliProcessamentoDiagnosticoMensagens.resumoExecutivoHeader(total, criticos, altos);\n          if (typeof (log as typeof log & LogExtensions).imprimirBloco === 'function') {\n            const linhas = [CliProcessamentoDiagnosticoMensagens.resumoExecutivoCriticos(criticos), CliProcessamentoDiagnosticoMensagens.resumoExecutivoAltos(altos), CliProcessamentoDiagnosticoMensagens.linhaEmBranco, CliProcessamentoDiagnosticoMensagens.resumoExecutivoTopArquivosErrosAltos, ...topArquivos.map(([f, c]) => CliProcessamentoDiagnosticoMensagens.resumoExecutivoBulletTopArquivo(f, c)), CliProcessamentoDiagnosticoMensagens.linhaEmBranco, CliProcessamentoDiagnosticoMensagens.resumoExecutivoAcaoSugerida];\n            (log as typeof log & LogExtensions).imprimirBloco(header, linhas);\n          } else {\n            log.info(header);\n            if (topArquivos.length > 0) {\n              log.info(CliProcessamentoDiagnosticoMensagens.resumoExecutivoTopArquivosErrosAltos);\n              topArquivos.forEach(([f, c]) => log.info(CliProcessamentoDiagnosticoMensagens.resumoExecutivoBulletTopArquivo(f, c)));\n            }\n            log.info(CliProcessamentoDiagnosticoMensagens.resumoExecutivoAcaoSugerida);\n          }\n        } catch {\n          // no crtico\n        }\n      }\n      // Resumo bsico sempre (no verbose e no executive)\n      else if (!config.VERBOSE && !config.DEV_MODE) {\n        logSistema.processamentoResumoOcorrencias(totalOcorrenciasProcessadas);\n\n        // Top 5 tipos mais comuns\n        const topTipos = Array.from(tiposOcorrencias.entries()).sort((a, b) => b[1] - a[1]).slice(0, 5);\n        console.log(CliProcessamentoDiagnosticoMensagens.linhaEmBranco);\n        console.log(CliProcessamentoDiagnosticoMensagens.principaisTiposTitulo);\n        topTipos.forEach(([tipo, count]) => {\n          console.log(CliProcessamentoDiagnosticoMensagens.principaisTiposLinha(tipo, count));\n        });\n\n        // Mini top arquivos (5) para ao rpida\n        try {\n          const arquivoContagem = new Map<string, number>();\n          for (const oc of ocorrenciasFiltradas) {\n            const pathChave = (oc.relPath || oc.arquivo || 'desconhecido') as string;\n            arquivoContagem.set(pathChave, (arquivoContagem.get(pathChave) || 0) + 1);\n          }\n          const topArquivos = Array.from(arquivoContagem.entries()).sort((a, b) => b[1] - a[1]).slice(0, 5);\n          if (topArquivos.length > 0) {\n            console.log(CliProcessamentoDiagnosticoMensagens.linhaEmBranco);\n            console.log(CliProcessamentoDiagnosticoMensagens.topArquivosTitulo);\n            topArquivos.forEach(([f, c]) => console.log(CliProcessamentoDiagnosticoMensagens.topArquivosLinha(f, c)));\n          }\n        } catch {\n          /* ignore */\n        }\n        console.log(CliProcessamentoDiagnosticoMensagens.linhaEmBranco);\n        logSistema.processamentoDicasContextuais();\n\n        // Dicas baseadas no contedo real encontrado\n        const totalTodos = tiposOcorrencias.get('TODO_PENDENTE') || 0;\n        const totalQuickFixes = (tiposOcorrencias.get('QUICK_FIX_DISPONIVEL') || 0) + (tiposOcorrencias.get('auto-fix-disponivel') || 0);\n        const totalErros = nivelOcorrencias.get('erro') || 0;\n        const totalAvisos = nivelOcorrencias.get('aviso') || 0;\n        if (totalErros > 0) {\n          logSistema.processamentoErrosCriticos(totalErros);\n        }\n        if (totalAvisos > 0) {\n          logSistema.processamentoAvisosEncontrados(totalAvisos);\n        }\n        if (totalQuickFixes > 10) {\n          logSistema.processamentoQuickFixesMuitos(totalQuickFixes);\n          logSistema.processamentoQuickFixesComando();\n          logSistema.processamentoQuickFixesExecutar();\n        } else if (totalQuickFixes > 0) {\n          logSistema.processamentoQuickFixesMuitos(totalQuickFixes);\n          logSistema.processamentoQuickFixesComando();\n          logSistema.processamentoQuickFixesExecutar();\n        }\n        if (totalTodos > 50) {\n          logSistema.processamentoTodosMuitos(totalTodos);\n        } else if (totalTodos > 0) {\n          logSistema.processamentoTodosPoucos(totalTodos);\n        }\n        if (totalOcorrenciasProcessadas > 1000) {\n          logSistema.processamentoMuitasOcorrencias();\n          logSistema.processamentoFiltrarPasta();\n        }\n        logSistema.processamentoUsarFull();\n        logSistema.processamentoUsarJson();\n        if (totalOcorrenciasProcessadas < 100) {\n          logSistema.processamentoProjetoLimpo();\n        }\n      } else {\n        // Detalhamento completo para --verbose (ou quando --full ativo)\n        logSistema.processamentoDetalhamentoOcorrencias(totalOcorrenciasProcessadas);\n\n        // Mostrar por tipo\n        log.info(CliProcessamentoDiagnosticoMensagens.porTipoTitulo);\n        Array.from(tiposOcorrencias.entries()).sort((a, b) => b[1] - a[1]).forEach(([tipo, count]) => {\n          log.info(CliProcessamentoDiagnosticoMensagens.porTipoLinha(tipo, count));\n        });\n\n        // Mostrar por nvel de severidade\n        log.info(CliProcessamentoDiagnosticoMensagens.porSeveridadeTitulo);\n        Array.from(nivelOcorrencias.entries()).sort((a, b) => b[1] - a[1]).forEach(([nivel, count]) => {\n          const emoji = nivel === 'erro' ? '' : nivel === 'aviso' ? '' : '';\n          log.info(CliProcessamentoDiagnosticoMensagens.porSeveridadeLinha(emoji, nivel, count));\n        });\n\n        // Adicionar top arquivos com contagem (til para investigao)\n        try {\n          const arquivosContagem = new Map<string, number>();\n          for (const oc of ocorrenciasFiltradas) {\n            const key = (oc.relPath || oc.arquivo || 'desconhecido') as string;\n            arquivosContagem.set(key, (arquivosContagem.get(key) || 0) + 1);\n          }\n          const topArquivosAll = Array.from(arquivosContagem.entries()).sort((a, b) => b[1] - a[1]).slice(0, 10);\n          if (topArquivosAll.length) {\n            if (typeof (log as typeof log & LogExtensions).imprimirBloco === 'function') {\n              const linhas = [CliProcessamentoDiagnosticoMensagens.topArquivosPorOcorrenciasTitulo, ...topArquivosAll.map(([f, c]) => CliProcessamentoDiagnosticoMensagens.resumoExecutivoBulletTopArquivo(f, c))];\n              (log as typeof log & LogExtensions).imprimirBloco(CliProcessamentoDiagnosticoMensagens.arquivosMaisOcorrenciasTitulo, linhas);\n            } else {\n              log.info(CliProcessamentoDiagnosticoMensagens.topArquivosPorOcorrenciasTitulo);\n              topArquivosAll.forEach(([f, c]) => log.info(CliProcessamentoDiagnosticoMensagens.resumoExecutivoBulletTopArquivo(f, c)));\n            }\n          }\n\n          // Top crticos imediatos (erros/alto) para ao rpida\n          const criticosOuAltos: Array<{\n            arquivo: string;\n            tipo: string;\n            nivel: string;\n            linha?: number;\n            coluna?: number;\n          }> = [];\n          for (const oc of ocorrenciasFiltradas) {\n            const nivel = (oc.nivel || 'info').toString().toLowerCase();\n            if (nivel === 'erro' || nivel === 'alto') {\n              criticosOuAltos.push({\n                arquivo: (oc.relPath || oc.arquivo || 'desconhecido') as string,\n                tipo: (oc.tipo || 'desconhecido') as string,\n                nivel,\n                linha: typeof oc.linha === 'number' ? oc.linha : undefined,\n                coluna: typeof (oc as unknown as {\n                  coluna?: number;\n                }).coluna === 'number' ? (oc as unknown as {\n                  coluna?: number;\n                }).coluna : undefined\n              });\n            }\n          }\n          // Ordenao por severidade: erro > alto > aviso (se houver)\n          const ordemNivel = (n: string) => n === 'erro' ? 3 : n === 'alto' ? 2 : n === 'aviso' ? 1 : 0;\n          const topCriticos = criticosOuAltos.sort((a, b) => ordemNivel(b.nivel) - ordemNivel(a.nivel)).slice(0, 10);\n          if (topCriticos.length) {\n            if (typeof (log as typeof log & LogExtensions).imprimirBloco === 'function') {\n              const linhas = topCriticos.map(c => {\n                const pos = typeof c.linha === 'number' ? `:${c.linha}${typeof c.coluna === 'number' ? `:${c.coluna}` : ''}` : '';\n                return CliProcessamentoDiagnosticoMensagens.topCriticosLinha(c.nivel.toUpperCase(), c.tipo, c.arquivo, pos);\n              });\n              (log as typeof log & LogExtensions).imprimirBloco(CliProcessamentoDiagnosticoMensagens.topCriticosTitulo, linhas);\n            } else {\n              log.info(CliProcessamentoDiagnosticoMensagens.topCriticosTituloComDoisPontos);\n              topCriticos.forEach(c => {\n                const pos = typeof c.linha === 'number' ? `:${c.linha}${typeof c.coluna === 'number' ? `:${c.coluna}` : ''}` : '';\n                log.info(CliProcessamentoDiagnosticoMensagens.topCriticosLinha(c.nivel.toUpperCase(), c.tipo, c.arquivo, pos));\n              });\n            }\n          }\n\n          // Amostra de ocorrncias (limite para no poluir o terminal)\n          const SAMPLE_MAX = 50;\n          const sample = ocorrenciasFiltradas.slice(0, SAMPLE_MAX).map(o => `${o.relPath}:${o.linha ?? ''} [${o.nivel ?? ''}] ${String(o.mensagem ?? '').replace(/\\n/g, ' ')}`);\n          if (sample.length) {\n            if (typeof (log as typeof log & LogExtensions).imprimirBloco === 'function') {\n              (log as typeof log & LogExtensions).imprimirBloco(CliProcessamentoDiagnosticoMensagens.amostraBlocoTitulo(sample.length), sample.slice(0, 20));\n            } else {\n              log.info(CliProcessamentoDiagnosticoMensagens.amostraOcorrenciasTitulo);\n              sample.slice(0, 20).forEach(s => log.info(CliProcessamentoDiagnosticoMensagens.amostraLinhaIndentada(s)));\n            }\n            if (ocorrenciasFiltradas.length > SAMPLE_MAX) {\n              log.info(CliProcessamentoDiagnosticoMensagens.amostraMaisLinhas(SAMPLE_MAX, ocorrenciasFiltradas.length));\n            }\n          }\n        } catch {\n          // ignore\n        }\n      }\n    }\n\n    // Logging adicional para DEBUG\n    if (config.VERBOSE || config.DEV_MODE) {\n      if (config.DEV_MODE && !opts.json && resultadoExecucao.metricas) {\n        if (resultadoExecucao.metricas.analistas) {\n          const analistasComOcorrencias = resultadoExecucao.metricas.analistas.filter(a => (a.ocorrencias ?? 0) > 0);\n          logSistema.processamentoAnalistasProblemas(analistasComOcorrencias.length);\n          analistasComOcorrencias.forEach(analista => {\n            log.info(CliProcessamentoDiagnosticoMensagens.analistaOcorrenciasLinha(analista.nome, analista.ocorrencias, analista.duracaoMs.toFixed(1)));\n          });\n        }\n      }\n    }\n\n    // Mensagem final apenas quando repositrio est limpo\n    try {\n      if (!opts.json && !config.SCAN_ONLY && totalOcorrencias === 0) {\n        logRelatorio.repositorioImpecavel();\n      }\n    } catch { }\n\n    // Em ambiente de testes (Vitest) tambm invocar via import dinmico o mdulo\n    // que os testes normalmente mockam (`../../src/nucleo/constelacao/log.js`).\n    // Isso garante que, mesmo que haja alguma diferena de instncia entre o\n    // import esttico e o mock aplicado pelo Vitest, as spies do teste sejam\n    // chamadas e asseres sobre `logMock` passem.\n    // (removed temporary vitest dynamic invocations)\n\n    // Log de diagnstico concludo para testes\n    if (process.env.VITEST && !opts.json) {\n      log.info(CliProcessamentoDiagnosticoMensagens.diagnosticoConcluido);\n    }\n\n    // Processar arqutipos se disponvel\n    if (arquetiposResultado) {\n      // Lgica de processamento de arqutipos seria implementada aqui\n      // Por enquanto, apenas log se verbose\n      if (config.VERBOSE && arquetiposResultado.candidatos?.length > 0) {\n        log.info(CliProcessamentoDiagnosticoMensagens.arquetiposDetectados(arquetiposResultado.candidatos.length));\n      }\n\n      // Em modo compacto, mostrar informao resumida sobre arqutipos\n      if (!config.VERBOSE && config.COMPACT_MODE && arquetiposResultado.candidatos?.length > 0) {\n        const topCandidato = arquetiposResultado.candidatos[0];\n        log.info(CliProcessamentoDiagnosticoMensagens.arquetiposCompact(topCandidato.nome, topCandidato.confidence));\n      }\n\n      // Exibir informaes sobre candidatos mesmo quando no verbose (para testes)\n      if (!config.VERBOSE && arquetiposResultado.candidatos?.length > 0) {\n        log.info(CliProcessamentoDiagnosticoMensagens.arquetiposCandidatosEncontrados(arquetiposResultado.candidatos.length));\n      }\n\n      // Exibir informaes detalhadas dos arquetipos se verbose\n      if (config.VERBOSE && arquetiposResultado.candidatos?.length > 0) {\n        const candidatoTop = arquetiposResultado.candidatos[0];\n\n        // Log dos candidatos\n        log.info(CliProcessamentoDiagnosticoMensagens.arquetiposCandidatosTitulo);\n        for (const candidato of arquetiposResultado.candidatos.slice(0, 3)) {\n          log.info(CliProcessamentoDiagnosticoMensagens.arquetiposCandidatoLinha(candidato.nome, candidato.confidence));\n        }\n\n        // Log do planoSugestao se existir\n        if (candidatoTop.planoSugestao) {\n          const plano = candidatoTop.planoSugestao;\n          if (plano.mover && plano.mover.length > 0) {\n            log.info(CliProcessamentoDiagnosticoMensagens.planoSugestaoMove(plano.mover.length));\n          } else {\n            log.info(CliProcessamentoDiagnosticoMensagens.planoSugestaoNenhumMove);\n          }\n          if (plano.conflitos && plano.conflitos.length > 0) {\n            log.info(CliProcessamentoDiagnosticoMensagens.conflitos(plano.conflitos.length));\n          }\n        }\n\n        // Log de anomalias se existirem\n        if (candidatoTop.anomalias && candidatoTop.anomalias.length > 0) {\n          const tituloAnomalias = CliProcessamentoDiagnosticoMensagens.anomaliasTitulo;\n          const linhasAnomalias: string[] = [];\n          for (const anomalia of candidatoTop.anomalias.slice(0, 8)) {\n            linhasAnomalias.push(CliProcessamentoDiagnosticoMensagens.anomaliaLinha(anomalia.path, anomalia.motivo));\n          }\n          if (candidatoTop.anomalias.length > 8) {\n            linhasAnomalias.push(CliProcessamentoDiagnosticoMensagens.anomaliasMais(candidatoTop.anomalias.length - 8));\n          }\n          if (typeof (log as typeof log & LogExtensions).imprimirBloco === 'function') {\n            (log as typeof log & LogExtensions).imprimirBloco(tituloAnomalias, linhasAnomalias);\n          } else {\n            // Fallback para logs simples se imprimirBloco no estiver disponvel\n            log.info(CliProcessamentoDiagnosticoMensagens.anomaliasTituloComDoisPontos);\n            for (const linha of linhasAnomalias) {\n              log.info(CliProcessamentoDiagnosticoMensagens.amostraLinhaIndentada(linha));\n            }\n          }\n\n          // Log adicional sobre anomalias ocultas se houver mais de 8\n          if (candidatoTop.anomalias.length > 8) {\n            log.aviso(CliProcessamentoDiagnosticoMensagens.anomaliasOcultasAviso(candidatoTop.anomalias.length - 8));\n          }\n        }\n\n        // Log de drift se existir\n        if (arquetiposResultado.drift) {\n          const drift = arquetiposResultado.drift;\n          if (drift.alterouArquetipo) {\n            log.info(CliProcessamentoDiagnosticoMensagens.driftAlterou(drift.anterior, drift.atual));\n          } else {\n            log.info(CliProcessamentoDiagnosticoMensagens.driftMantido(drift.atual));\n          }\n          if (drift.arquivosRaizNovos && drift.arquivosRaizNovos.length > 0) {\n            const novosStr = drift.arquivosRaizNovos.length > 3 ? `${drift.arquivosRaizNovos.slice(0, 3).join(', ')}` : drift.arquivosRaizNovos.join(', ');\n            log.info(CliProcessamentoDiagnosticoMensagens.driftNovos(novosStr));\n          }\n          if (drift.arquivosRaizRemovidos && drift.arquivosRaizRemovidos.length > 0) {\n            const removidosStr = drift.arquivosRaizRemovidos.length > 3 ? `${drift.arquivosRaizRemovidos.slice(0, 3).join(', ')}` : drift.arquivosRaizRemovidos.join(', ');\n            log.info(CliProcessamentoDiagnosticoMensagens.driftRemovidos(removidosStr));\n          }\n        }\n      } else if (config.VERBOSE) {\n        // Debug: log se no h candidatos ou arquetiposResultado  undefined\n        const candidatosContagem = arquetiposResultado ? (arquetiposResultado as Awaited<ReturnType<typeof detectarArquetipos>>).candidatos?.length || 0 : 0;\n        log.info(`DEBUG: arquetiposResultado=${!!arquetiposResultado}, candidatos=${candidatosContagem}`);\n      }\n\n      // Imprimir bloco de resumo de estrutura se houver baseline/drift (fora de JSON)\n      if (!opts.json && arquetiposResultado && (arquetiposResultado.baseline || arquetiposResultado.drift)) {\n        const linhasEstrutura: string[] = [];\n        if (arquetiposResultado.baseline) {\n          const baseline = arquetiposResultado.baseline;\n          linhasEstrutura.push(CliProcessamentoDiagnosticoMensagens.baselineArquetipo(baseline.arquetipo, baseline.confidence));\n          linhasEstrutura.push(CliProcessamentoDiagnosticoMensagens.baselineCriadoEm(new Date(baseline.timestamp).toLocaleString('pt-BR')));\n        } else {\n          // Log de aviso quando no h baseline\n          log.aviso(CliProcessamentoDiagnosticoMensagens.baselineDesconhecidoAviso);\n          linhasEstrutura.push(CliProcessamentoDiagnosticoMensagens.baselineArquetipoDesconhecido);\n        }\n        if (arquetiposResultado.drift) {\n          const drift = arquetiposResultado.drift;\n          if (drift.alterouArquetipo) {\n            linhasEstrutura.push(CliProcessamentoDiagnosticoMensagens.driftDetectado(drift.anterior, drift.atual));\n          } else {\n            linhasEstrutura.push(CliProcessamentoDiagnosticoMensagens.arquetipoMantido(drift.atual));\n          }\n          if (drift.arquivosRaizNovos && drift.arquivosRaizNovos.length > 0) {\n            linhasEstrutura.push(CliProcessamentoDiagnosticoMensagens.novosArquivosRaiz(drift.arquivosRaizNovos.join(', ')));\n          }\n          if (drift.arquivosRaizRemovidos && drift.arquivosRaizRemovidos.length > 0) {\n            linhasEstrutura.push(CliProcessamentoDiagnosticoMensagens.arquivosRemovidosRaiz(drift.arquivosRaizRemovidos.join(', ')));\n          }\n        }\n        if (arquetiposResultado.candidatos && arquetiposResultado.candidatos.length > 0) {\n          const top = arquetiposResultado.candidatos[0];\n          linhasEstrutura.push(CliProcessamentoDiagnosticoMensagens.candidatoPrincipal(top.nome, top.confidence));\n        }\n        const tituloEstrutura = CliProcessamentoDiagnosticoMensagens.resumoEstruturaTitulo;\n        if (typeof (log as typeof log & LogExtensions).imprimirBloco === 'function') {\n          // Calcular largura como nos outros blocos\n          let larguraEstrutura: number | undefined;\n          if (typeof (log as Record<string, unknown>).calcularLargura === 'function') {\n            larguraEstrutura = (log as {\n              calcularLargura: Function;\n            }).calcularLargura(tituloEstrutura, linhasEstrutura, config.COMPACT_MODE ? 84 : 96);\n            // Se calcularLargura retornar undefined, usar fallback\n            if (typeof larguraEstrutura !== 'number' || isNaN(larguraEstrutura)) {\n              larguraEstrutura = config.COMPACT_MODE ? 84 : 96;\n            }\n          } else {\n            larguraEstrutura = config.COMPACT_MODE ? 84 : 96;\n          }\n          (log as typeof log & LogExtensions).imprimirBloco(tituloEstrutura, linhasEstrutura, undefined, larguraEstrutura);\n        }\n      }\n\n      // Sada JSON se solicitado\n      // No imprimir logs arbitrrios antes do JSON final  isso quebra os testes que\n      // esperam JSON puro em stdout. Em ambiente de desenvolvimento, registrar via\n      // logger debug para auxiliar diagnstico local.\n      if (config.DEV_MODE && typeof (log as {\n        debug?: Function;\n      }).debug === 'function') {\n        try {\n          (log as {\n            debug: Function;\n          }).debug(CliProcessamentoDiagnosticoMensagens.debugAboutToEmitJson(JSON.stringify(opts)));\n        } catch { }\n      }\n      if (opts.json) {\n        // Agregar ocorrncias de TODO_PENDENTE por arquivo\n        const ocorrenciasOriginais = ocorrenciasFiltradas;\n        const todosPorArquivo = new Map<string, typeof ocorrenciasOriginais>();\n\n        // Separar TODOs dos outros tipos de ocorrncia\n        const naoTodos: typeof ocorrenciasOriginais = [];\n        for (const ocorrencia of ocorrenciasOriginais) {\n          if (ocorrencia.tipo === 'TODO_PENDENTE') {\n            const relPath = ocorrencia.relPath || 'desconhecido';\n            if (!todosPorArquivo.has(relPath)) {\n              todosPorArquivo.set(relPath, []);\n            }\n            const todosArray = todosPorArquivo.get(relPath);\n            if (todosArray) {\n              todosArray.push(ocorrencia);\n            }\n          } else {\n            naoTodos.push(ocorrencia);\n          }\n        }\n\n        // Agregar TODOs por arquivo\n        const todosAgregados: typeof ocorrenciasOriginais = [];\n        for (const [, todos] of todosPorArquivo) {\n          if (todos.length === 1) {\n            todosAgregados.push(todos[0]);\n          } else if (todos.length > 1) {\n            // Criar ocorrncia agregada\n            const primeira = todos[0];\n            const mensagemAgregada = CliProcessamentoDiagnosticoMensagens.todosPendentesEncontrados(todos.length);\n            todosAgregados.push({\n              ...primeira,\n              mensagem: mensagemAgregada,\n              linha: Math.min(...todos.map(t => t.linha || 0))\n            });\n          }\n        }\n\n        // Combinar ocorrncias agregadas e deduplicar para reduzir rudo\n        let todasOcorrencias = [...naoTodos, ...todosAgregados];\n        todasOcorrencias = dedupeOcorrencias(todasOcorrencias);\n\n        // Em modo --json: emitir apenas erros e localizaes (sem mtricas/caches/tempos).\n        // Antes, normaliza para enriquecer `linha/coluna` quando disponvel via `loc`.\n        const ocorrenciasParaJson = todasOcorrencias.map(o => normalizarOcorrenciaParaJson(o)).filter(o => {\n          const nivel = (o.nivel || 'info') as string;\n          return nivel === 'erro' || o.tipo === 'PARSE_ERRO';\n        });\n        const totalOcorrenciasJson = ocorrenciasParaJson.length;\n\n        // Agregar tipos de ocorrncias\n        const tiposOcorrencias: Record<string, number> = {};\n        const parseErros: ParseErrosJson = {\n          totalOriginais: 0,\n          totalExibidos: 0,\n          agregados: 0\n        };\n\n        // Contar tipos de ocorrncias e parse erros\n        for (const ocorrencia of ocorrenciasParaJson) {\n          const tipo = ocorrencia.tipo || 'desconhecido';\n          tiposOcorrencias[tipo] = (tiposOcorrencias[tipo] || 0) + 1;\n\n          // Contar parse erros\n          if (tipo === 'PARSE_ERRO') {\n            parseErros.totalOriginais++;\n            parseErros.totalExibidos++;\n          }\n        }\n\n        // Ler parse erros das variveis globais (para testes e cenrios especiais)\n        const parseErrosGlobais = (globalThis as Record<string, unknown>).__PROMETHEUS_PARSE_ERROS__ as unknown[] || [];\n        const parseErrosOriginais = (globalThis as Record<string, unknown>).__PROMETHEUS_PARSE_ERROS_ORIGINAIS__ as number || 0;\n\n        // Adicionar parse erros globais  contagem\n        if (parseErrosGlobais.length > 0 || parseErrosOriginais > 0) {\n          parseErros.totalOriginais = Math.max(parseErros.totalOriginais, parseErrosOriginais);\n\n          // Se h array global, usar seu tamanho; seno, manter o valor atual (que vem das ocorrncias reais)\n          if (parseErrosGlobais.length > 0) {\n            parseErros.totalExibidos = Math.min(parseErros.totalOriginais, parseErrosGlobais.length);\n          }\n          // Se no h array global, totalExibidos j foi definido com o nmero de ocorrncias reais\n\n          // Atualizar totalOcorrencias se h parse erros\n          if (parseErrosOriginais > 0) {\n            totalOcorrencias = Math.max(totalOcorrencias, parseErrosOriginais);\n          }\n        }\n\n        // Calcular agregados\n        parseErros.agregados = Math.max(0, parseErros.totalOriginais - parseErros.totalExibidos);\n\n        // Determinar status baseado nas regras\n        let status = 'ok';\n        if (totalOcorrenciasJson > 0) {\n          status = 'problemas';\n          // Se h PARSE_ERRO e PARSE_ERRO_FALHA est ativo, marcar como erro\n          if (parseErros.totalOriginais > 0 && config.PARSE_ERRO_FALHA) {\n            status = 'erro';\n          }\n        }\n        const saidaJson: SaidaJsonDiagnostico = {\n          status: status as 'ok' | 'problemas' | 'erro',\n          totalOcorrencias: totalOcorrenciasJson,\n          guardian: guardianResultado ? 'verificado' : 'nao-verificado',\n          tiposOcorrencias,\n          parseErros,\n          ocorrencias: ocorrenciasParaJson,\n          linguagens: {\n            total: 0,\n            extensoes: {}\n          } // ser preenchido depois\n        };\n\n        // S incluir estruturaIdentificada se houver resultado de arquetipos\n        if (arquetiposResultado) {\n          saidaJson.estruturaIdentificada = {\n            melhores: arquetiposResultado.candidatos || [],\n            baseline: arquetiposResultado.baseline || null,\n            drift: arquetiposResultado.drift || {\n              alterouArquetipo: false,\n              deltaConfidence: 0,\n              arquivosRaizNovos: [],\n              arquivosRaizRemovidos: []\n            }\n          };\n        }\n\n        // JSON ser emitido usando helper centralizado que aplica escapes Unicode\n\n        // Computa linguagens a partir dos file entries com AST (ou sem AST)\n        const computeLinguagens = (fes: (FileEntry | FileEntryWithAst)[]): LinguagensJson => {\n          const extensoes: Record<string, number> = {};\n          let sem_ext = 0;\n          for (const f of fes || []) {\n            const rel = f.relPath || f.fullCaminho || '';\n            const base = rel.split(/[\\\\/]/).pop() || '';\n            const idx = base.lastIndexOf('.');\n            if (idx === -1) {\n              sem_ext++;\n            } else {\n              const ext = base.slice(idx + 1) || 'sem_ext';\n              extensoes[ext] = (extensoes[ext] || 0) + 1;\n            }\n          }\n          return {\n            total: (fes || []).length,\n            extensoes: {\n              ...extensoes,\n              sem_ext\n            }\n          };\n        };\n        const linguagensFinal = computeLinguagens(fileEntriesComAst || fileEntries);\n\n        // Anexa valores calculados\n        saidaJson.linguagens = linguagensFinal;\n\n        // Gerar JSON usando utilitrio comum com escape Unicode\n        try {\n          // Adicionar metadados de verso do schema e timestamp para compatibilidade\n          const schemaMeta = {\n            schemaVersion: '1.0.0',\n            prometheusVersion: '0.0.0',\n            timestamp: new Date().toISOString()\n          };\n          const saidaComMeta = {\n            ...schemaMeta,\n            ...saidaJson\n          };\n          // Verificar flag CLI/opt para ascii-only\n          const asciiOnly = Boolean(opts && (opts as OpcoesProcessamentoDiagnostico).jsonAscii || false);\n          console.log(stringifyJsonEscaped(saidaComMeta, 2, {\n            asciiOnly\n          }));\n          _jsonEmitted = true;\n        } catch (e) {\n          console.error(CliProcessamentoDiagnosticoMensagens.errorGeneratingJson, e);\n          console.log(CliProcessamentoDiagnosticoMensagens.fallbackJson, JSON.stringify(saidaJson));\n          _jsonEmitted = true;\n        }\n        // Exit codes padronizados: 0=ok/avisos, 1=erros, 2=critico (parse erros fatais)\n        if (!process.env.VITEST) {\n          const erros = (nivelOcorrencias.get('erro') || 0) as number;\n          const exitCode = parseErros.totalOriginais > 0 && config.PARSE_ERRO_FALHA ? 2 : erros > 0 ? 1 : 0;\n          process.exit(exitCode);\n        }\n      }\n\n      // Logs finais fora do modo JSON e quando no  scan-only\n      if (!opts.json && !config.SCAN_ONLY) {\n        // Imprimir bloco de resumo de tipos se houver ocorrncias\n        if (totalOcorrencias > 0 && ocorrenciasFiltradas) {\n          // Modo executivo: apenas problemas crticos e altos\n          if (opts.executive) {\n            const {\n              gerarResumoExecutivo\n            } = await import('@relatorios/filtro-inteligente.js');\n            const resumoExec = gerarResumoExecutivo(ocorrenciasFiltradas);\n            if (resumoExec.detalhes.length > 0) {\n              const linhasExec = resumoExec.detalhes.map(problema => `${problema.icone} ${problema.titulo.padEnd(25)} ${problema.quantidade.toString().padStart(6)}`);\n              const tituloExec = CliProcessamentoDiagnosticoMensagens.resumoExecutivoTitulo(resumoExec.problemasCriticos + resumoExec.problemasAltos);\n              const cabecalhoExec = [`${CliProcessamentoDiagnosticoMensagens.cabecalhoExecProblema.padEnd(30)}${CliProcessamentoDiagnosticoMensagens.cabecalhoExecQtd.padStart(6)}`];\n              if ('imprimirBloco' in log && typeof log.imprimirBloco === 'function') {\n                log.imprimirBloco(tituloExec, [...cabecalhoExec, ...linhasExec]);\n              }\n              console.log(CliProcessamentoDiagnosticoMensagens.dicaUseFull(totalOcorrencias));\n            } else {\n              console.log(CliProcessamentoDiagnosticoMensagens.projetoBomEstado(totalOcorrencias));\n              if (resumoExec.quickFixes > 0) {\n                console.log(CliProcessamentoDiagnosticoMensagens.quickFixesDisponiveis(resumoExec.quickFixes));\n              }\n            }\n          } else {\n            // Modo padro: todos os tipos\n            const tiposResumo: Record<string, number> = {};\n            for (const ocorrencia of ocorrenciasFiltradas) {\n              const tipo = ocorrencia.tipo || 'desconhecido';\n              tiposResumo[tipo] = (tiposResumo[tipo] || 0) + 1;\n            }\n            const linhasResumo = Object.entries(tiposResumo).map(([tipo, qtd]) => `${tipo.padEnd(20)} ${qtd.toString().padStart(8)}`);\n            const tituloResumo = CliProcessamentoDiagnosticoMensagens.resumoTiposTitulo;\n            const cabecalho = [`${CliProcessamentoDiagnosticoMensagens.cabecalhoResumoTipo.padEnd(20)}${CliProcessamentoDiagnosticoMensagens.cabecalhoResumoQuantidade.padStart(8)}`];\n            if ('imprimirBloco' in log && typeof log.imprimirBloco === 'function') {\n              log.imprimirBloco(tituloResumo, [...cabecalho, ...linhasResumo]);\n            }\n          }\n        }\n\n        // Mensagem final\n        // Emitir 'Tudo pronto' apenas uma vez\n        if (!config.COMPACT_MODE && !process.env.__PROMETHEUS_TUDO_PRONTO_EMITIDO) {\n          log.info(CliProcessamentoDiagnosticoMensagens.tudoPronto);\n          (process.env as unknown as Record<string, string>).__PROMETHEUS_TUDO_PRONTO_EMITIDO = '1';\n        }\n\n        // Log de diagnstico concludo para testes\n        if (process.env.VITEST) {\n          log.info(CliProcessamentoDiagnosticoMensagens.diagnosticoConcluido);\n        }\n      }\n    }\n\n    // Relatrios e exportao (executa mesmo quando arquetiposResultado undefined)\n    if (!opts.json && !config.SCAN_ONLY) {\n      (log as typeof log & LogExtensions).fase?.('Gerando relatrios');\n      try {\n        const contextoConselho = {\n          hora: new Date().getHours(),\n          arquivosParaCorrigir: totalOcorrencias,\n          arquivosParaPodar: 0,\n          totalOcorrenciasAnaliticas: totalOcorrencias,\n          integridadeGuardian: guardianResultado?.status || 'nao-verificado'\n        };\n        emitirConselhoPrometheus(contextoConselho);\n        if (config.REPORT_EXPORT_ENABLED) {\n          const ts = new Date().toISOString().replace(/[:.]/g, '-');\n          const dir = typeof config.REPORT_OUTPUT_DIR === 'string' ? config.REPORT_OUTPUT_DIR : path.join(baseDir, 'prometheus-reports');\n          const fs = await import('node:fs');\n          await fs.promises.mkdir(dir, {\n            recursive: true\n          });\n          const outputCaminho = path.join(dir, `prometheus-diagnostico-${ts}.md`);\n          const resultadoCompleto = {\n            ...resultadoExecucao,\n            fileEntries: fileEntriesComAst,\n            guardian: guardianResultado\n          } as ResultadoInquisicaoCompleto;\n          // Nota: a gerao de Markdown ser feita aps a fragmentao/export\n          // para que possamos incluir no relatrio links para o manifest e shards.\n\n          // Monta e salva dois artefatos: um SUMMARY (sempre) e opcionalmente o FULL (pesado)\n          try {\n            // Agregar mtricas de analistas por nome (em vez de uma entrada por arquivo)\n            const metricasOriginais = resultadoExecucao.metricas;\n            const analistasAgregados: Record<string, {\n              duracaoMs: number;\n              ocorrencias: number;\n              execucoes: number;\n            }> = {};\n            for (const a of metricasOriginais?.analistas || []) {\n              const nome = a.nome || 'desconhecido';\n              if (!analistasAgregados[nome]) {\n                analistasAgregados[nome] = {\n                  duracaoMs: 0,\n                  ocorrencias: 0,\n                  execucoes: 0\n                };\n              }\n              analistasAgregados[nome].duracaoMs += a.duracaoMs || 0;\n              analistasAgregados[nome].ocorrencias += a.ocorrencias || 0;\n              analistasAgregados[nome].execucoes += 1;\n            }\n            const analistasResumidos = Object.entries(analistasAgregados).map(([nome, dados]) => ({\n              nome,\n              duracaoTotalMs: Math.round(dados.duracaoMs * 100) / 100,\n              ocorrenciasTotal: dados.ocorrencias,\n              execucoes: dados.execucoes\n            })).sort((a, b) => b.ocorrenciasTotal - a.ocorrenciasTotal);\n\n            // Mtricas resumidas (sem o array gigante de analistas por arquivo)\n            const metricasResumidas = {\n              totalArquivos: metricasOriginais?.totalArquivos,\n              tempoParsingMs: metricasOriginais?.tempoParsingMs,\n              tempoAnaliseMs: metricasOriginais?.tempoAnaliseMs,\n              cacheAstHits: metricasOriginais?.cacheAstHits,\n              cacheAstMiss: metricasOriginais?.cacheAstMiss,\n              analistas: analistasResumidos\n            };\n\n            // Ocorrncias limpas: apenas campos essenciais\n            const ocorrenciasLimpas = dedupeOcorrencias(resultadoExecucao.ocorrencias || []).slice(0, 2000).map(oc => {\n              const ocAny = oc as Record<string, unknown>;\n              return {\n                tipo: oc.tipo,\n                nivel: oc.nivel,\n                mensagem: oc.mensagem,\n                relPath: oc.relPath,\n                linha: oc.linha,\n                coluna: oc.coluna,\n                ...(ocAny.sugestao ? {\n                  sugestao: ocAny.sugestao\n                } : {})\n              };\n            });\n            const relatorioResumo = {\n              timestamp: new Date().toISOString(),\n              totalOcorrencias,\n              baselineModificado: Boolean(guardianResultado && (guardianResultado as unknown as {\n                baselineModificado?: boolean;\n              }).baselineModificado),\n              // verso resumida: mtricas agregadas e ocorrncias limpas\n              metricas: metricasResumidas,\n              ocorrencias: ocorrenciasLimpas\n            };\n            const salvar = await getSalvarEstado();\n            await salvar(path.join(dir, `prometheus-relatorio-summary-${ts}.json`), relatorioResumo);\n\n            // Se exportao full estiver ativa, grava tambm o payload completo em arquivo separado\n            let fragmentResultado: {\n              manifestFile?: string;\n              manifest?: unknown;\n            } | undefined = undefined;\n            if (config.REPORT_EXPORT_FULL) {\n              const relatorioFull = {\n                timestamp: new Date().toISOString(),\n                totalOcorrencias,\n                baselineModificado: Boolean(guardianResultado && (guardianResultado as unknown as {\n                  baselineModificado?: boolean;\n                }).baselineModificado),\n                resultado: resultadoCompleto\n              };\n              // Se o relatrio for muito grande, fragmentar em mltiplos arquivos para evitar arquivos gigantes\n              try {\n                fragmentResultado = await fragmentarRelatorio(relatorioFull, dir, ts, {\n                  maxOcorrenciasPerShard: config.REPORT_FRAGMENT_OCCURRENCES,\n                  maxFileEntriesPerShard: config.REPORT_FRAGMENT_FILEENTRIES\n                });\n                // Registrar no log onde est o manifest\n                log.info(CliProcessamentoDiagnosticoMensagens.relatorioFullFragmentado(fragmentResultado.manifestFile));\n              } catch {\n                // Fallback: salvar como nico arquivo caso a fragmentao falhe\n                await salvar(path.join(dir, `prometheus-relatorio-full-${ts}.json`), relatorioFull);\n              }\n            }\n\n            // Gerar o Markdown do diagnstico agora (inclui links/manifest quando disponvel)\n            try {\n              await gerarRelatorioMarkdown(resultadoCompleto, outputCaminho, !opts.full, {\n                manifestFile: fragmentResultado?.manifestFile,\n                relatoriosDir: dir,\n                ts,\n                hadFull: Boolean(fragmentResultado)\n              });\n            } catch (e) {\n              log.aviso(CliProcessamentoDiagnosticoMensagens.falhaGerarRelatorioMarkdownMetadados((e as Error).message));\n              // Tenta gerar sem opes como fallback\n              await gerarRelatorioMarkdown(resultadoCompleto, outputCaminho, !opts.full);\n            }\n\n            // Relatrio adicional: otimizao de SVG (agrupado por diretrio)\n            try {\n              const {\n                exportarRelatorioSvgOtimizacao\n              } = await import('@cli/diagnostico/exporters/svg-otimizacao-exporter.js');\n              await exportarRelatorioSvgOtimizacao({\n                entries: fileEntriesComAst,\n                relatoriosDir: dir,\n                ts\n              });\n            } catch {\n              // No crtico  export adicional no deve falhar o diagnstico\n            }\n            log.sucesso(CliProcessamentoDiagnosticoMensagens.relatoriosExportadosPara(dir));\n          } catch (e) {\n            log.erro(CliProcessamentoDiagnosticoMensagens.falhaSalvarRelatorioJson((e as Error).message));\n          }\n        }\n      } catch (e) {\n        log.erro(CliProcessamentoDiagnosticoMensagens.falhaExportarRelatorios((e as Error).message));\n      }\n    }\n\n    // Garantir impresso de resumo e despedida caso ainda no tenham sido exibidos\n    if (!opts.json && !config.SCAN_ONLY) {\n      try {\n        // Se houver ocorrncias, exibe resumo de tipos (mesma lgica usada acima)\n        if (totalOcorrencias > 0 && resultadoExecucao && ocorrenciasFiltradas) {\n          const tiposResumo: Record<string, number> = {};\n          for (const ocorrencia of ocorrenciasFiltradas) {\n            const tipo = ocorrencia.tipo || 'desconhecido';\n            tiposResumo[tipo] = (tiposResumo[tipo] || 0) + 1;\n          }\n          const linhasResumo = Object.entries(tiposResumo).map(([tipo, qtd]) => `${tipo.padEnd(20)} ${qtd.toString().padStart(8)}`);\n          const tituloResumo = CliProcessamentoDiagnosticoMensagens.resumoTiposTitulo;\n          const cabecalho = [`${CliProcessamentoDiagnosticoMensagens.cabecalhoResumoTipo.padEnd(20)}${CliProcessamentoDiagnosticoMensagens.cabecalhoResumoQuantidade.padStart(8)}`];\n          if ('imprimirBloco' in log && typeof log.imprimirBloco === 'function') {\n            log.imprimirBloco(tituloResumo, [...cabecalho, ...linhasResumo]);\n          }\n        }\n        if (!config.COMPACT_MODE && !process.env.__PROMETHEUS_TUDO_PRONTO_EMITIDO) {\n          log.info(CliProcessamentoDiagnosticoMensagens.tudoPronto);\n          (process.env as unknown as Record<string, string>).__PROMETHEUS_TUDO_PRONTO_EMITIDO = '1';\n        }\n      } catch { }\n    }\n\n    // Quando no houve `arquetiposResultado`, ainda precisamos suportar\n    // `--json`: emitir o JSON final mesmo sem os dados de arquetipos.\n    if (opts.json) {\n      // Reproduz o mesmo comportamento de gerao de JSON usado acima,\n      // mas tolera arquetiposResultado undefined.\n      const ocorrenciasOriginais = dedupeOcorrencias(resultadoExecucao.ocorrencias || []);\n      const todosPorArquivo = new Map<string, typeof ocorrenciasOriginais>();\n      const naoTodos: typeof ocorrenciasOriginais = [];\n      for (const ocorrencia of ocorrenciasOriginais) {\n        if (ocorrencia.tipo === 'TODO_PENDENTE') {\n          const relPath = ocorrencia.relPath || 'desconhecido';\n          if (!todosPorArquivo.has(relPath)) todosPorArquivo.set(relPath, []);\n          const ocorrenciasArquivo = todosPorArquivo.get(relPath);\n          if (ocorrenciasArquivo) ocorrenciasArquivo.push(ocorrencia);\n        } else {\n          naoTodos.push(ocorrencia);\n        }\n      }\n\n      // Mensagem final apenas quando repositrio est limpo\n      try {\n        if (!opts.json && !config.SCAN_ONLY && totalOcorrencias === 0) {\n          logRelatorio.repositorioImpecavel();\n        }\n      } catch { }\n      const todosAgregados: typeof ocorrenciasOriginais = [];\n      for (const [, todos] of todosPorArquivo) {\n        if (todos.length === 1) todosAgregados.push(todos[0]); else if (todos.length > 1) {\n          const primeira = todos[0];\n          const mensagemAgregada = CliProcessamentoDiagnosticoMensagens.todosPendentesEncontrados(todos.length);\n          todosAgregados.push({\n            ...primeira,\n            mensagem: mensagemAgregada,\n            linha: Math.min(...todos.map(t => t.linha || 0))\n          });\n        }\n      }\n      let todasOcorrencias = [...naoTodos, ...todosAgregados];\n      todasOcorrencias = dedupeOcorrencias(todasOcorrencias);\n\n      // Em modo --json, queremos reduzir o payload ao essencial.\n      // Emitimos apenas ocorrncias de nvel \"erro\" (inclui PARSE_ERRO).\n      const ocorrenciasParaJson = todasOcorrencias.filter(o => {\n        const nivel = (o.nivel || 'info') as string;\n        return nivel === 'erro' || o.tipo === 'PARSE_ERRO';\n      });\n      const tiposOcorrencias: Record<string, number> = {};\n      const parseErros: ParseErrosJson = {\n        totalOriginais: 0,\n        totalExibidos: 0,\n        agregados: 0\n      };\n      for (const ocorrencia of ocorrenciasParaJson) {\n        const tipo = ocorrencia.tipo || 'desconhecido';\n        tiposOcorrencias[tipo] = (tiposOcorrencias[tipo] || 0) + 1;\n        if (tipo === 'PARSE_ERRO') {\n          parseErros.totalOriginais++;\n          parseErros.totalExibidos++;\n        }\n      }\n      const parseErrosGlobais = (globalThis as Record<string, unknown>).__PROMETHEUS_PARSE_ERROS__ as unknown[] || [];\n      const parseErrosOriginais = (globalThis as Record<string, unknown>).__PROMETHEUS_PARSE_ERROS_ORIGINAIS__ as number || 0;\n      if (parseErrosGlobais.length > 0 || parseErrosOriginais > 0) {\n        parseErros.totalOriginais = Math.max(parseErros.totalOriginais, parseErrosOriginais);\n        if (parseErrosGlobais.length > 0) {\n          parseErros.totalExibidos = Math.min(parseErros.totalOriginais, parseErrosGlobais.length);\n        }\n        if (parseErrosOriginais > 0) {\n          totalOcorrencias = Math.max(totalOcorrencias, parseErrosOriginais);\n        }\n      }\n      parseErros.agregados = Math.max(0, parseErros.totalOriginais - parseErros.totalExibidos);\n      let status = 'ok';\n      if (ocorrenciasParaJson.length > 0) {\n        status = 'problemas';\n        if (parseErros.totalOriginais > 0 && config.PARSE_ERRO_FALHA) status = 'erro';\n      }\n      const saidaJson: SaidaJsonDiagnostico = {\n        status: status as 'ok' | 'problemas' | 'erro',\n        totalOcorrencias: ocorrenciasParaJson.length,\n        guardian: guardianResultado ? 'verificado' : 'nao-verificado',\n        tiposOcorrencias,\n        parseErros,\n        ocorrencias: ocorrenciasParaJson,\n        linguagens: {\n          total: 0,\n          extensoes: {}\n        }\n      };\n\n      // Quando no h dados de arquetipos, omitimos `estruturaIdentificada` no JSON\n      // (o fluxo principal j trata de inclu-lo quando disponvel).\n\n      const computeLinguagens = (fes: (FileEntry | FileEntryWithAst)[]): LinguagensJson => {\n        const extensoes: Record<string, number> = {};\n        let sem_ext = 0;\n        for (const f of fes || []) {\n          const rel = f.relPath || f.fullCaminho || '';\n          const base = rel.split(/[\\\\/\\\\\\\\]/).pop() || '';\n          const idx = base.lastIndexOf('.');\n          if (idx === -1) {\n            sem_ext++;\n          } else {\n            const ext = base.slice(idx + 1) || 'sem_ext';\n            extensoes[ext] = (extensoes[ext] || 0) + 1;\n          }\n        }\n        return {\n          total: (fes || []).length,\n          extensoes: {\n            ...extensoes,\n            sem_ext\n          }\n        };\n      };\n      const linguagensFinal = computeLinguagens(fileEntriesComAst || fileEntries);\n      saidaJson.linguagens = linguagensFinal;\n      if (!_jsonEmitted) {\n        try {\n          // Adicionar metadados de verso do schema e timestamp para compatibilidade\n          let pkgVersion = '0.0.0';\n          try {\n            const pkgRaw = await fs.promises.readFile(path.join(process.cwd(), 'package.json'), 'utf-8');\n            const pkgObj = JSON.parse(pkgRaw) as {\n              version?: string;\n            };\n            if (pkgObj && typeof pkgObj.version === 'string') pkgVersion = pkgObj.version;\n          } catch { }\n          const schemaMeta = {\n            schemaVersion: '1.0.0',\n            prometheusVersion: pkgVersion,\n            timestamp: new Date().toISOString()\n          };\n          const saidaComMeta = {\n            ...schemaMeta,\n            ...saidaJson\n          };\n          const asciiOnly = Boolean(opts && (opts as OpcoesProcessamentoDiagnostico).jsonAscii || false);\n          console.log(stringifyJsonEscaped(saidaComMeta, 2, {\n            asciiOnly\n          }));\n          _jsonEmitted = true;\n\n          // Se a exportao estiver habilitada via flags globais/locais, salvamos o JSON em disco\n          if (config.REPORT_EXPORT_ENABLED) {\n            try {\n              const ts = new Date().toISOString().replace(/[:.]/g, '-');\n              const dir = typeof config.REPORT_OUTPUT_DIR === 'string' ? config.REPORT_OUTPUT_DIR : path.join(baseDir, 'prometheus-reports');\n              const fs = await import('node:fs');\n              await fs.promises.mkdir(dir, {\n                recursive: true\n              });\n              const salvar = await getSalvarEstado();\n              await salvar(path.join(dir, `prometheus-diagnostico-${ts}.json`), saidaComMeta);\n              log.sucesso(CliProcessamentoDiagnosticoMensagens.relatoriosExportadosPara(dir));\n            } catch (e) {\n              log.erro(CliProcessamentoDiagnosticoMensagens.falhaSalvarRelatorioJson((e as Error).message));\n            }\n          }\n        } catch (e) {\n          console.error(CliProcessamentoDiagnosticoMensagens.errorGeneratingJson, e);\n          console.log(CliProcessamentoDiagnosticoMensagens.fallbackJson, JSON.stringify(saidaJson));\n          _jsonEmitted = true;\n        }\n      }\n      // Exit codes padronizados: 0=ok/avisos, 1=erros, 2=critico (parse erros fatais)\n      if (!process.env.VITEST) {\n        const erros = (nivelOcorrencias.get('erro') || 0) as number;\n        const exitCode = parseErros.totalOriginais > 0 && config.PARSE_ERRO_FALHA ? 2 : erros > 0 ? 1 : 0;\n        process.exit(exitCode);\n      }\n    }\n  } catch (error) {\n    // Se o erro for resultado de um process.exit mocked (ex.: Error('exit:1'))\n    // devemos repropagar para que os testes possam captur-lo. Evitamos\n    // engolir erros que representam encerramento do processo.\n    try {\n      if (error && typeof error === 'object' && 'message' in error && typeof (error as {\n        message?: unknown;\n      }).message === 'string' && String((error as {\n        message: string;\n      }).message).startsWith('exit:')) {\n        throw error;\n      }\n    } catch (re) {\n      throw re;\n    }\n    // Tratamento de erro geral para o processamento do diagnstico\n    // Normaliza mensagens que podem ser string, Error ou outro objeto\n    const errMsg = typeof error === 'string' ? error : error instanceof Error ? error.message : (() => {\n      try {\n        return JSON.stringify(error);\n      } catch {\n        return String(error);\n      }\n    })();\n    log.erro(CliProcessamentoDiagnosticoMensagens.erroFatalDiagnostico(errMsg));\n\n    // Em modo de desenvolvimento, mostrar stack trace\n    if (config.DEV_MODE) {\n      console.error(error);\n    }\n\n    // Retornar resultado com erro\n    return {\n      totalOcorrencias: 1,\n      temErro: true,\n      guardianResultado,\n      fileEntriesComAst: [],\n      resultadoFinal: {\n        ocorrencias: [],\n        metricas: {\n          totalArquivos: 0,\n          tempoTotal: 0,\n          analistas: []\n        }\n      }\n    };\n  }\n\n  // Mensagem final apenas quando repositrio est limpo (fallback)\n  try {\n    if (!opts.json && !config.SCAN_ONLY && totalOcorrencias === 0) {\n      logRelatorio.repositorioImpecavel();\n    }\n  } catch { }\n\n  // Fallback para garantir que a funo sempre retorna um valor\n  return {\n    totalOcorrencias: totalOcorrencias || 0,\n    temErro: false,\n    guardianResultado,\n    fileEntriesComAst: [],\n    resultadoFinal: {\n      ocorrencias: [],\n      metricas: {\n        totalArquivos: 0,\n        tempoTotal: 0,\n        analistas: []\n      }\n    }\n  };\n}"]}